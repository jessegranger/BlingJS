(function(){var $,Bling,extend,hasProp={}.hasOwnProperty,indexOf=[].indexOf,splice=[].splice,commasep,complete,incomplete,not_complete,waiting;Object.keys||(Object.keys=(t=>{var n,e;for(n in e=[],t)e.push(n);return e})),Object.values||(Object.values=(t=>{var n,e;for(n in e=[],t)e.push(t[n]);return e})),extend=((t,...n)=>{var e,r,i,u,o;for(e=0,i=n.length;e<i;e++)if(u=n[e])for(r in u)o=u[r],t[r]=o;return t}),Bling=function(...t){"Bling:nomunge";var n,e;if(1===t.length&&(t=$.type.lookup(t[0]).array(t[0])),n=$.inherit(Bling,t),0===t.length&&void 0!==t[0]){for(e=0;void 0!==t[e];)e++;n.length=e}return"init"in Bling?Bling.init(n):n},$=Bling,$.global=function(){return this}(),$.plugin=function(t,n){var e,r,i,u,o,s;if(n||(n=t,t={}),e=this,"depends"in t)return e.depends(t.depends,function(){return e.plugin({provides:t.provides},n)});try{if("object"==typeof(u=null!=n?n.call(e,e):void 0)){for(i in extend(this,u.$),delete u.$,extend(e.prototype,u),u)!function(t){e[t]||(e[t]=function(...n){return e.prototype[t].apply($(n[0]),n.slice(1))})}(i);null!=t.provides&&e.provide(t.provides)}}catch(t){r=t,console.error(`plugin failed '${e.name}':`,(null!=(o=null!=(s=$.debugStack)?s:$.identity)?o:function(t){return t})(r.stack))}return this},extend($,(waiting=[],complete={},commasep=/, */,not_complete=function(t){return!(t in complete)},incomplete=function(t){return("string"==typeof t?t.split(commasep):t).filter(not_complete)},{depends:function(t,n){return 0===(t=incomplete(t)).length?n():waiting.push(function(e){var r;return(r=t.indexOf(e))>-1&&t.splice(r,1),0===t.length&&n}),n},provide:function(t,n){var e,r,i,u,o,s,c,a,l,f;for(e=[],o=0,s=(a=incomplete(t)).length;o<s;o++)for(c=a[o],complete[c]=u=-1;++u<waiting.length;)if(i=waiting[u](c)){waiting.splice(u,1);try{i(n)}catch(t){r=t,e.push(r)}u=-1}return e.length>0&&(i=null!=(l=null!=(f=$.debugStack)?f:$.identity)?l:function(t){return t.stack},e.map(i).forEach(console.error.bind(console))),n}})),$.plugin({depends:"core",provides:"async,series,parallel"},function(){return{series:function(t=$.identity){var n,e,r,i,u;return i=$(),(u=this.length)>0?(n=0,e=function(e){return function(){return i[e]=arguments,++n>=u?t.apply(i,i):r(n),null}},(r=(t=>$.immediate(()=>this[t](e(t)))))(0)):t.apply(i,i),this},parallel:function(t=$.identity){var n,e,r,i,u,o,s;if(o=$(),(s=this.length)>0)for(n=0,e=function(e){return function(){return o[e]=arguments,++n>=s&&t.apply(o,o),null}},r=i=0,u=s;i<u;r=i+=1)this[r](e(r));else t.apply(o,o);return this}}}),$.plugin({provides:"cache, Cache",depends:"core, sortBy, logger"},function(){var t;return t=function(){return $.logger("[LRU]"),class{constructor(t=1e3,n=1/0){var e,r,i,u,o,s,c;this.capacity=t,this.defaultTtl=n,this.capacity=Math.max(0,this.capacity),this.evictCount=Math.max(3,Math.floor(.1*this.capacity)),i=Object.create(null),o=[],r=function(t){return-t.r/t.w},e=(()=>{if(this.capacity>0){if(o.length>=this.capacity)for(;o.length+this.evictCount-1>=this.capacity;)delete i[o.pop().k];return null}}),s=function(t,n){var e,r,u,s;for(s=e=r=t,u=n;r<=u?e<=u:e>=u;s=r<=u?++e:--e)0<=s&&s<o.length&&(i[o[s].k]=s);return null},c=function(t){var n,e;return e=o[t],(n=$.sortedIndex(o,e,r))!==t&&(o.splice(t,1),o.splice(n,0,e),s(t,n)),null},u={v:void 0},$.extend(this,{has:function(t){return t in i},del:function(t){var n;if(t in i)return n=i[t],o.splice(n,1),delete i[t],s(n,o.length-1)},set:(t,n,u=this.defaultTtl)=>{var a,l,f;return this.capacity>0?(t in i?((a=o[l=i[t]]).v=n,a.w+=1,c(l)):(e(),f={k:t,v:n,r:0,w:1},l=$.sortedIndex(o,f,r),o.splice(l,0,f),s(l,o.length-1)),u<Infinity&&$.delay(u,()=>this.del(t)),n):n},get:function(t){var n,e;return e=u,t in i&&(n=i[t],(e=o[n]).r+=1,c(n)),e.v},clear:function(){var t;for(t in i)o[i[t]]=null;return i=Object.create(null),o=[]}})}}}.call(this),{$:{Cache:$.extend(t,new t(1e4))}}}),$.plugin({provides:"cartesian"},function(){return{$:{cartesian:function(...t){var n,e,r;return e=t.length,r=[],(n=function(i,u){var o,s,c,a;if(++u>=e)return r.push(i);for(o=0,s=(c=t[u]).length;o<s;o++)a=c[o],n(i.concat(a),u);return null})([],-1),$(r)}}}}),$.plugin({provides:"clone",depends:"type"},function(){return $.type.extend({unknown:{clone:function(t){return null}},string:{clone:function(t){return t+""}},number:{clone:function(t){return t+0}},array:{clone:function(t){return t.concat([])}},bling:{clone:function(t){return t.concat([])}},object:{clone:function(t){var n,e,r;for(n in e=Object.create(t.__proto__),t)hasProp.call(t,n)&&(r=t[n],e[n]=$.type.lookup(r).clone(r));return e}}}),{$:{clone:function(t){return $.type.lookup(t).clone(t)}}}}),$.plugin({provides:"compat,trimLeft,split,lastIndexOf,join,preventAll,matchesSelector,isBuffer,Map"},function(){var t,n,e,r,i,u,o;return(t=$.global).Buffer||(t.Buffer={isBuffer:function(){return!1}}),(n=$.global).Map||(n.Map=class{constructor(t){var n,e,r,i,u;for(n=Object.create(null),$.extend(this,{size:0,keys:function(){return Object.keys(n)},values:function(){var t,e,r;for(t in e=[],n)r=n[t],e.push(r);return e},entries:function(){var t,e,r;for(t in e=[],n)r=n[t],e.push([t,r]);return e},has:function(t){return t in n},get:function(t){return n[t]},set:function(t,e){return t in n||(this.size+=1),n[t]=e,this},delete:function(t){return t in n&&(this.size-=1),delete n[t],this},clear:function(){return n=Object.create(null),this.size=0,this},forEach:function(t,e){var r,i;for(r in n)i=n[r],t.call(e,r,i);return this}}),e=0,i=(u=null!=t?t:[]).length;e<i;e++)r=u[e],this.set(...r)}}),o=[-1,1],Math.sign=function(t){return o[0+(t>=0)]},(e=String.prototype).trimLeft||(e.trimLeft=function(){return this.replace(/^\s+/,"")}),(r=String.prototype).split||(r.split=function(t){var n,e,r;for(n=[],e=0;(r=this.indexOf(t,e))>-1;)n.push(this.substring(e,r)),e=r+1;return n}),(i=String.prototype).lastIndexOf||(i.lastIndexOf=function(t,n,e=-1){var r;for(r=-1;(e=t.indexOf(n,e+1))>-1;)r=e;return r}),(u=Array.prototype).join||(u.join=function(t=""){var n,e;if(0===(n=this.length))return"";for(e=this[n-1];--n>0;)e=this[n-1]+t+e;return e}),"undefined"!=typeof Event&&null!==Event&&(Event.prototype.preventAll=function(){return this.preventDefault(),this.stopPropagation(),this.cancelBubble=!0}),"undefined"!=typeof Element&&null!==Element&&(Element.prototype.matchesSelector=Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.matchesSelector),{}}),$.plugin({provides:"compress, decompress"},function(){var t,n,e,r,i;return r=String.fromCharCode,e=function(t){return r(t+32)},({pow:i}=Math),t=function(t){var n,r,u,o,s,c,a,l,f,h,p,d,g,$,v,m;if(null===t||void 0===t||""===t)return t;for(s={},a={},n="",m="",v="",h=2,c=3,g=2,r=[],o=0,u=0,f=function(t,n=0){var i,s;for(i=0,s=g;i<s;i+=1)o=o<<1|n,14===u?(u=0,r.push(e(o)),o=0):u++,n=0;return n=v.charCodeAt(0),l(t,n)},l=function(t,n=0){var i,s,c;for(c=[],i=0,s=t;i<s;i+=1)o=o<<1|1&n,14===u?(u=0,r.push(e(o)),o=0):u++,c.push(n>>=1);return c},p=0,d=t.length;p<d;p++)(n=t[p])in s||(s[n]=c++,a[n]=!0),(m=v+n)in s?v=m:(v in a?(v.charCodeAt(0)<256?f(8):f(16,1),0===--h&&(h=i(2,g),g++),delete a[v]):($=s[v],l(g,$)),0===--h&&(h=i(2,g),g++),s[m]=c++,v=String(n));""!==v&&(v in a?(v.charCodeAt(0)<256?f(8):f(16,1),0===--h&&(h=i(2,g),g++),delete a[v]):($=s[v],l(g,$)),0===--h&&(h=i(2,g),g++)),l(g,2);for(;;){if(o<<=1,14===u){r.push(e(o));break}u++}return r.join("")},n=function(t,n,e){var u,o,s,c,a,l,f,h,p,d,g;if(0===t)return"";if(s=[],l=4,c=4,h=3,f="",d=[],g=p=u=null,o={val:e(0),position:n,index:1},isNaN(o.val)||!isFinite(o.val)||null==o.val)return"";switch(s[0]=0,s[1]=1,s[2]=2,a=function(t,r,i=1){for(;i!==r;)p=o.val&o.position,o.position>>=1,0===o.position&&(o.position=n,o.val=e(o.index++)),t|=(p>0?1:0)*i,i<<=1;return t},a(0,4,1)){case 0:case 1:u=r(a(0,i(2,8*(u+1)),1));break;case 2:return""}for(s[3]=u,g=u,d.push(u);;){if(o.index>t)return"";switch(u=a(0,i(2,h),1)){case 0:case 1:s[c++]=r(a(0,i(2,8*(u+1)),1)),u=c-1,l--;break;case 2:return d.join("")}if(0===l&&(l=i(2,h),h++),s[u])f=s[u];else{if(u!==c)return"";f=g+g.charAt(0)}d.push(f),s[c++]=g+f.charAt(0),g=f,0===--l&&(l=i(2,h),h++)}},{$:{compress:function(n){return n?t(n)+" ":""},decompress:function(t){return t?n(t.length,16384,function(n){return t.charCodeAt(n)-32}):""}}}}),$.plugin({provides:"config",depends:"core"},function(){var t,n,e,r,i,u;return n=function(t,n){var e;switch(arguments.length){case 0:return $.extend({},process.env);default:return null!=(e=process.env[t])?e:n}},i=function(t,n){switch(arguments.length){case 1:return $.extend(process.env,t);case 2:return process.env[t]=n}},r=function(t){var n;return n={},$(t.toString("utf8").split("\n")).filter($.isEmpty,!1).filter(/^#/,!1).map(function(){return this.replace(/^\s+/,"").split("=")}).each(function(t){var e;if(null!=(e=t[0])?e.length:void 0)return n[t[0]]=t[1].replace(/^["']/,"").replace(/['"]$/,"")}),n},u=function(t,n){var e;return e=process.env[t],$.interval(1003,function(){var r;if((r=process.env[t])!==e)return n(e,r),e=r})},e=function(t,n){var e;return parseInt(null!=(e=process.env[t])?e:n,10)},t=function(t,n){var e;return parseFloat(null!=(e=process.env[t])?e:n)},{$:{config:$.extend(n,{get:n,set:i,parse:r,watch:u,int:e,float:t})}}}),$.plugin({provides:"core,eq,each,map,filterMap,tap,replaceWith,reduce,union,intersect,distinct,contains,count,coalesce,swap,shuffle,select,or,zap,clean,take,skip,first,last,slice,push,filter,matches,weave,fold,flatten,call,apply,log,toArray,clear,indexWhere",depends:"string,type"},function(){var t,n,e,r;return $.defineProperty($,"now",{get:function(){return+new Date}}),t=function(t,n){for(;t<0;)t+=n.length;return Math.min(t,n.length)},{$:{assert:function(t,n=""){if(!t)throw new Error(`assertion failed: ${n}`)},coalesce:function(...t){return $(t).coalesce()},keysOf:function(t,n=!1){var e;return $(n?function(){var n;for(e in n=[],t)hasProp.call(t,e)&&n.push(e);return n}():function(){var n;for(e in n=[],t)n.push(e);return n}())},valuesOf:function(t,n=!1){var e,r;return $(n?function(){var n;for(e in n=[],t)hasProp.call(t,e)&&(r=t[e],n.push(r));return n}():function(){var n;for(e in n=[],t)r=t[e],n.push(r);return n}())}},eq:function(n){return $([this[t(n,this)]])},each:function(t){var n;return function(){var e,r,i;for(this,i=[],e=0,r=this.length;e<r;e++)n=this[e],i.push(t.call(n,n));return i}.call(this),this},map:function(t){var n,e,r,i,u;for(n=$(),e=0,this,r=0,i=this.length;r<i;r++)u=this[r],n[e++]=t.call(u,u);return n},every:function(t){var n,e,r;for(this,n=0,e=this.length;n<e;n++)if(r=this[n],!t.call(r,r))return!1;return!0},some:function(t){var n,e,r;for(this,n=0,e=this.length;n<e;n++)if(r=this[n],t.call(r,r))return!0;return!1},filterMap:function(t){var n,e,r,i,u;for(n=$(),this,e=0,r=this.length;e<r;e++)i=this[e],null!=(u=t.call(i,i))&&n.push(u);return n},tap:function(t){return t.call(this,this)},replaceWith:function(t){var n,e,r;for(this.clear(),n=0,e=t.length;n<e;n++)r=t[n],this.push(r);return this},reduce:function(t,n){var e,r,i,u,o;for("function"==typeof n&&([t,n]=[n,t]),e=0,i=this.length,null==n&&(n=this[e++]),o=r=e,u=i;r<u;o=r+=1)n=t.call(this[o],n,this[o]);return n},union:function(t,n=!0){var e,r,i,u,o,s;for(o=$(),this,e=0,i=this.length;e<i;e++)s=this[e],o.contains(s,n)||o.push(s);for(r=0,u=t.length;r<u;r++)s=t[r],o.contains(s,n)||o.push(s);return o},distinct:function(t=!0){return this.union(this,t)},intersect:function(t){var n;return $(function(){var e,r,i;for(this,i=[],e=0,r=this.length;e<r;e++)n=this[e],indexOf.call(t,n)>=0&&i.push(n);return i}.call(this))},contains:function(t,n=!0){var e,r,i;if(n)return this.indexOf(t)>-1;for(e=0,r=(i=this).length;e<r;e++)if(i[e]==t)return!0;return!1},count:function(t,n=!0){var e,r,i,u;for(i=0,this,e=0,r=this.length;e<r;e++)u=this[e],(void 0===t||n&&u===t||!n&&u==t)&&++i;return i},coalesce:function(){var t,n,e;for(this,n=0,e=this.length;n<e;n++)if(t=this[n],$.type.in("array","bling",t)&&(t=$(t).coalesce()),null!=t)return t;return null},swap:function(n,e){return(n=t(n,this))!==(e=t(e,this))&&([this[n],this[e]]=[this[e],this[n]]),this},shuffle:function(){var t;for(t=this.length-1;t>=0;)this.swap(--t,Math.floor(Math.random()*t));return this},select:(n=function(t){return function(){var n;return $.is("function",n=this[t])&&"constructor"!==t?$.bound(this,n):n}},r=function(t){var r;switch($.type(t)){case"regexp":return e.call(this,t);case"string":case"number":return"*"===(t=String(t))?this.flatten():(r=t.indexOf("."))>-1?this.select(t.substr(0,r)).select(t.substr(r+1)):this.map(n(t));default:return $()}},e=function(...t){var n,e,r,i,u,o,s,c,a;for(this.length,o=Object.create(null),e=0,i=t.length;e<i;e++)if(c=t[e],$.is("regexp",c))for(r=0,u=(a=$.keysOf(this[0]).filter(c)).length;r<u;r++)s=a[r],o[s]=this.select(s);else o[c]=this.select(c);return n=0,this.map(function(){var t,e,r;for(c in e=Object.create(null),o)t=c.split(".").pop(),void 0!==(r=o[c][n])&&(e[t]=r);return n++,e})},function(){switch(arguments.length){case 0:return this;case 1:return r.apply(this,arguments);default:return e.apply(this,arguments)}}),or:function(t){var n,e,r;for(n=e=0,r=this.length;0<=r?e<r:e>r;n=0<=r?++e:--e)this[n]||(this[n]=t);return this},zap:function(t,n){var e,r,i,u;if($.is("object",t)){for(i in t)n=t[i],this.zap(i,n);return this}if((r=t.lastIndexOf("."))>0)return e=t.substr(0,r),u=t.substr(r+1),this.select(e).zap(u,n),this;switch($.type(n)){case"array":case"bling":this.each(function(){return this[t]=n[++r%n.length]});break;case"function":this.zap(t,this.select(t).map(n));break;default:this.each(function(){return this[t]=n})}return this},clean:function(...t){return this.each(function(){var n,e,r,i,u,o,s;for(n=0,i=t.length;n<i;n++)switch(o=t[n],$.type(o)){case"string":case"number":delete this[o];break;case"regexp":for(e=0,u=(s=Object.keys(this)).length;e<u;e++)r=s[e],o.test(r)&&delete this[r]}return null})},take:function(t=1){var n,e;return n=Math.min(t,this.length),$(function(){var t,r,i;for(i=[],e=t=0,r=n;t<r;e=t+=1)i.push(this[e]);return i}.call(this))},skip:function(t=0){var n,e;return e=Math.max(0,0|t),$(function(){var t,r,i;for(i=[],n=t=e,r=this.length;t<r;n=t+=1)i.push(this[n]);return i}.call(this))},first:function(t=1){return 1===t?this[0]:this.take(t)},last:function(t=1){return 1===t?this[this.length-1]:this.skip(this.length-t)},slice:function(n=0,e=this.length){var r;return n=t(n,this),e=t(e,this),$(function(){var t,i,u,o;for(o=[],r=t=i=n,u=e;i<=u?t<u:t>u;r=i<=u?++t:--t)o.push(this[r]);return o}.call(this))},extend:function(t){var n,e,r;for(e=0,r=t.length;e<r;e++)n=t[e],this.push(n);return this},push:function(t){return Array.prototype.push.call(this,t),this},unshift:function(t){return Array.prototype.unshift.call(this,t),this},filter:function(t,n,e){var r,i,u,o,s;for($.is("bool",n)&&([e,n]=[n,e]),$.is("number",e)&&([n,e]=[e,n]),null==n&&(n=this.length),null==e&&(e=!0),i=function(){switch(!1){case!$.is("object",t):return function(n){return $.matches(t,n)};case!$.is("string",t):return function(n){var e;return null!=(e=null!=n&&"function"==typeof n.matchesSelector?n.matchesSelector(t):void 0)&&e};case!$.is("regexp",t):return function(n){return t.test(n)};case!$.is("function",t):return t;case!$.type.in("bool","number","null","undefined",t):return function(n){return t===n};default:throw new Error(`unsupported argument to filter: ${$.type(t)}`)}}(),r=$(),this,u=0,s=this.length;u<s;u++)if(o=this[u],!!i.call(o,o)===e){if(--n<0)break;r.push(o)}return r},matches:function(t){switch(!1){case!$.is("string",t):return this.select("matchesSelector").call(t);case!$.is("regexp",t):return this.map(function(n){return t.test(n)});default:throw new Error(`unsupported argument to matches: ${$.type(t)}`)}},weave:function(t){var n,e,r,i,u;for(n=$(),e=r=this.length-1;r>=0;e=r+=-1)n[2*e+1]=this[e];for(e=i=0,u=t.length;i<u;e=i+=1)n[2*e]=t[e];return n},fold:function(t){var n,e,r;return r=this.length,n=$(function(){var n,i,u;for(u=[],e=n=0,i=r-1;n<i;e=n+=2)u.push(t.call(this,this[e],this[e+1]));return u}.call(this)),r%2==1&&n.push(t.call(this,this[r-1],void 0)),n},flatten:function(){var t,n,e,r,i,u,o,s;for(t=$(),this,n=e=0,o=this.length;e<o;n=++e)if(r=this[n],$.type.in("array","bling","arguments","nodelist",r))for(u=0,s=r.length;u<s;u++)i=r[u],t.push(i);else t.push(r);return t},call:function(){return this.apply(null,arguments)},apply:function(t,n){return this.filterMap(function(){return $.is("function",this)?this.apply(t,n):null})},log:function(t){return t?$.log(t,this.toString(),this.length+" items"):$.log(this.toString(),this.length+" items"),this},toArray:function(){return this.__proto__=Array.prototype,this},clear:function(){return this.splice(0,this.length)},indexWhere:function(t){var n,e,r,i;for(this,n=e=0,r=this.length;e<r;n=++e)if(i=this[n],t.call(i,i))return n;return-1}}}),$.plugin({provides:"css,CSS",depends:"type"},function(){var t,n,e,r,i;return n=function(t,e,r){var i,u,o;for(i in e in r||(r[e]=[]),t)switch(typeof(o=t[i])){case"string":case"number":u=i.replace(/([a-z]+)([A-Z]+)/g,"$1-$2").toLowerCase(),r[e].push(`${u}: ${o};`);break;case"object":n(o,u=e?e+i:i,r);break;default:throw new Error(`unexpected type in css: ${typeof o}`)}return r},i=function(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")},r=function(t){for(var n,e;(n=t.indexOf("/*"))>-1&&-1!==(e=t.indexOf("*/",n));)t=t.substring(0,n)+t.substring(e+2);return t},e=function(t,n){var r,u,o,s,c,a,l,f,h,p;if(a=t.match(/([^{]+){/)){if(h=i(a[1]),l=t.substring(a[0].length),n[h]||(n[h]={}),a=l.match(/([^}]+)}/))for(r=a[1].split(";"),l=l.substring(a[0].length),o=0,c=r.length;o<c;o++)u=(f=r[o]).indexOf(":"),(s=f.substring(0,u))&&(s=i(s),p=i(f.substring(u+1)),n[h][s]=p);if(l.length>0)return e(l,n)}return n},">+~",t=function(t){var n,e,r,i,u,o,s,c,a,l,f,h,p;for(p in f={},t){for(h=t[p],r=0,u=">+~".length;r<u;r++)s=">+~"[r],p=p.replace(s,` ${s} `);switch((a=p.split(/\s+/)).length){case 0:continue;case 1:$.extend(f[p]||(f[p]={}),h);break;default:for(n=f,e=!0,i=0,o=a.length;i<o;i++)c=a[i],e||(c=" "+c),n=n[c]||(n[c]={}),e=!1;$.extend(n,h)}}return(l=function(t){var n,e,r;for(n in!1,t)if(r=t[n],$.is("object",r)){switch((e=Object.keys(r)).length){case 0:delete t[n];break;default:1===e.length&&$.is("object",r[e[0]])&&(t[n+e[0]]=r[e[0]],delete t[n],l(t))}l(r)}return t})(f)},{$:{CSS:{parse:function(n,i=!1){var u;return u=e(r(n),{}),i?t(u):u},stringify:function(t){var e,r;return function(){var i,u;for(e in u=[],i=n(t,"",{}))(r=i[e]).length>0&&u.push(`${e} { ${r.join(" ")} }`);return u}().join(" ")}}}}}),$.plugin({provides:"date,midnight,stamp,unstamp,dateFormat,dateParse",depends:"type"},function(){var t,n,e,r,i,u,o,s,c,a,l,f,h,p,d,g,v;return[a,d,c,o,n]=[1,1e3,6e4,36e5,864e5],v={ms:a,s:d,m:c,h:o,d:n,sec:d,second:d,seconds:d,min:c,minute:c,minutes:c,hr:o,hour:o,hours:o,day:n,days:n},g=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],s=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u={yyyy:Date.prototype.getUTCFullYear,YY:e=function(){return String(this.getUTCFullYear()).substr(2)},yy:e,mm:function(){return this.getUTCMonth()+1},dd:Date.prototype.getUTCDate,dw:Date.prototype.getUTCDay,dW:function(){return g[parseInt(this.getUTCDay(),10)-1]},DW:function(){return s[parseInt(this.getUTCDay(),10)-1]},HH:Date.prototype.getUTCHours,MM:Date.prototype.getUTCMinutes,SS:Date.prototype.getUTCSeconds,MS:Date.prototype.getUTCMilliseconds,_MS:function(){return $.padLeft(Date.prototype.getUTCMilliseconds.apply(this),3,"0")}},i=Object.keys(u).sort().reverse(),p={YYYY:f=Date.prototype.setUTCFullYear,yyyy:f,YY:l=function(t){return this.setUTCFullYear((t>50?1900:2e3)+t)},yy:l,mm:function(t){return this.setUTCMonth(t-1)},dd:Date.prototype.setUTCDate,HH:Date.prototype.setUTCHours,MM:Date.prototype.setUTCMinutes,SS:Date.prototype.setUTCSeconds,_MS:function(t){return this.setUTCMilliseconds(parseInt(t,10))},MS:Date.prototype.setUTCMilliseconds},h=Object.keys(p).sort().reverse(),r=Math.floor,$.type.register("date",{is:function(t){return $.isType(Date,t)},array:function(t){return[t]},string:function(t,n,e){return $.date.format(t,n,e)},number:function(t,n){return $.date.stamp(t,n)}}),$.type.extend("string",{date:function(t,n=$.date.defaultFormat){return new Date($.date.parse(t,n,"ms"))}}),$.type.extend("number",{date:function(t,n=$.date.defaultUnit){return $.date.unstamp(t,n)}}),{$:{date:{defaultUnit:"s",defaultFormat:"yyyy-mm-dd HH:MM:SS",stamp:function(t=new Date,n=$.date.defaultUnit){return r(t/v[n])},unstamp:function(t,n=$.date.defaultUnit){return new Date(r(t*v[n]))},convert:function(t,n=$.date.defaultUnit,e=$.date.defaultUnit){return $.is("date",t)&&(t=$.date.stamp(t,n)),r(t*v[n]/v[e])},midnight:function(t,n=$.date.defaultUnit){return $.date.convert($.date.convert(t,n,"d"),"d",n)},format:function(t,n=$.date.defaultFormat,e=$.date.defaultUnit){var r,o,s,c;for($.is("date",t)&&(t=$.date.stamp(t,e)),r=$.date.unstamp(t,e),o=0,c=i.length;o<c;o++)s=i[o],n=n.replace(s,$.padLeft(""+u[s].call(r),s.length,"0"));return n},parse:function(t,n=$.date.defaultFormat,e=$.date.defaultUnit){var r,i,u,o,s;for(r=new Date(0),i=0;i<n.length;){for(u=0,s=h.length;u<s;u++)if(o=h[u],n.indexOf(o,i)===i){try{p[o].call(r,parseInt(t.slice(i,i+o.length),10))}catch(e){throw e,new Error(`Invalid date ('${t}') given format mask: ${n} (failed at position ${i})`)}i+=o.length-1;break}i+=1}return $.date.stamp(r,e)},addMilliseconds:(t=function(t){return function(n,e,r=$.date.defaultUnit){var i;return i=$.date.unstamp(n,r),p[t].call(i,u[t].call(i)+e),$.date.stamp(i,r)}})("MS"),addSeconds:t("SS"),addMinutes:t("MM"),addHours:t("HH"),addDays:t("dd"),addMonths:t("mm"),addYears:t("yyyy"),range:function(n,e,r=1,i="dd",u=$.date.defaultUnit){var o,s,c;for(o=t(i),c=[n];(s=c[c.length-1])<e;)c.push(o(s,r,u));return c}}},midnight:function(t=$.date.defaultUnit){return this.map(function(){return $.date.midnight(this,t)})},unstamp:function(t=$.date.defaultUnit){return this.map(function(){return $.date.unstamp(this,t)})},stamp:function(t=$.date.defaultUnit){return this.map(function(){return $.date.stamp(this,t)})},dateFormat:function(t=$.date.defaultFormat,n=$.date.defaultUnit){return this.map(function(){return $.date.format(this,t,n)})},dateParse:function(t=$.date.defaultFormat,n=$.date.defaultUnit){return this.map(function(){return $.date.parse(this,t,n)})}}}),$.plugin({provides:"debug, debugStack",depends:"core"},function(){var t,n;return t=function(t,n){var e,r,i,u,o,s;s=/(?:\r\n|\r|\n)/,r=null;try{r=require("fs")}catch(n){return n,t}return i=$(String(t).split(s)).filter(/^$/,!1),n||(i=i.filter(/node_modules/,!1)),o=i.first(),i=i.skip(1),u=Object.create(null),e=i.map(function(t){var n,e,i,o,c,a,l;if(null==t)return null;i=t.replace(/^\s*at\s+/g,"").replace(/.*\(([^:]+:\d+:\d+)\)$/,"$1");try{return[i,a,e]=i.split(/:/),null==(o=null!=u[i]?u[i]:u[i]=String(r.readFileSync(i)).split(s))?null:(n="",a>1&&(n=o[a-2]).length>80&&(n="..8<.. "+n.substr(e-25,50)+" ..>8.."),a>=o.length?null:null==(c=o[a-1])?null:(c.length>80&&(c="..8<.."+c.substr(e-25,50)+"..>8..",e=31),l=c.replace(/[^\t]/g,"").length,`  ${a-1} ${n}\n  ${a} ${c}\n  ${a} ${$.repeat("\t",l)+$.repeat(" ",e-1-l)}^`))}catch(t){return t,null}}),o+"\n"+$.weave(e,i).filter(null,!1).join("\n")},n=function(t,e){return t&&t.constructor?n(t.__proto__,e.push(t.constructor)):e},{$:{debugStack:function(n,e=!1){var r;return r=function(){switch(!1){case!$.is("error",n):return String(n.stack);case!$.is("string",n):return n;default:return String(n)}}(),t(r,e)},protoChain:function(t){return n(t.__proto__,$())}}}}),$.plugin({provides:"delay,immediate,interval",depends:"is,select,extend,bound,core"},function(){var t,n,e;return t=function(t){return Math.min(Math.max(Math.abs(parseInt(t,10)),1),4294967295)},{$:{delay:(n=$.extend([],(e=function(t){return function(){return t.length&&t.shift()(),null}},{add:function(t,n){var r,i,u;for($.extend(t,{order:n+$.now,timeout:setTimeout(e(this),n)}),r=i=0,u=this.length;i<=u;r=i+=1)if(r===this.length||this[r].order>t.order){this.splice(r,0,t);break}return this},cancel:function(t){var n;return(n=this.indexOf(t))>-1&&(this.splice(n,1),clearTimeout(t.timeout)),this}})),function(e,r){var i,u,o;switch(!1){case!$.is("object",e):return i=$(function(){var t;for(u in t=[],e)o=e[u],t.push($.delay(u,o));return t}()),{cancel:function(){return i.select("cancel").call()},unref:function(){return i.select("unref").call()},ref:function(){return i.select("ref").call()}};case!$.is("function",r):return n.add(r,t(e)),{cancel:function(){return n.cancel(r)},unref:function(t){var n;return null!=(n=t.timeout)?n.unref():void 0},ref:function(t){var n;return null!=(n=t.timeout)?n.ref():void 0}};default:throw new Error(`Bad arguments to $.delay (expected: int,function given: ${$.type(e)},${$.type(r)})`)}}),immediate:function(){switch(!1){case!("setImmediate"in $.global):return $.global.setImmediate;case null==("undefined"!=typeof process&&null!==process?process.nextTick:void 0):return process.nextTick;default:return function(t){return setTimeout(t,0)}}}(),interval:function(n,e){var r,i,u;return i=!1,n=t(n),u=$.delay(n,r=function(){return i||e(),$.delay(n,r)}),$.extend(u,{pause:function(t=!0){return i=t},resume:function(t=!0){return i=!t}})}},delay:function(t,n){return $.delay(t,$.bound(this,n)),this}}}),$.plugin({depends:"inherit,reduce",provides:"diff,stringDistance,stringDiff"},function(){var t,n,e,r,i,u,o,s,c;return o=Object.create(null),s=Math.min,u=function(t,n,e,r,i,c,a,l,f){return null!=o[[t,n,e,r,i,c,a,l,f]]?o[[t,n,e,r,i,c,a,l,f]]:o[[t,n,e,r,i,c,a,l,f]]=null!=o[[r,i,c,t,n,e,a,l,f]]?o[[r,i,c,t,n,e,a,l,f]]:o[[r,i,c,t,n,e,a,l,f]]=function(){switch(!1){case!(c<=0):return e;case!(e<=0):return c;default:return s(a+u(t,n+1,e-1,r,i,c,a,l,f),l+u(t,n,e,r,i+1,c-1,a,l,f),f*(t[n]!==r[i])+u(t,n+1,e-1,r,i+1,c-1,a,l,f))}}()},t=function(t){return $.inherit({toHTML:function(){return this.reduce(function(t,n){return t+function(){switch(n.op){case"ins":return`<ins>${n.v}</ins>`;case"del":return`<del>${n.v}</del>`;case"sub":return`<del>${n.v}</del><ins>${n.w}</ins>`;case"sav":return n.v}}()},"")}},t.reduce(function(t,n){var e;return"sub"===n.op&&n.v===n.w&&(n.op="sav",delete n.w),t.length&&(e=t.last()).op===n.op?(e.v+=n.v,"sub"===e.op&&(e.w+=n.w)):t.push(n),t},$()))},r=Object.create(null),n=function(t){return{op:"del",v:t}},i=function(t){return{op:"ins",v:t}},c=function(t,n){return{op:"sub",v:t,w:n}},e=function(o,a,l,f,h,p,d,g,v){return null!=r[[o,a,l,f,h,p,d,g,v]]?r[[o,a,l,f,h,p,d,g,v]]:r[[o,a,l,f,h,p,d,g,v]]=t(function(){var t,r,m,y,b,k,x,w,S,T,j;switch(!1){case!(p<=0):for(T=[],y=0,k=(w=o.substr(a,l)).length;y<k;y++)r=w[y],T.push(n(r));return T;case!(l<=0):for(j=[],b=0,x=(S=f.substr(h,p)).length;b<x;b++)r=S[b],j.push(i(r));return j;default:switch(v*=o[a]!==f[h],m={del:d+u(...(t={del:[o+0,a+1,l-1,f+0,h+0,p+0,1,1.5,1.5],ins:[o+0,a+0,l+0,f+0,h+1,p-1,1.5,1,1.5],sub:[o+0,a+1,l-1,f+0,h+1,p-1,1,1,1]}).del),ins:g+u(...t.ins),sub:v+u(...t.sub)},s(m.del,m.ins,m.sub)){case m.del:return $(n(o[a])).concat(e(...t.del));case m.ins:return $(i(f[h])).concat(e(...t.ins));case m.sub:return $(c(o[a],f[h])).concat(e(...t.sub))}}}())},{$:{stringDistance:function(t,n){return u(t,0,t.length,n,0,n.length,1,1,1)},stringDiff:function(t,n){return e(t,0,t.length,n,0,n.length,1,1,1.5)}}}}),null!=$.global.document&&$.plugin({provides:"dom,HTML,html,append,appendText,appendTo,prepend,prependTo,before,after,wrap,unwrap,replace,attr,data,addClass,removeClass,toggleClass,hasClass,text,val,css,defaultCss,rect,width,height,top,left,bottom,right,position,scrollToCenter,child,parents,next,prev,remove,find,querySelectorAll,clone,toFragment",depends:"function,type,string"},function(){var t,n,e,r,i,u,o,s;return n=!1,$.type.register("nodelist",{is:function(t){return null!=t&&$.isType("NodeList",t)},hash:function(t){var n;return $(function(){var e,r,i;for(i=[],e=0,r=t.length;e<r;e++)n=t[e],i.push($.hash(n));return i}()).sum()},array:function(){try{return document.querySelectorAll("xxx").__proto__={},$.identity}catch(t){return t,n=!0,function(t){var n,e,r,i;for(i=[],n=0,e=t.length;n<e;n++)r=t[n],i.push(r);return i}}}(),string:function(t){return"{Nodelist:["+$(t).select("nodeName").join(",")+"]}"},node:function(t){return $(t).toFragment()}}),$.type.register("node",{is:function(t){return(null!=t?t.nodeType:void 0)>0},hash:function(t){return $.checksum(t.nodeName)+$.hash(t.attributes)+$.checksum(t.innerHTML)},string:function(t){return t.toString()},node:$.identity}),$.type.register("fragment",{is:function(t){return 11===(null!=t?t.nodeType:void 0)},hash:function(t){var n;return $(function(){var e,r,i,u;for(u=[],e=0,r=(i=t.childNodes).length;e<r;e++)n=i[e],u.push($.hash(n));return u}()).sum()},string:function(t){return t.toString()},node:$.identity}),$.type.register("html",{is:function(t){var n;return"string"==typeof t&&"<"===(n=t.trimLeft())[0]&&">"===n[n.length-1]},node:function(t){var n,e,r,i,u,o;if((u=document.createElement("div")).innerHTML=t,1===(i=(n=u.childNodes).length))return u.removeChild(n[0]);for(e=document.createDocumentFragment(),r=0,o=i;r<o;r+=1)e.appendChild(u.removeChild(n[0]));return e},array:function(t){var n;return $.type.lookup(n=$.HTML.parse(t)).array(n)},string:function(t){return`'${t}'`},repr:function(t){return'"'+t+'"'}}),$.type.extend({unknown:{node:function(){return null}},bling:{node:function(t){return t.toFragment()}},node:{html:function(t){var n,e;return(n=document.createElement("div")).appendChild(t=t.cloneNode(!0)),e=n.innerHTML,n.removeChild(t),e}},string:{node:function(t){return $(t).toFragment()},array:n?function(t){var n;return $.type.lookup(n=document.querySelectorAll(t)).array(n)}:function(t){return document.querySelectorAll(t)}},function:{node:function(t){return $(t.toString()).toFragment()}}}),o=function(t){return t.parentNode||document.createDocumentFragment().appendChild(t),t},e=function(t,n){return o(t).parentNode.insertBefore(n,t)},t=function(t,n){return o(t).parentNode.insertBefore(n,t.nextSibling)},s=function(t){return $.type.lookup(t).node(t)},r=!1,!1,$.computeCSSProperty=function(t){return function(){return $.global.getComputedStyle(this,null).getPropertyValue(t)}},u=function(t){return function(){return this.map(function(n){return $(function(){var e;for(e=[];n=n[t];)e.push(n);return e}())})}},{$:{HTML:{parse:function(t){return $.type.lookup(t).node(t)},stringify:function(t){return $.type.lookup(t).html(t)},escape:function(t){var n;return r||(r=$("<div>&nbsp;</div>").child(0)),n=r.zap("data",t).select("parentNode.innerHTML").first(),r.zap("data",""),n}}},html:function(t){switch($.type(t)){case"undefined":case"null":return this.select("innerHTML");case"string":case"html":return this.zap("innerHTML",t);case"bling":return this.html(t.toFragment());case"node":return this.each(function(){var n;for(this.replaceChild(this.childNodes[0],t),n=[];this.childNodes.length>1;)n.push(this.removeChild(this.childNodes[1]));return n})}},append:function(t){if(null!=(t=s(t)))return this.each(function(n){return null!=n&&"function"==typeof n.appendChild?n.appendChild(t.cloneNode(!0)):void 0})},appendText:function(t){var n;if(null!=(n=document.createTextNode(t)))return this.each(function(t){return null!=t&&"function"==typeof t.appendChild?t.appendChild(n.cloneNode(!0)):void 0})},appendTo:function(t){var n,e;return n=this.map(function(){return this.cloneNode(!0)}),e=0,$(t).each(function(){return this.appendChild(n[e++])}),n},prepend:function(t){return null!=t&&(t=s(t),this.take(1).each(function(){switch(!1){case!(this.childNodes.length>0):return e(this.childNodes[0],t);default:return this.appendChild(t)}}),this.skip(1).each(function(){switch(!1){case!this.childNodes.length:return e(this.childNodes[0],t.cloneNode(!0));default:return this.appendChild(t.cloneNode(!0))}})),this},prependTo:function(t){return null!=t&&$(t).prepend(this),this},before:function(t){return null!=t&&(t=s(t),this.take(1).each(function(){return e(this,t)}),this.skip(1).each(function(){return e(this,t.cloneNode(!0))})),this},after:function(n){return null!=n&&(n=s(n),this.take(1).each(function(){return t(this,n)}),this.skip(1).each(function(){return t(this,n.cloneNode(!0))})),this},wrap:function(t){if(t=s(t),$.is("fragment",t))throw new Error("cannot call .wrap() with a fragment as the parent");return this.each(function(n){var e,r;return $.is("fragment",n)||!n.parentNode?t.appendChild(n):(e=n.parentNode,r=document.createElement("dummy"),t.appendChild(e.replaceChild(r,n)),e.replaceChild(t,r))})},unwrap:function(){return this.each(function(){return this.parentNode&&this.parentNode.parentNode?this.parentNode.parentNode.replaceChild(this,this.parentNode):this.parentNode?this.parentNode.removeChild(this):void 0})},replace:function(t){var n,e,r,i,u,o;if($.is("regexp",t))return i=arguments[1],this.map(function(n){return n.replace(t,i)});for(t=s(t),e=r=0,u=(n=this.map(function(){return t.cloneNode(!0)})).length;r<u;e=r+=1)null!=(o=this[e].parentNode)&&o.replaceChild(n[e],this[e]);return n},attr:function(t,n){var e;if($.is("object",t))for(e in t)n=t[e],this.attr(e,n);else switch(n){case void 0:return this.select("getAttribute").call(t,n);case null:this.select("removeAttribute").call(t,n);break;default:this.select("setAttribute").call(t,n)}return this},data:function(t,n){return this.attr(`data-${$.dashize(t)}`,n)},addClass:function(t){var n;return n=function(t){return""!==t},this.removeClass(t).each(function(){var e;return(e=this.className.split(" ").filter(n)).push(t),this.className=e.join(" ")})},removeClass:function(t){var n;return n=function(n){return n!==t},this.each(function(){if(this.className=this.className.split(" ").filter(n).join(" "),0===this.className.length)return this.removeAttribute("class")})},toggleClass:function(t){var n;return n=function(n){return n!==t},this.each(function(){var e,r;if(e=this.className.split(" "),r=$.not($.isEmpty),e.indexOf(t)>-1?r=$.and(n,r):e.push(t),this.className=e.filter(r).join(" "),0===this.className.length)return this.removeAttribute("class")})},hasClass:function(t){return this.select("className.split").call(" ").select("indexOf").call(t).map(function(t){return t>-1})},text:function(t){return null!=t?this.zap("textContent",t):this.select("textContent")},val:function(t){return null!=t?this.zap("value",t):this.select("value")},css:function(t,n){var e,r,i,u,o,s,c;if(null!=n||$.is("object",t)){if(c=this.select("style.setProperty"),$.is("object",t))for(i in t)n=t[i],c.call(i,n,"");else if($.is("array",n))for(e=r=0,s=u=Math.max(n.length,o=c.length);r<s;e=r+=1)c[e%o](t,n[e%u],"");else $.is("function",n)?this.select(`style.${t}`).weave(this.map($.computeCSSProperty(t))).fold($.coalesce).weave(c).fold(function(e,r){return e(t,n.call(r,r))}):c.call(t,n,"");return this}return this.select(`style.${t}`).weave(this.map($.computeCSSProperty(t))).fold($.coalesce)},defaultCss:function(t,n){var e,r,i;if(r=this.selector,i="",$.is("string",t)){if(!$.is("string",n))throw Error("defaultCss requires a value with a string key");i+=`${r} { ${t}: ${n} } `}else if($.is("object",t))for(e in t+"} ")i+=`${r} { `+`${e}: ${t[e]}; `;return $("<style></style>").text(i).appendTo("head"),this},rect:function(){return this.map(function(t){switch(t){case window:return{width:window.innerWidth,height:window.innerHeight,top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};default:return t.getBoundingClientRect()}})},width:(i=function(t){return function(n){return null!=n?this.css(t,n):this.rect().select(t)}})("width"),height:i("height"),top:i("top"),left:i("left"),bottom:i("bottom"),right:i("right"),position:function(t,n){switch(!1){case!(null==t):return this.rect();case!(null==n):return this.css("left",$.px(t));default:return this.css({top:$.px(n),left:$.px(t)})}},scrollToCenter:function(){return document.body.scrollTop=this[0].offsetTop-$.global.innerHeight/2,this},child:function(t){return this.select("childNodes").map(function(){return this[t<0?t+this.length:t]})},parents:u("parentNode"),prev:u("previousSibling"),next:u("nextSibling"),remove:function(){return this.each(function(){var t;return null!=(t=this.parentNode)?t.removeChild(this):void 0})},find:function(t,n=0){return this.filter("*").map(function(){switch(n){case 0:return function(){return this.querySelectorAll(t)};case 1:return function(){return $(this.querySelector(t))};default:return function(){return $(this.querySelectorAll(t)).take(n)}}}()).flatten()},querySelectorAll:function(t){return this.filter("*").reduce(function(n,e){return n.extend(e.querySelectorAll(t))},$())},clone:function(t=!0,n=1){var e;return e=function(n){if($.is("node",n))return n.cloneNode(t)},this.map(function(){var t,r,i;switch(n){case 1:return e(this);default:for(i=[],t=0,r=n;t<r;t+=1)i.push(e(this));return i}})},toFragment:function(){var t;return this.length>1?(t=document.createDocumentFragment(),this.map(s).map(function(n){return t.appendChild(n)}),t):s(this[0])}}}),$.plugin({provides:"EventEmitter",depends:"type,hook"},function(){return{$:{EventEmitter:$.init.append(function(t){var n,e,r;return t!==$.global&&null!==t&&void 0!==t||(t=this===$.global||this===$?{}:this),r=Object.create(null),e=function(t){return r[t]||(r[t]=[])},$.inherit({emit:function(t,...n){var r;return function(){var i,u,o,s;for(s=[],i=0,u=(o=e(t)).length;i<u;i++)r=o[i],s.push(r.apply(this,n));return s}.call(this),this},on:n=function(t,n){var r,i;for(r in"string"==typeof t&&e(t).push(n),t)i=t[r],"object"==typeof t&&this.addListener(r,i);return this},addListener:n,removeListener:function(t,n){var r,i;if((r=(i=e(t)).indexOf(n))>-1)return i.splice(r,1)},removeAllListeners:function(t){return r[t]=[]},setMaxListeners:function(){},listeners:function(t){return e(t).slice(0)}},t)})}}}),$.plugin({depends:"dom,function,core",provides:"event,bind,unbind,trigger,delegate,undelegate,click,ready"},function(){var t,n,e,r,i,u,o,s;return t=/,* +/,u=["mousemove","mousedown","mouseup","mouseover","mouseout","blur","focus","load","unload","reset","submit","keyup","keydown","keypress","change","abort","cut","copy","paste","selection","drag","drop","orientationchange","touchstart","touchmove","touchend","touchcancel","gesturestart","gestureend","gesturecancel","hashchange"],i=function(t){return function(n){return $.is("function",n)?this.bind(t,n):this.trigger(t,n)}},e=function(t,...n){var r;return 0===n.length?t:e(t[r=n[0]]||(t[r]=Object.create(null)),...n.slice(1))},s=$.once(function(){var t;return $(document).trigger("ready").unbind("ready"),"function"==typeof document.removeEventListener&&document.removeEventListener("DOMContentLoaded",s,!1),"function"==typeof(t=$.global).removeEventListener?t.removeEventListener("load",s,!1):void 0}),"function"==typeof document.addEventListener&&document.addEventListener("DOMContentLoaded",s,!1),"function"==typeof(r=$.global).addEventListener&&r.addEventListener("load",s,!1),o={bind:(n=function(n){return function(e,r){var i;return i=(e||"").split(t),this.each(function(){var t,e,u,o;for(o=[],e=0,u=i.length;e<u;e++)t=i[e],o.push(this[n](t,r,!0));return o})}})("addEventListener"),unbind:n("removeEventListener"),trigger:function(n,e={}){var r,i,u,o,s;for(e=$.extend({bubbles:!0,cancelable:!0},e),u=0,o=(s=(n||"").split(t)).length;u<o;u++){switch(i=s[u]){case"click":case"mousemove":case"mousedown":case"mouseup":case"mouseover":case"mouseout":r=document.createEvent("MouseEvents"),e=$.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null},e),r.initMouseEvent(i,e.bubbles,e.cancelable,$.global,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);break;case"blur":case"focus":case"reset":case"submit":case"abort":case"change":case"load":case"unload":(r=document.createEvent("UIEvents")).initUIEvent(i,e.bubbles,e.cancelable,$.global,1);break;case"touchstart":case"touchmove":case"touchend":case"touchcancel":r=document.createEvent("TouchEvents"),e=$.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,touches:[],targetTouches:[],changedTouches:[],scale:1,rotation:0},e),r.initTouchEvent(i,e.bubbles,e.cancelable,$.global,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.touches,e.targetTouches,e.changedTouches,e.scale,e.rotation);break;case"gesturestart":case"gestureend":case"gesturecancel":r=document.createEvent("GestureEvents"),e=$.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,target:null,scale:1,rotation:0},e),r.initGestureEvent(i,e.bubbles,e.cancelable,$.global,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.target,e.scale,e.rotation);break;case"keydown":case"keypress":case"keyup":r=document.createEvent("KeyboardEvents"),e=$.extend({view:null,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},e),r.initKeyboardEvent(i,e.bubbles,e.cancelable,$.global,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);break;default:(r=document.createEvent("Events")).initEvent(i,e.bubbles,e.cancelable),r=$.extend(r,e)}r&&this.each(function(){var t;try{return this.dispatchEvent(r)}catch(n){return t=n,$.log("dispatchEvent error:",t)}})}return this},delegate:function(t,n,r){var i,u,o,s,c;for(i=function(n){var e,i;if(i=null!=(e=$(n.target).parents()[0])?e.unshift(n.target).filter(t)[0]:void 0)return r.call(n.target=i,n)},u=0,o=(c=this.bind(n,i)).length;u<o;u++)s=c[u],e(s,"__delegates__",t,n)[r]=i;return this},undelegate:function(t,n,r){var i,u,o,s,c;for(this,c=[],u=0,o=this.length;u<o;u++)s=this[u],(i=e(s,"__delegates__",t,n))&&i[r]?(this.unbind(n,i[r]),c.push(delete i[r])):c.push(void 0);return c},click:function(t={}){var n;return"auto"!==(n=this.css("cursor"))&&""!==n||this.css("cursor","pointer"),$.is("function",t)?this.bind("click",t):this.trigger("click",t),this},ready:function(t){return s.exhausted?t.call(this):this.bind("ready",t)}},u.forEach(function(t){return o[t]=i(t)}),o}),$.plugin({provides:"function,identity,compose,once,cycle,bound,partial",depends:"extend,is,defineProperty,map"},function(){return{$:{identity:function(t){return t},not:function(t){return function(){return!t.apply(this,arguments)}},compose:function(t,n){return function(e){var r;return t.call(r,r=n.call(e,e))}},and:function(t,n){return function(e){return n.call(this,e)&&t.call(this,e)}},once:function(t,n=1){return $.defineProperty(function(){if(n-- >0)return t.apply(this,arguments)},"exhausted",{get:function(){return n<=0}})},cycle:function(...t){var n;return n=-1,function(){return t[n=++n%t.length].apply(this,arguments)}},bound:function(t,n,e=[]){var r;return null==n?$.identity:($.is("function",n.bind)?(e.splice(0,0,t),r=n.bind.apply(n,e)):r=function(...r){return n.apply(t,e.length?e:r)},$.extend(r,{toString:function(){return`bound-method of ${t}.${n.name}`}}))},partial:function(t,...n){return function(...e){return t(...n,...e)}}},partial:function(...t){return this.map(function(n){return $.partial(n,...t)})}}}),$.plugin(function(){var t;return Object.assign(function*(){return yield}().constructor.prototype,{toArray:function(){var t,n;for(n of(t=[],this,this))t.push(n);return t},skip:function(t){for(;t-- >0;)this.next();return this},limit:function*(t){for(var n;t-- >0;){if((n=this.next()).done)return;yield n.value}return null},map:function*(t){var n;for(n of(this,this))yield t(n);return null},filter:function*(t,n=!0){var e;for(e of(this,this))t(e)===n&&(yield e);return null},select:function*(n){var e;for(e of(n=n.split("."),this,this))yield t(e,n);return null}}),t=function(t,n){var e,r,i;for(e=0,r=n.length;e<r;e++)i=n[e],t=null!=t?t[i]:void 0;return t},{}}),$.plugin({provides:"hash",depends:"type"},function(){var t;return 4294967295,t=function(t){return function(n){var e;return t+$(function(){var t,r,i;for(i=[],t=0,r=n.length;t<r;t++)e=n[t],i.push($.hash(e));return i}()).reduce(function(t,n){return(t*t+(0|n))%4294967295},1)}},$.type.extend({unknown:{hash:function(t){return $.checksum($.toString(t))}},object:{hash:function(t){var n,e;return 1970931729+$(function(){var r;for(n in r=[],t)e=t[n],r.push($.hash(n)+$.hash(e));return r}()).sum()}},array:{hash:t(1816922041)},arguments:{hash:t(298517431)},bling:{hash:t(92078573)},bool:{hash:function(t){return parseInt(t?1:void 0)}},regexp:{hash:function(t){return 148243084+$.checksum($.toString(t))}}}),{$:{hash:function(t){return $.type.lookup(t).hash(t)}},hash:function(){return $.hash(this)}}}),$.plugin(function(){return{$:{histogram:function(t,n=1,e=60){var r,i,u,o,s,c,a,l,f,h,p,d,g,v,m,y,b,k;for(r=$(),c=0,p=Infinity,h=0,f=0,b=0,o=0,a=t.length;o<a;o++)k=t[o],p=Math.min(k,p),f=Math.max(k,f),b+=k,(u=Math.floor(k/n))in r?r[u]+=1:r[u]=1,c=Math.max(c,u+1);for(r.length=c,h=b/t.length,l=r.max(),y=(r=r.or(0).scale(1/l).scale(e)).sum(),m="",g=0,d=s=0,v=c;s<v;d=s+=1)i=(d+1)*n,(g+=100*r[d]/y)>0&&(m+=$.padLeft(g.toFixed(2)+"%",7)+$.padRight(` < ${i.toFixed(2)}`,10)+": "+$.repeat("#",r[d])+"\n");return m+`N: ${t.length} Min: ${p.toFixed(2)} Max: ${f.toFixed(2)} Mean: ${h.toFixed(2)}`}},histogram:function(){return $.histogram(this)}}}),$.plugin({provides:"hook",depends:"type"},function(){var t;return t=function(){var t;return t=[],$.extend(function(n){var e,r;for(e=0,r=t.length;e<r;e++)n=t[e].call(this,n);return n},{prepend:function(n){return t.unshift(n),n},append:function(n){return t.push(n),n}})},$.init=t(),{$:{hook:t}}}),$.plugin({depends:"dom",provides:"http"},function(){var t;return t=function(t){var n,e;return $.is("object",t)?(e=JSON.parse(JSON.stringify(t)),function(){var t;for(n in t=[],e)t.push(`${n}=${escape(e[n])}`);return t}().join("&")):t},$.type.register("http",{is:function(t){return $.isType("XMLHttpRequest",t)},array:function(t){return[t]}}),{$:{http:function(n,e={}){var r,i,u,o,s,c,a;for(u in a=new XMLHttpRequest,s=$.Promise(),$.is("function",e)&&(e={success:$.bound(a,e)}),(e=$.extend({method:"GET",data:null,state:$.identity,success:$.identity,error:$.identity,async:!0,asBlob:!1,timeout:0,followRedirects:!1,withCredentials:!1,headers:{}},e)).state=$.bound(a,e.state),i=$.bound(a,e.success),r=$.bound(a,e.error),e.success=function(t){return s.resolve(t),i(t)},e.error=function(t){return s.reject(t),r(t)},e.data&&"GET"===e.method?n+="?"+t(e.data):e.data&&"POST"===e.method&&(e.data=t(e.data)),a.open(e.method,n,e.async),a=$.extend(a,{asBlob:e.asBlob,timeout:e.timeout,followRedirects:e.followRedirects,withCredentials:e.withCredentials,onreadystatechange:function(){if("function"==typeof e.state&&e.state(),4===a.readyState)return 200===a.status?e.success(a.responseText):e.error(a.status,a.statusText)}}),o=e.headers)c=o[u],a.setRequestHeader(u,c);try{a.addEventListener("progress",t=>($.log("xhr progress event",t.loaded,t.total),s.emit("progress",t.loaded,t.total)))}catch(t){}return a.send(e.data),$.extend(s,{cancel:function(){return a.cancel()}})},post:function(t,n={}){return $.is("function",n)&&(n={success:n}),n.method="POST",$.http(t,n)},get:function(t,n={}){return $.is("function",n)&&(n={success:n}),n.method="GET",$.http(t,n)}}}}),$.depends("hook",function(){return $.init.append(function(t){var n,e;return e=new Map,n=[],$.inherit({index:function(t){var r,i,u,o,s;for(-1===n.indexOf(t)&&(n.push(t),e.set(t,new Map)),this,i=0,o=this.length;i<o;i++)u=t(s=this[i]),(r=e.get(t)).has(u)||r.set(u,$()),r.get(u).push(s);return this},query:function*(t){var r,i,u,o,s,c,a,l;for(i=0,c=n.length;i<c;i++)if(s=n[i],(r=e.get(s)).has(o=s(t)))for(u=0,a=(l=r.get(o)).length;u<a;u++)if(!1===(yield l[u]))return;return null},queryOne:function(t){return this.query(t).next().value}},t)})}),$.plugin({provides:"toHTML",depends:"type,synth,once"},function(){var t,n,e,r;return n=$.once(function(){try{return $("head").append($.synth("style#dump").text("table.dump                { border: 1px solid black; }\ntable.dump tr.h           { background-color: blue; color: white; cursor: pointer; }\ntable.dump tr.h th        { padding: 0px 4px; }\ntable.dump tr.h.array     { background-color: purple; }\ntable.dump tr.h.bling     { background-color: gold; }\ntable.dump td             { padding: 2px; }\ntable.dump td.k           { background-color: lightblue; }\ntable.dump td.v.string    { background-color: #cfc; }\ntable.dump td.v.number    { background-color: #ffc; }\ntable.dump td.v.bool      { background-color: #fcf; }"))}catch(t){}}),t=$.once(function(){try{return $("head").append($.synth("script#dump").text("$(document.body).delegate('table.dump tr.h', 'click', function() {\n\t$(this.parentNode).find(\"tr.kv\").toggle()\n})"))}catch(t){}}),e=function(t,n){var e,r,i,u;for(u=$.synth(`table.dump tr.h.${t} th[colspan=2] '${t}'`),"array"!==t&&"bling"!==t&&"nodelist"!==t||u.find("th").appendText(` [${n.length}]`),e=0,r=n.length;e<r;e++)i=n[e],u.append(i);return u[0]},r=function(t,n,e){var r,i,u;switch(u=(i=$.synth(`tr.kv td.k[align=right][valign=top] '${t}' + td.v`)).find("td.v"),r=$.type(n=$.toHTML(n,e))){case"string":case"number":case"bool":case"html":case"null":case"undefined":u.appendText(String(n));break;default:u.append(n)}return u.addClass(r),e||i.toggle(),i},{$:{toHTML:function(i,u=!0){var o,s,c,a;switch(n(),t(),c=$.type(i)){case"string":case"number":case"bool":case"null":case"undefined":case"html":return i;case"bling":case"array":case"nodelist":return e(c,function(){var t,n,e;for(e=[],o=t=0,n=i.length;t<n;o=++t)a=i[o],e.push(r(o,a,u));return e}());case"object":case"array":return e(c,function(){var t;for(o in t=[],i)a=i[o],t.push(r(o,a,u));return t}());case"node":return(s=$.HTML.stringify(i)).substr(0,s.indexOf(">")+1)+"...";default:return String(i)}}}}}),$.plugin({provides:"keyName,keyNames",depends:"math"},function(){var t,n,e,r,i,u,o,s,c,a,l;for(i={Backspace:8,BS:8,Tab:9,"\t":9,Enter:13,"\n":12,Shift:16,Ctrl:17,Alt:18,Pause:19,Break:19,Caps:20,"Caps Lock":20,Esc:27,Escape:27,Space:32," ":32,PgUp:33,"Page Up":33,PgDn:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,Delete:46,Times:106,"*":106,Plus:107,"+":107,Minus:109,"-":109,Div:111,Divide:111,"/":111,"Semi-Colon":186,";":187,Equal:187,"=":187,Comma:188,",":188,Dash:189,"-":189,Dot:190,Period:190,".":190,"Forward Slash":191,"/":191,"Back Slash":220,"\\":220,"Single Quote":222,"'":222},e=0,o=(a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ").length;e<o;e++)i[t=a[e]]=i[t.toLowerCase()]=t.charCodeAt(0);for(r=0,s=(l=$.range(1,13)).length;r<s;r++)t=l[r],i["F"+t]=i["f"+t]=111+t;for(c in u={},i)n=i[c],u[n]||(u[n]=c);return{$:{keyCode:function(t){var n;return null!=(n=i[t])?n:t},keyName:function(t){var n;return null!=(n=u[t])?n:t}}}}),$.plugin({depends:"dom,promise",provides:"lazy"},function(){var t;return t=function(t,n){var e,r;return r=$.Promise(),document.head.appendChild(e=$.extend(document.createElement(t),n,{onload:function(){return r.resolve(e)},onerror:function(){return r.reject.apply(r,arguments)}})),r},{$:{script:function(n){return t("script",{src:n})},style:function(n){return t("link",{href:n,rel:"stylesheet"})}}}}),$.plugin({provides:"log, logger",depends:"bound"},function(){var t,n,e,r;return t={_MS:"",SS:"",MM:"",HH:"",dd:"",mm:"",yyyy:""},r=0,n=(()=>{var n,e,i,u,o,s,c,a;return i=(n=new Date)-r,r=n,t._MS===(c=$.padLeft(n.getUTCMilliseconds(),3,"0"))&&i%1e3!=0||(t._MS=c,t.SS!==(a=$.padLeft(n.getUTCSeconds(),2,"0"))&&(t.SS=a,t.MM!==(o=$.padLeft(n.getUTCMinutes(),2,"0"))&&(t.MM=o,t.HH!==(u=$.padLeft(String(n.getUTCHours()),2,"0"))&&(t.HH=u,t.dd!==(e=$.padLeft(String(n.getUTCDate()),2,"0"))&&(t.dd=e,t.mm!==(s=$.padLeft(String(n.getUTCMonth()+1),2,"0"))&&(t.mm=s,t.yyyy=String(n.getUTCFullYear()))))))),`${t.yyyy}-${t.mm}-${t.dd} ${t.HH}:${t.MM}:${t.SS}.${t._MS}`}),(e=function(...t){var n;if(t.length)return(n="function"==typeof e.pre?e.pre():void 0)&&t.unshift(n),e.out(...t),t[t.length-1]}).out=console.log.bind(console),e.pre=null,e.enableTimestamps=function(t=2){return e.pre=[null,function(){return String(+new Date)},n][t]},e.disableTimestamps=function(){return e.enableTimestamps(0)},{$:{log:e,logger:function(t){return function(...n){return n.unshift(t),e(...n)}}}}}),$.plugin({provides:"matches",depends:"function,core,string"},function(){var t,n,e,r,i,u,o,s,c,a,l,f,h,p,d;for(h in r={function:[["array","bling",t=function(t,n,e){var r,i,u;for(r=0,i=n.length;r<i;r++)if(u=n[r],l(t,u,e))return!0;return!1}],["object",n=function(t,n,e){var r,i;for(r in n)if(i=n[r],l(t,i,e))return!0;return!1}]],regexp:[["string","number",function(t,n,e){return t.test(String(n))}],["array","bling",t],["object",n]],object:[["array","bling",t],["object",function(t,n,e){var r,i;for(r in t)if(i=t[r],!l(i,n[r]))return!1;return!0}]],array:[["array","bling",function(t,n,e){var r,i,u,o;for(r=i=0,u=t.length;i<u;r=++i)if(o=t[r],!l(o,n[r]))return!1;return!0}]],number:[["number",e=function(t,n,e){return n===t}],["array","bling",t]],string:[["string",e],["array","bling",t]]}){for(l={},u=0,s=(d=r[h]).length;u<s;u++)for(a=d[u],i=a.pop(),o=0,c=a.length;o<c;o++)f=a[o],l[f]=i;$.type.extend(h,{matches:l})}return p={$any:function(){return!0},$type:function(t,n,e){return $.is(t.$type,n)},$class:function(t,n,e){return $.isType(t.$class,n)},$lt:function(t,n,e){return n<t.$lt},$gt:function(t,n,e){return n>t.$gt},$lte:function(t,n,e){return n<=t.$lte},$gte:function(t,n,e){return n>=t.$gte},$ne:function(t,n,e){return n!==t.$ne}},(l=function(t,n,r=$.type.lookup(t)){var u,o,s,c,a;if("object"===r.name)for(u in p)if(i=p[u],u in t)return i(t,n,r);for(a in o=r.matches)if(i=o[a],"else"!==a&&$.is(a,n))return i(t,n,r);return null!=(s=null!=(c=r.matches)&&"function"==typeof c.else?c.else(t,n,r):void 0)?s:e(t,n)}).Any={$any:!0},l.Type=function(t){return{$type:t}},l.Class=function(t){return{$class:t}},{$:{matches:l}}}),$.plugin({provides:"math",depends:"core"},function(){var t,n,e,r;return $.type.extend({bool:{number:function(t){return t?1:0}},number:{bool:function(t){return!!t}}}),{$:{range:function(t,n,e=1){var r;return null==n&&(n=t,t=0),n<t&&e>0&&(e*=-1),$(function(){var i,u,o;for(o=[],r=i=0,u=Math.ceil((n-t)/e);0<=u?i<u:i>u;r=0<=u?++i:--i)o.push(t+r*e);return o}())},zeros:function(t,n=0){return $(function(){var e,r,i;for(i=[],e=0,r=t;0<=r?e<r:e>r;0<=r?++e:--e)i.push(n);return i}())},ones:function(t){return $(function(){var n,e,r;for(r=[],n=0,e=t;0<=e?n<e:n>e;0<=e?++n:--n)r.push(1);return r}())},deg2rad:function(t){return t*Math.PI/180},rad2deg:function(t){return 180*t/Math.PI}},floats:function(){return this.map(parseFloat)},ints:function(){return this.map(function(){return parseInt(this,10)})},px:function(t){return this.ints().map(function(){return $.px(this,t)})},min:function(){return this.filter(isFinite).reduce(Math.min)},max:function(){return this.filter(isFinite).reduce(Math.max)},maxBy:(t=function(t){return function(n){var e,r;return e=function(){switch(!1){case!$.is("string",n):return function(t){return t[n]};case!$.is("function",n):return n;default:throw new Error(".maxBy first argument should be a string or function")}}(),r=this.first(),this.skip(1).each(function(n){if(t(e(n),e(r)))return r=n}),r}})(function(t,n){return t>n}),minBy:t(function(t,n){return t<n}),mean:e=function(){return this.length?this.sum()/this.length:0},avg:e,sum:function(){var t,n,e,r;for(e=0,this,t=0,n=this.length;t<n;t++)null!=(r=this[t])&&isFinite(r)&&(e+=r);return e},product:function(){return this.filter(isFinite).reduce(function(t){return t*this})},squares:function(){return this.pow(2)},pow:function(t){return this.map(function(){return Math.pow(this,t)})},magnitude:function(){return Math.sqrt(this.floats().squares().sum())},scale:function(t){return this.map(function(){return t*this})},add:n=function(t){var n;switch($.type(t)){case"number":return this.map(function(){return t+this});case"bling":case"array":return $(function(){var e,r,i;for(i=[],n=e=0,r=Math.min(this.length,t.length);0<=r?e<r:e>r;n=0<=r?++e:--e)i.push(this[n]+t[n]);return i}.call(this))}},plus:n,sub:r=function(t){var n;switch($.type(t)){case"number":return this.map(function(){return this-t});case"bling":case"array":return $(function(){var e,r,i;for(i=[],n=e=0,r=Math.min(this.length,t.length);0<=r?e<r:e>r;n=0<=r?++e:--e)i.push(this[n]-t[n]);return i}.call(this))}},minus:r,dot:function(t){var n;return $.sum(function(){var e,r,i;for(i=[],n=e=0,r=Math.min(this.length,t.length);0<=r?e<r:e>r;n=0<=r?++e:--e)i.push(this[n]*t[n]);return i}.call(this))},angle:function(t){return Math.acos(this.dot(t)/(this.magnitude()*t.magnitude()))},cross:function(t){return $(this[1]*t[2]-this[2]*t[1],this[2]*t[0]-this[0]*t[2],this[0]*t[1]-this[1]*t[0])},normalize:function(){return this.scale(1/this.magnitude())},deg2rad:function(){return this.filter(isFinite).map(function(){return this*Math.PI/180})},rad2deg:function(){return this.filter(isFinite).map(function(){return 180*this/Math.PI})}}}),$.plugin({depends:"function,hash",provides:"memoize"},function(){var t;return t=function(){var t;return t={},{has:function(n){return n in t},get:function(n){return t[n]},set:function(n,e){return t[n]=e}}},{$:{memoize:function(n){if($.is("function",n)&&(n={f:n}),!$.is("object",n))throw new Error("Argument Error: memoize requires either a function or object as first argument");return n.cache||(n.cache=t()),n.hash||(n.hash=$.hash),function(){var t;return t=n.hash(arguments),n.cache.has(t)?n.cache.get(t):n.cache.set(t,n.f.apply(this,arguments))}}}}}),$.plugin({provides:"middleware",depends:"type"},function(){return{$:{middleware:function(t=[]){var n;return n=$(),{catch:function(t){return n.push(t),this},use:function(n){return t.push(n),this},unuse:function(n){for(var e;(e=t.indexOf(n))>-1;)t.splice(e,1);return this},invoke:function(...e){var r,i;return r=-1,(i=(()=>{var u;try{return t[++r](...e,i)}catch(t){return u=t,n.call(u)}}))(),this}}}}}}),$.plugin({depends:"core,function",provides:"promise"},function(){var t,n,e;return t=class{},(e=function(n){var e,r,i,u,o,s,c,a,l,f;return n!==$.global&&null!==n&&void 0!==n||(n=this===$?{}:this),f=[],u=a=t,e=function(t,n){for(var e;e=f.shift();)r(e,t,n);return null},r=function(t,n,e){var r,i,u,o,s;null!=(s=t.timeout)&&s.cancel();try{t(n,e)}catch(n){u=n,o=$.debugStack(u),$.log(`Promise(${l.promiseId}) first-chance exception:`,o);try{t(u,null)}catch(t){r=t,i=$.debugStack(r),$.log(`Promise(${l.promiseId}) last-chance exception:`,i)}}return null},i=((n,r)=>{if(u===a&&a===t)switch(n!==t?(u=n,(null!=n?n.stack:void 0)||(u=new Error(n))):r!==t&&(a=r),!0){case r===this:return i(new TypeError("cant resolve a promise with itself"));case null!=r&&r.then&&r.catch:r.then(function(t){return i(null,t)}),r.catch(function(t){return i(t,null)});break;case $.is("promise",r):r.wait(i);break;case n!==t:e(u,null);break;case r!==t:e(null,a)}return this}),l=$.inherit({promiseId:$.random.string(6),wait:function(n,e){return $.is("function",n)&&([e,n]=[n,Infinity]),u!==t?r(e,u,null):a!==t?r(e,null,a):(f.push(e),isFinite(parseFloat(n))&&(e.timeout=$.delay(n,()=>{var t;if((t=f.indexOf(e))>-1)return f.splice(t,1),r(e,u=new Error("timeout"),void 0)}))),this},then:function(t,n){return this.wait(function(e,r){return e?"function"==typeof n?n(e):void 0:t(r)})},finish:function(n){return i(t,n),this},resolve:function(n){return i(t,n),this},fail:function(n){return i(n,t),this},reject:function(n){return i(n,t),this},reset:function(){return u=a=t,this},handler:function(t,n){return t?l.reject(t):l.resolve(n)},inspect:function(){return`{Promise[${this.promiseId}] ${o()}}`},toString:function(){return`{Promise[${this.promiseId}] ${o()}}`}},$.EventEmitter(n)),o=function(){switch(!1){case a===t:return"resolved";case u===t:return"rejected";default:return"pending"}},c=function(){return a!==t},$.defineProperty(l,"finished",{get:c}),$.defineProperty(l,"resolved",{get:c}),s=function(){return u!==t},$.defineProperty(l,"failed",{get:s}),$.defineProperty(l,"rejected",{get:s}),l}).compose=e.parallel=function(...t){var n;return t=$(t).flatten(),n=$.Progress(1+t.length),$(t).select("wait").call(function(t){return t?n.reject(t):n.resolve(1)}),n.resolve(1)},e.collect=function(t){var n,e,r,i,u,o,s;if(s=[],i=$.Promise(),null==t)return i.resolve(s);for(o=$.Progress(1+t.length),n=e=0,r=t.length;e<r;n=++e)u=t[n],function(t){u.wait(function(n,e){return n?o.reject(n):o.resolve(1,s[t]=e)})}(n);return o.then(function(){return i.resolve(s)},i.reject),o.resolve(1),i},e.wrapCall=function(t,...n){var e;return e=$.Promise(),t(...n,function(t,n){return t?e.reject(t):e.resolve(n)}),e},n=function(t=1){var n,r;return n=0,r=$.inherit({progress:function(...e){var i,u,o;return e.length?(n=null!=(u=e[0])?u:n,e.length>1&&(t=null!=(o=e[1])?o:t),i=e.length>2?e[2]:n,n>=t&&r.__proto__.__proto__.resolve(i),r.emit("progress",n,t,i),this):n},resolve:function(e,i=e){return isFinite(e)||(e=1),r.progress(n+e,t,i)},finish:function(t,n){return r.resolve(t,n)},include:function(e){return $.is("promise",e)&&(r.progress(n,t+1),e.wait(function(t,n){return t?r.reject(t):r.resolve(n)})),this},inspect:function(){return`{Progress[${r.promiseId}] ${n}/${t}}`}},e())},e.xhr=function(t){var n;return n=$.Promise(),t.onreadystatechange=function(){if(this.readyState===this.DONE)return 200===this.status?n.resolve(t.responseText):n.resolve(`${this.status} ${this.statusText}`)},n},e.series=function(...t){var n,e;return t=$(t).flatten(),e=function(r){return function(){if(!(r>=t.length))return t[r]=t[r]().wait(function(i,u){return n.resolve(t[r]=[i,u]),$.immediate(e(r+1))})}},n=$.Progress(t.length),$.immediate(e(0)),n},$.depends("dom",function(){return e.image=function(t){var n,e;return e=$.Promise(),$.extend(n=new Image,{onerror:function(t){return e.reject(t)},onload:function(){return e.resolve(n)},src:t}),e}}),$.depends("type",function(){return $.type.register("promise",{is:function(t){return null!=t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then&&2===t.then.length}})}),{$:{Promise:e,Progress:n}}}),$.plugin({provides:"prompt,confirm",depends:"synth,keyName"},function(){var t;return t=function(){if(!$("head .prompt").length)return $("head").append("<style class='prompt'>"+$.CSS.stringify({".prompt":{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:"999999",background:"rgba(0,0,0,.4)",fontSize:"12px"," input":{padding:"2px",margin:"0px 0px 4px -4px",width:"100%"}," button":{fontSize:"13px",".done":{fontSize:"14px"}}," > center":{width:"200px",height:"44px",margin:"20px auto",padding:"16px",background:"#ffc",borderRadius:"5px"}}})+"</style>")},{$:{prompt:function(n,e,r){var i,u,o,s,c;return t(),u=$.synth(`div.prompt center\n\tinput[type=${e}][placeholder=${n}] + br +\n\tbutton.cancel 'Cancel' +\n\tbutton.done 'Done'`).appendTo("body").first(),(c=u.querySelector("input")).onkeydown=function(t){switch($.keyName(t.keyCode)){case"Enter":return o(c.value);case"Esc":return o(null)}},s=u.querySelector("button.done"),i=u.querySelector("button.cancel"),o=function(t){return delete s.onclick,delete i.onclick,u.parentNode.removeChild(u),r(t)},s.onclick=function(){return o(c.value)},i.onclick=function(){return o(null)},null},confirm:function(...n){var e,r,i,u,o,s,c,a;switch(r=n.pop(),s=n.shift(),e=n.length>0?n:{Yes:!0,No:!1},t(),i=(u=$.synth(`div.prompt center\n\tspan '${s}' + br`).appendTo("body")).find("center"),$.type(e)){case"array":case"bling":for(o=0,c=e.length;o<c;o++)s=e[o],$.synth(`button[value=${s}] '${s}'`).appendTo(i);break;case"object":for(s in e)a=e[s],$.synth(`button[value=${a}] '${s}'`).appendTo(i)}return u.find("button").bind("click",function(t){return u.remove(),r(t.target.getAttribute("value"))}),null}}}}),$.plugin({depends:"core",provides:"pubsub"},function(){var t,n,e,r,i,u;for(n in i={$:{Hub:t=class{constructor(){this.listeners={}}publish(t,...n){var e,r,i,u,o,s;for(r=null,i=0,u=(s=(e=this.listeners)[t]||(e[t]=[])).length;i<u;i++)if(o=s[i],this.filter(o,...n))try{o(...n)}catch(t){null==r&&(r=t)}if(r)throw r;switch(n.length){case 0:return null;case 1:return n[0];default:return n}}filter(t,n){return!("patternObject"in t)||$.matches(t.patternObject,n)}publisher(t,n){var e;return e=this,function(){return e.publish(t,n.apply(this,arguments))}}subscribe(t,...n){var e,r;return r=n.pop(),n.length>0&&(r.patternObject=n.pop()),((e=this.listeners)[t]||(e[t]=[])).push(r),r}unsubscribe(t,n){var e,r,i;return null==n?this.listeners[t]=[]:(i=(e=(r=this.listeners)[t]||(r[t]=[])).indexOf(n))>-1&&e.splice(i,1),n}}}},u=new t,r=Object.getOwnPropertyDescriptors(t.prototype))e=r[n],"constructor"!==n&&"function"==typeof e.value&&(i.$[n]=e.value.bind(u));return i}),$.plugin({provides:"random",depends:"type"},function(){var t,n,e,r,i,u,o,s,c,a,l,f;return r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",({floor:i,abs:t,log:o}=Math),4294967295,l=new Uint32Array(2),s=function(){var t,n,e;return t=((n=l[0])+(e=l[1]))%4294967295,e^=n,l[0]=n<<27|n>>>5^e^e<<7,l[1]=e<<18|e>>>14,t},c=function(){return s()/4294967295},$.defineProperty(c,"seed",{set:function(t){return l[0]=t,l[1]=1,s(),s(),s(),t}}),c.seed=+new Date,{$:{random:$.extend(c,{real:a=function(t,n){return null==t&&([t,n]=[0,1]),null==n&&([t,n]=[0,t]),c()*(n-t)+t},integer:u=function(t,n){return i(a(t,n))},string:f=function(t,n="",i=r){for(;n.length<t;)n+=e(i);return n},coin:function(t=.5){return c()<=t},element:e=function(t,n){var e,r,i,o,s,a,l,f;if(null!=n)for(f=(f=$(n)).scale(1/f.sum()),e=0,a=$(t).map(function(t){return{v:t,w:f[e++]}}).sortBy(function(t){return-t.w}),s=c(),l=0,r=0,o=a.length;r<o;r++)if((l+=(i=a[r]).w)>=s)return i.v;return t[u(0,t.length)]},gaussian:function(n=.5,e=.12){for(var r,i,u,s,a;i=c(),u=1.7156*(c()-.5),(r=(s=i-.449871)*s+(a=t(u)+.386595)*(.196*a-.25472*s))>.27597&&(r>.27846||u*u>-4*o(i)*i*i););return n+e*u/i},die:n=function(t){return u(1,t+1)},dice:function(t,e){return $(function(){var r,i,u;for(u=[],r=0,i=t;r<i;r+=1)u.push(n(e));return u}())},uuid:function(){return $(8,4,4,4,12).map(function(){return f(this,"","ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")}).join("-")}})}}}),$.plugin({provides:"render",depends:"promise, type, logger"},function(){var t,n,e,r,i,u,o,s,c;return $.logger("[render]"),r=function(t,n,e=$.Promise()){return $.is("promise",t)?(t.wait(function(t,i){var u;return t?e.reject(t):(u=o(i,n),$.is("promise",u)?r(u,n,e):e.resolve(u))}),e):$.Promise().resolve(o(t,n))},u={text:function(t,n){var e;return o(t[null!=(e=n.lang)?e:"EN"],n)}},(c=function(t,n={}){return r(o([t],n),n)}).register=s=function(t,n){return u[t]=n},c.reduce=o=function(t,n){var e;return(e=$.type.lookup(t)).reduce(t,e,n)},$.type.extend({unknown:{reduce:function(t,n,e){return`[ cant reduce type: ${n} ]`}},string:{reduce:$.identity},html:{reduce:$.identity},null:{reduce:function(t,n,e){return n}},undefined:{reduce:function(t,n,e){return n}},number:{reduce:function(t,n,e){return String(t)}},function:{reduce:function(t,n,e){switch(f.length){case 0:case 1:return o(f(e));default:return $.Promise.wrap(f,e)}}},object:{reduce:function(t,n,e){var r;return(n=null!=(r=t.t)?r:t.type)in u?u[n].call(t,t,e):`[ no handler for object type: '${n}' ${JSON.stringify(t).substr(0,20)}... ]`}},promise:{reduce:function(t,n,e){var r,i;return i=$.Promise(),t.wait(r=function(t,n){var u;return t?i.reject(t):$.is("promise",u=o(n,e))?u.wait(r):i.resolve(u)}),i}},array:{reduce:e=function(t,n,e){var r,u,s,c,a,l,f,h;for(f=$.Progress(a=1),h=$.Promise(),l=[],f.wait(function(t){return t?h.reject(t):h.resolve(i(l,e))}),r=!1,u=s=0,c=t.length;s<c;u=++s)!function(t,n){var i,u;if(l[n]=u=o(t,e),$.is("promise",u))r=!0,f.progress(null,++a),u.wait(i=function(t,r){var u;return t?f.reject(t):(u=o(r,e),$.is("promise",u)?u.wait(i):f.resolve(l[n]=u))})}(t[u],u);return f.resolve(1),r?h:i(l)}},bling:{reduce:e}}),i=function(t,n){var e;return(e=$.type.lookup(t)).finalize(t,e,n)},$.type.extend({unknown:{finalize:function(t,n,e){return`[ cant finalize type: ${n} ]`}},string:{finalize:$.identity},html:{finalize:$.identity},number:{finalize:function(t,n,e){return String(t)}},array:{finalize:n=function(t,n,e){var r;return function(){var n,u,o;for(o=[],n=0,u=t.length;n<u;n++)r=t[n],o.push(i(r,e));return o}().join("")}},bling:{finalize:n},null:{finalize:function(){return"null"}},undefined:{finalize:function(){return"undefined"}}}),t=function(t){return u[t]},s("link",function(t,n){var e;return["<a",function(){var n,r,i,u;for(u=[],n=0,r=(i=["href","name","target"]).length;n<r;n++)(e=i[n])in t&&u.push([` ${e}='`,t[e],"'"]);return u}(),">",o(t.content,n),"</a>"]}),s("a",t("link")),s("let",function(t,n){var e,r;return r=n[t.name],n[t.name]=t.value,e=o(t.content,n),void 0===r?delete n[t.name]:n[t.name]=r,e}),s("set",t("let")),s("get",function(t,n){return o(n[t.name],n)}),{$:{render:c}}}),$.plugin({provides:"sortBy,sortedIndex,sortedInsert,groupBy"},function(){return{$:{sortedIndex:function(t,n,e,r=0,i=t.length){var u,o;for(u=function(){switch(!0){case $.is("string",e):return function(t,n){return t[e]<n[e]};case $.is("function",e):return function(t,n){return e(t)<e(n)};default:return function(t,n){return t<n}}}();r<i;)u(t[o=i+r>>>1],n)?r=o+1:i=o;return r}},sortBy:function(t){var n,e,r,i;for(n=$(),this,e=0,i=this.length;e<i;e++)r=this[e],n.sortedInsert(r,t);return n},sortedInsert:function(t,n){return 0===this.length?this.push(t):this.splice($.sortedIndex(this,t,n),0,t),this},groupBy:function(t){var n,e,r,i,u,o,s,c,a,l,f,h,p,d,g;switch(e={},$.type(t)){case"array":case"bling":for(r=0,s=(h=this).length;r<s;r++)g=h[r],(e[n=function(){var n,e,r;for(r=[],n=0,e=t.length;n<e;n++)u=t[n],r.push(g[u]);return r}().join(",")]||(e[n]=$())).push(g);break;case"string":for(i=0,c=(p=this).length;i<c;i++)(e[l=(g=p[i])[t]]||(e[l]=$())).push(g);break;case"function":for(o=0,a=(d=this).length;o<a;o++)g=d[o],(e[f=t(g)]||(e[f]=$())).push(g)}return $.valuesOf(e)}}}),$.plugin({provides:"StateMachine",depends:"type, logger"},function(){var t,n,e,r;return function(t,n,e){for(;"function"==typeof t;)t=t.call(n,e);return n.state=t},r={"\n":"n","\r":"r","\t":"t","\\":"\\","'":"'",'"':'"'},n=function(t){return t in r&&"\\"+r[t]||t},$.logger("[StateMachine]"),(t=function(t,r=!1){var i,u,o,s,c,a,l,f,h,p;for(p in null,c=r?"\n":"",f=`s=s|0;for(i=i|0;i<=d.length;i++){c=d[i]||'eof';${r?"$.log('state:',s,'i:',i,'c:',c);":""}switch(s){${c}`,t){for(i in"enter"in(h=t[p])?(l=`p=s;${c}`,a=`${c}if(s!==p){${a=e(h.enter,l)};if(s!==p){i--;break}}`):a="",f+=`case ${p}:${a}`+((s=Object.keys(h).length>("enter"in h?1:0))?"switch(c){":"break;\n"),h)u=h[i],"enter"!==i&&(f+="def"===i?"default:":`case '${n(i)}':`,f+=e(u,l)+";break;");f+=s?"}break;":""}f=(f+="}}return this;").replace(/\s+&&\s+/g,"&&").replace(/\s+\|\|\s+/g,"||").replace(/\s+([+*\/=-]*=)\s+/g,"$1");try{return new Function("d","s","i","p","c",f)}catch(t){throw o=t,$.log("Failed to parse compiled machine: ",f),o}}).extractCode=e=function(t,n=""){var e,r;return null==t?"":(0===(r=t.toString().replace(/^\s+/,"").replace(/\r/g,"##R##").replace(/\n/g,"##N##").replace(/\/\*(.*)\*\//g,"").replace(/\/\/(.*)(##N##|##R##)*/g,"")).indexOf("function")?r=r.replace(/function[^{]*{\s*/,n):/\([^{]+ *=>\s*{/.test(r)&&(r=r.replace(/\([^{]+ *{\s*/,n)),null!=(e=r.replace(/return ([^;]+),(\d+)/g,"$1;s=$2").replace(/return /g,"s=").replace(/\s*}$/,"").replace(/([{}\[\],\\\/+*-]*)(##N##|##R##)\s*/g,"$1").replace(/;*(##N##|##R##)\s*/g,";").replace(/##R##/g,"\r").replace(/##N##/g,"\n").replace(/^\s+/,"").replace(/\s+$/,"").replace(/\r|\n/g,""))?e:"")},{$:{StateMachine:t}}}),$.plugin({provides:"string",depends:"type"},function(){var t,n,e,r,i;return n=function(t){return function(...n){try{return t(...n)}catch(t){return`[toString Error: ${t.message}]`}}},t=function(t){return t.replace(/([^\\]{1})'/g,"$1\\'")},r=function(t){return String(t).replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"")},$.type.extend({unknown:{string:n(function(t){var n;return null!=(n="function"==typeof t.toString?t.toString():void 0)?n:String(t)}),repr:n(function(t){return $.type.lookup(t).string(t)}),number:n(function(t){return parseFloat(String(t))})},null:{string:function(){return"null"}},undefined:{string:function(){return"undefined"}},buffer:{string:n(function(t){return String(t)}),repr:n(function(t){return`Buffer(${JSON.stringify(t.toJSON())})`})},string:{number:n(parseFloat),repr:function(n){return`'${t(n)}'`}},array:{string:n(function(t){return`[${t.map($.toString).join(", ")}]`}),repr:n(function(t){return`[${t.map($.toRepr).join(", ")}]`})},arguments:{string:n(function(t){var n;return`[${function(){var e,r,i;for(i=[],e=0,r=t.length;e<r;e++)n=t[e],i.push($.toString(n));return i}().join(", ")}]`}),repr:n(function(t){var n;return`[${function(){var e,r,i;for(i=[],e=0,r=t.length;e<r;e++)n=t[e],i.push($.toRepr(n));return i}().join(", ")}]`})},object:{string:n(function(t){var n,e,r;for(n in e=[],t){try{r=t[n]}catch(t){r=`[Error: ${t.message}]`}e.push(`${n}:${$.toString(r)}`)}return"{"+e.join(", ")+"}"}),repr:n(function(t){var n,e,r;for(n in e=[],t){try{r=t[n]}catch(t){r=`[Error: ${t.message}]`}e.push(`"${n}": ${$.toRepr(r)}`)}return"{"+e.join(", ")+"}"})},function:{repr:function(t){return t.toString()},string:function(t){return t.toString().replace(/^([^{]*){(?:.|\n|\r)*}$/,"$1{ ... }")}},number:{repr:function(t){return String(t)},string:n(function(t){switch(!1){case null==t.precision:return t.toPrecision(t.precision);case null==t.fixed:return t.toFixed(t.fixed);default:return String(t)}})}}),{$:{toString:function(t){if(0===arguments.length)return"function Bling() { [ ... ] }";try{return $.type.lookup(t).string(t)}catch(t){return`[$.toString Error: ${t.message}]`}},toRepr:function(t){return $.type.lookup(t).repr(t)},px:function(t,n=0){return null!=t&&parseInt(t,10)+(0|parseInt(n))+"px"},capitalize:function(t){return t.split(" ").map(function(t){return t[0].toUpperCase()+t.substring(1).toLowerCase()}).join(" ")},slugize:e=function(t,n="-"){var e,r;return(t=function(){switch($.type(t)){case"null":case"undefined":return"";case"object":return function(){var i;for(e in i=[],t)r=t[e],i.push($.slugize(e,n)+n+$.slugize(r,n));return i}().join(n);case"array":case"bling":return t.map(function(t){return $.slugize(t,n)}).join(n);default:return String(t)}}()).toLowerCase().replace(/^\s+/,"").replace(/\s+$/,"").replace(/\t/g," ").replace(/[^A-Za-z0-9. -]/g,"").replace(/\s+/g,"-")},stubize:e,dashize:function(t){var n,e,r,i,u;for(u="",e=r=0,i=0|(null!=t?t.length:void 0);0<=i?r<i:r>i;e=0<=i?++r:--r)91>(n=t.charCodeAt(e))&&n>64&&(n+=32,u+="-"),u+=String.fromCharCode(n);return u},camelize:function(t){var n;for((t=$.slugize(t)).split("-");(n=null!=t?t.indexOf("-"):void 0)>-1;)t=$.stringSplice(t,n,n+2,t[n+1].toUpperCase());return t},commaize:function(t,n=",",e=".",r=""){var i,u,o,s;return $.is("number",t)&&isFinite(t)?(o=String(t),s=t<0?"-":"",[i,u]=o.split("."),i.length>3&&(i=$.stringReverse($.stringReverse(i).match(/\d{1,3}/g).join(n))),s+r+i+(null!=u?e+u:"")):"number"==typeof t&&isNaN(t)||Infinity===t||-Infinity===t?String(t):void 0},padLeft:function(t,n,e=" "){var i;return(i=n-r(t).length)>0?$.zeros(i,e).join("")+t:t},padRight:function(t,n,e=" "){var i;return(i=n-r(t).length)>0?t+$.zeros(i,e).join(""):t},stringTruncate:function(t,n,e="...",r=" "){var i,u;if(t.length<=n)return t;if(e.length>=n)return e;for(t=t.split(r),i=[];n>0&&t.length>0;)(n-=(u=t.shift()).length)>=0&&i.push(u);return i.join(r)+e},stringCount:function(t,n,e=0,r=0){var i;return(i=t.indexOf(n,e))>e-1?$.stringCount(t,n,i+1,r+1):r},stringSplice:function(t,n,e,r){var i,u,o;return u=t.length,(i=e)<0&&(i+=u),(o=n)<0&&(o+=u),t.substring(0,o)+r+t.substring(i)},stringReverse:function(t){return t.split("").reverse().join("")},checksum:function(t){var n,e,r,i,u;for(n=1,e=0,r=i=0,u=t.length;0<=u?i<u:i>u;r=0<=u?++i:--i)e=(e+(n=(n+t.charCodeAt(r))%65521))%65521;return e<<16|n},repeat:function(t,n=2){switch(!1){case 1!==n:return t;case!(n<1):return"";case!$.is("string",t):return $.zeros(n,t).join("");default:return $.zeros(n,t)}},stringBuilder:(i=function(t){return 0|(null!=t?t.toString().length:void 0)},function(){var t;return $.is("global",this)?new $.stringBuilder:(t=[],$.extend(this,{length:0,append:n=>(t.push(n),this.length+=i(n)),prepend:n=>(t.splice(0,0,n),this.length+=i(n)),clear:()=>{var n;return n=this.toString(),t=[],this.length=0,n},toString:function(){return t.join("")}}))})},toString:function(){return $.toString(this)},toRepr:function(){return $.toRepr(this)},replace:function(t,n){return this.map(function(e){return e.replace(t,n)})},indexOf:function(t,n=0){var e,r,i;if($.is("regexp",t)){for(e=r=n,i=this.length;r<i;e=r+=1)if(t.test(this[e]))return e;return-1}return Array.prototype.indexOf.apply(this,arguments)}}}),$.plugin({provides:"symbol",depends:"type"},function(){var t,n,e;return e=null,t={},(n=$.global).Bling=$,"undefined"!=typeof module&&null!==module&&(module.exports=$),$.defineProperty($,"symbol",{set:function(r){return n[e]=t[e],t[e=r]=n[r],n[r]=Bling},get:function(){return e}}),{$:{symbol:"$",noConflict:function(){return $.symbol="Bling",Bling}}}}),$.plugin({provides:"synth",depends:"StateMachine, type, dom"},function(){var t,n,e,r,i;return t={"#":function(){return 2},".":function(){return 3},"[":function(){return 4},'"':function(){return 6},"'":function(){return 7}," ":function(){return this.emitText()},"\t":function(){return this.emitText()},"\n":function(){return this.emitText()},"\r":function(){return this.emitText()},",":function(){return this.emitNodeAndReparent(this.fragment)},"+":function(){var t;return this.emitNodeAndReparent(null!=(t=this.cursor.parentNode)?t:this.fragment)},eof:function(){return this.emitText()}},e={eof:function(){return this.emitError("Unexpected end of input")}},n=$.type.lookup("<html>"),r=function(...t){return $.extend(...t)},i={reset:function(){return this.fragment=this.cursor=document.createDocumentFragment(),this.tag=this.id=this.cls=this.attr=this.val=this.text="",this.attrs={},this},emitError:function(t){throw new Error(`${t}: ${this.input}`)},emitNodeAndReparent:function(t){var n,e,r,i,u,o,s;if((null!=(r=this.tag)?r.length:void 0)>0)for(n in e=document.createElement(this.tag),(null!=(i=this.id)?i.length:void 0)>0&&(e.id=this.id),(null!=(u=this.cls)?u.length:void 0)>0&&(e.className=this.cls),this.cursor.appendChild(e),o=this.attrs)s=o[n],e.setAttribute(n,s);return this.cursor=e&&(t||e)||t||this.cursor,0},emitText:function(){var t;return this.emitNodeAndReparent(),(null!=(t=this.text)?t.length:void 0)&&this.cursor.appendChild(n.node(this.text)||(this.text="")),0},run:$.StateMachine([{enter:function(){return this.tag=this.id=this.cls=this.attr=this.val=this.text="",this.attrs={},1}},r({def:function(t){return this.tag+=t,1}},t),r({def:function(t){return this.id+=t,2}},t),r({def:function(t){return this.cls+=t,3}},t,{enter:function(){return this.cls+=this.cls.length?" ":"",3},".":function(){return this.cls+=" ",3}}),r({def:function(t){return this.attr+=t,4}},e,{"=":function(){return 5},"]":function(){return this.attrs[this.attr]=this.val,this.attr=this.val="",1}}),r({def:function(t){return this.val+=t,5}},e,{"]":function(){return this.attrs[this.attr]=this.val,this.attr=this.val="",1}}),r({def:function(t){return this.text+=t,6}},e,{"\\":function(){return 8},'"':function(){return this.emitText()}}),r({def:function(t){return this.text+=t,7}},e,{"\\":function(){return 9},"'":function(){return this.emitText()}}),r({def:function(t){return this.text+=t,6}},e),r({def:function(t){return this.text+=t,7}},e)])},{$:{synth:function(t){var n;return n=i.reset().run(t,0).fragment,$(1===n.childNodes.length?n.childNodes[0]:n)}}}}),$.plugin({depends:"type, function",provides:"template"},function(){var t,n,e,r,i,u,o;return t=null,n={},r={register_engine:function(e,r){if(n[e]=r,null==t)return t=e},render:function(e,r){if(t in n)return n[t](e,r)}},$.defineProperty(r,"engine",{get:function(){return t},set:function(e){if(!e in n)throw new Error(`invalid template engine: ${e} not one of ${Object.Keys(n)}`);return t=e}}),$.defineProperty(r,"engines",{get:function(){return $.keysOf(n)}}),r.register_engine("null",$.identity),e=function(t,n,e,r,i=-1){var u,o,s,c,a;for(u=1,i<0&&(i=t.length+1+i),o=s=r,c=i;s<c;o=s+=1)if((a=t[o])===e?u+=1:a===n&&(u-=1),0===u)return o;return-1},r.register_engine("pythonic",(o=/([0-9#0+-]*)\.*([0-9#+-]*)([diouxXeEfFgGcrsqm])((?:.|\n)*)/,i=/%[\(\/]/,(u=function(t){var n,r,u,s,c,a,l,f,h,p,d;for(f=(n=t.split(i)).length,d=[n[0]],c=1,u=s=1,h=f;s<h;u=s+=1){if(-1===(r=e(n[u],")","(",0,-1)))return`Template syntax error: unmatched '%(' starting at: ${n[u].substring(0,15)}`;if(a=n[u].substring(0,r),p=n[u].substring(r),null===(l=o.exec(p)))return`Template syntax error: invalid type specifier starting at '${p}'`;p=l[4],d[c++]=a,d[c++]=0|l[1],d[c++]=0|l[2],d[c++]=l[3],d[c++]=p}return d}).cache={},function(t,n){var e,r,i,o,s,c,a,l,f,h,p,d;for(null==(e=u.cache[t])&&(e=u.cache[t]=u(t)),a=[e[0]],s=1,i=o=1,f=e.length-5;o<=f;i=o+=5)[c,l,r,p,h]=e.slice(i,+(i+4)+1||9e9),null==(d=n[c])&&(d=`missing value: ${c}`),a[s++]=function(){switch(p){case"d":return""+parseInt(d,10);case"f":return parseFloat(d).toFixed(r);case"s":default:return""+d}}(),l>0&&(a[s]=$.padLeft(a[s],l)),a[s++]=h;return a.join("")})),{$:{template:r}}}),$.plugin({provides:"throttle",depends:"core"},function(){var t,n;return t=function(t,n,e,r,i){return clearTimeout(i),i=setTimeout(()=>t.apply(n,e),r)},n=function(t,n,e,r,i){var u;return(u=$.now-i)>r&&(i+=u,t.apply(n,e)),i},{$:{throttle:function(t,e){var r;return r=0,function(){return r=n(e,this,arguments,t,r),null}},debounce:function(n,e){var r;return r=null,function(){return arguments,r=t(e,this,arguments,n,r),null}},rate_limit:function(e,r){var i,u;return i=0,u=null,function(){return arguments,u=t(r,this,arguments,e,u),i=n(r,this,arguments,e,i),null}}}}}),$.plugin({provides:"TNET",depends:"type, string, function"},function(){var Types,class_index,classes,makeFunction,packOne,packingStack,register,reverseLookup,unpackOne,unpackingStack;return Types={number:{symbol:"#",pack:String,unpack:Number},string:{symbol:"'",pack:$.identity,unpack:$.identity},bool:{symbol:"!",pack:function(t){return String(!!t)},unpack:function(t){return"true"===t}},null:{symbol:"~",pack:function(){return""},unpack:function(){return null}},undefined:{symbol:"_",pack:function(){return""},unpack:function(){}},array:{symbol:"]",pack:function(t){var n;return function(){var e,r,i;for(i=[],e=0,r=t.length;e<r;e++)n=t[e],i.push(packOne(n));return i}().join("")},unpack:function(t){var n,e;for(n=[],unpackingStack.push(n);t.length>0;)[e,t]=unpackOne(t),n.push(e);return unpackingStack.pop(),n}},map:{symbol:"M",pack:function(t){var n;return n="",t.forEach(function(t,e){return n+=packOne(e)+packOne(t)}),n},unpack:function(t){var n,e,r;for(e=new Map,unpackingStack.push(e);t.length>0;)[n,t]=unpackOne(t),[r,t]=unpackOne(t),e.set(n,r);return unpackingStack.pop(),e}},bling:{symbol:"$",pack:function(t){var n;return function(){var e,r,i;for(i=[],e=0,r=t.length;e<r;e++)n=t[e],i.push(packOne(n));return i}().join("")},unpack:function(t){var n,e;for(n=$(),unpackingStack.push(n);t.length>0;)[e,t]=unpackOne(t),n.push(e);return unpackingStack.pop(),n}},object:{symbol:"}",pack:function(t){var n,e;return function(){var r;for(n in r=[],t)e=t[n],"constructor"!==n&&t.hasOwnProperty(n)&&r.push(packOne(n)+packOne(e));return r}().join("")},unpack:function(t){var n,e,r;for(n={},unpackingStack.push(n);t.length>0;)[e,t]=unpackOne(t),[r,t]=unpackOne(t),n[e]=r;return unpackingStack.pop(),n}},function:{symbol:")",pack:function(t){var n,e,r,i,u,o;return o=t.toString().replace(/(?:\n|\r)+\s*/g," "),r="",(i=/function\s*(\w+)\(.*/g).test(o)&&(r=o.replace(i,"$1")),n=(u=o.replace(/function\s*\w*\(/,"").replace(/\/\*.*\*\//g,"").replace(/}$/,"").split(/\) {/))[0].split(/, */),e=u.slice(1).join(") {").replace(/^\s+/,"").replace(/\s*$/,""),$(r,n,e).map(packOne).join("")},unpack:function(t){var n,e,r,i;[r,i]=unpackOne(t),[n,i]=unpackOne(i),[e,i]=unpackOne(i);try{return makeFunction(r,n.join(),e)}catch(t){return t,$.log("Failed to makeFunction."),$.log("Arguments:",n.join()),$.log("Body:",e)}}},regexp:{symbol:"/",pack:function(t){return String(t).slice(1,-1)},unpack:function(t){return RegExp(t)}},class:{symbol:"{",pack:function(t){return[Types.function.pack(t),packOne(t.prototype,"object")].join("")},unpack:function(s){var f,rest;return[s,rest]=unpackOne(s),f=eval(s),[f.prototype,rest]=unpackOne(rest),f}},"class instance":{symbol:"C",pack:function(t){var n;if(!("constructor"in t))throw new Error("TNET: cant pack non-class as class");if(!(t.constructor in class_index))throw new Error(`TNET: cant pack unregistered class (name: ${t.constructor.name})`);return n=packOne(class_index[t.constructor]),packingStack.pop(),n+packOne(t,"object")},unpack:function(t){var n,e,r;if([n,r]=unpackOne(t),[e,r]=unpackOne(r),!(n<=classes.length))throw unpackingStack.splice(0,unpackingStack.length),new Error(`TNET: attempt to unpack unregistered class index: ${n}`);return e.__proto__=classes[n-1].prototype,e}},"circular reference":{symbol:"@",pack:function(t){return String(t)},unpack:function(t){return unpackingStack[parseInt(t,10)]}}},makeFunction=function(name,args,body){return eval(`var f = function ${name}(${args}){${body}}`),f},classes=[],class_index={},register=function(t){return class_index[t]||(class_index[t]=classes.push(t))},reverseLookup={},function(){var t,n,e;for(n in t=[],Types)e=Types[n],t.push(reverseLookup[e.symbol]=e)}(),unpackingStack=[],unpackOne=function(t){var n,e,r,i,u;return t&&(e=t.indexOf(":"))>0&&(n=parseInt(t.slice(0,e),10),isFinite(n)&&$.is("number",n)&&e<(r=u=e+1+n)&&r<t.length&&(i=reverseLookup[t[u]]))?[i.unpack(t.slice(e+1,u)),t.slice(u+1)]:[void 0,t]},packingStack=[],packOne=function(t,n){var e,r,i,u,o,s,c,a;if("unknown"===(a=null!=n?n:$.type(t))&&void 0!==(u=null!=(o=t.constructor)?o.name:void 0)&&"Object"!==u&&(a="class instance"),null==(c=Types[a]))throw packingStack.splice(0,packingStack.length),new Error(`TNET: I don't know how to pack type '${a}' (${null!=(s=t.constructor)?s.name:void 0})`);(i=packingStack.indexOf(t))>-1&&(c=Types["circular reference"],t=i),packingStack.push(t);try{e=c.pack(t)}catch(t){throw r=t,packingStack.splice(0,packingStack.length),r}return packingStack.pop(),e.length+":"+e+c.symbol},{$:{TNET:{Types:Types,registerClass:register,stringify:packOne,parse:function(t){var n;return null!=(n=Bling.TNET.parseOne(t))?n[0]:void 0},parseOne:function(t){return Buffer.isBuffer(t)&&(t=t.toString()),unpackOne(t)}}}}}),$.plugin({provides:"trace",depends:"function,type,logger"},function(){return $.type.extend({unknown:{trace:$.identity},object:{trace:function(t,n,e){var r;return function(){var i,u,o,s;for(s=[],i=0,u=(o=Object.keys(n)).length;i<u;i++)r=o[i],s.push(n[r]=$.trace(n[r],`${t}.${r}`,e))}(),n}},array:{trace:function(t,n,e){var r;return function(){var i,u,o;for(o=[],r=i=0,u=n.length;i<u;r=i+=1)o.push(n[r]=$.trace(n[r],`${t}[${r}]`,e))}(),n}},bling:{trace:function(t,n,e){var r;return function(){var i,u,o;for(o=[],r=i=0,u=n.length;i<u;r=i+=1)o.push(n[r]=$.trace(n[r],`${t}[${r}]`,e))}(),n}},function:{trace:function(t,n,e){var r;return t||(t=n.name),(r=function(...r){var i,u,o;return o=+new Date,n.apply(this,r),t=`${this.name||$.type(this)}.${t}`,i=$(r).map($.toRepr).join(","),u=(+new Date-o).toFixed(0),e(`${t}(${i}): ${u}ms`)}).toString=function(){return`{Trace '${t}' of ${n.toString()}`},r}}}),{$:{time:function(t,n,e){var r,i;return $.is("string",t)||([n,e,t]=[t,n,"trace"]),$.is("function",e)||(e=$.log),i=+new Date,r=n(),e(`[${t}] ${(+new Date-i).toFixed(0)}ms`),r},trace:function(t,n,e){return $.is("string",t)||([e,n]=[n,t]),e||(e=$.log),t||(t=""),$.type.lookup(n).trace(t,n,e)}}}}),$.plugin({depends:"dom"},function(){var t,n,e,r,i,u,o;return", ",n={slow:700,medium:500,normal:300,fast:100,instant:0,now:0},t=/(?:scale(?:3d)*|translate(?:[XYZ]|3d)*|rotate(?:[XYZ]|3d)*)/,30,e=document.createElement("div").style,r="transform",u="transition-property",i="transition-duration",o="transition-timing-function","WebkitTransform"in e?(r="-webkit-transform",u="-webkit-transition-property",i="-webkit-transition-duration",o="-webkit-transition-timing-function"):"MozTransform"in e?(r="-moz-transform",u="-moz-transition-property",i="-moz-transition-duration",o="-moz-transition-timing-function"):"OTransform"in e&&(r="-o-transform",u="-o-transition-property",i="-o-transition-duration",o="-o-transition-timing-function"),{$:{duration:function(t){var e;return null!=(e=n[t])?e:parseFloat(t)}},transform:function(n,e,s,c){var a,l,f,h,p,d;for(f in $.is("function",e)?(c=e,e=s=null):$.is("function",s)&&(c=s,s=null),null==e&&(e="normal"),s||(s="ease"),l=$.duration(e)+"ms",p=[],d="",a={},n)t.test(f)?((h=n[f]).join?h=$(h).px().join(", "):h.toString&&(h=h.toString()),d+=" "+f+"("+h+")"):a[f]=n[f];for(f in a)p.push(f);if(d&&p.push(r),a[u]=p.join(", "),a[i]=p.map(function(){return l}).join(", "),a[o]=p.map(function(){return s}).join(", "),d&&(a[r]=d),this.css(a),c)return this.delay(l,$.bound(this,c))},hide:function(t){return this.each(function(){if(this.style)return this._display="",!1===this.style.display&&(this._display=this.syle.display),this.style.display="none"}).trigger("hide"),t&&this.delay(30,$.bound(this,t)),this},show:function(t){return this.each(function(){if(this.style)return this.style.display=this._display,delete this._display}).trigger("show"),t&&this.delay(30,$.bound(this,t)),this},toggle:function(t){return this.weave(this.css("display")).fold(function(t,n){return"none"===t?(n.style.display=n._display||"",delete n._display,$(n).trigger("show")):(n._display=t,n.style.display="none",$(n).trigger("hide")),n}).delay(30,$.bound(this,t))},fadeIn:function(t,n){return this.css("opacity","0.0").show(function(){return this.transform({opacity:"1.0",translate3d:[0,0,0]},t,n)})},fadeOut:function(t,n,e=0,r=0){return this.transform({opacity:"0.0",translate3d:[e,r,0]},t,function(){return this.hide($.bound(this,n))})},fadeLeft:function(t,n){return this.fadeOut(t,n,"-"+this.width().first(),0)},fadeRight:function(t,n){return this.fadeOut(t,n,this.width().first(),0)},fadeUp:function(t,n){return this.fadeOut(t,n,0,"-"+this.height().first())},fadeDown:function(t,n){return this.fadeOut(t,n,0,this.height().first())}}}),$.plugin({provides:"Trie"},function(){return{$:{Trie:function(){var t,n;class e{constructor(){this.length=0}insert(t,e=String(t)){return n(this,t,e.toLowerCase(),0)}find(n){return t(this,n.toLowerCase(),0)}}return n=function(t,r,i,u){var o,s;return t.length++,u<i.length?(s=t.children||(t.children={}),n(s[o=i[u]]||(s[o]=new e),r,i,u+1)):(t.values||(t.values=[])).push(r),t},t=function*(n,e,r){var i,u,o,s,c,a,l;if((o=r>=e.length)&&n.values)for(s=0,c=(a=n.values).length;s<c&&!1!==(yield a[s]);s++);else for(i in l=n.children)u=l[i],(o||i===e[r])&&(yield*t(u,e,r+1));return null},e}.call(this)}}}),$.plugin({provides:"type,is,inherit,extend,defineProperty,isType,are,as,isSimple,isDefined,isEmpty",depends:"compat"},function(){var t,n,e,r,i,u,o,s,c,a,l,f;return t=Object.prototype.toString,r=function(n,e){return null==e?n===e||"null"===n||"undefined"===n:null!=e.constructor&&(e.constructor===n||e.constructor.name===n)||t.apply(e)===`[object ${n}]`||r(n,e.__proto__)},e=function(t,...n){var r,i;if(n.length>0)return r=n.shift(),"function"==typeof t&&(t=t.prototype),(i=t.__proto__)!==Object.prototype&&null!==i&&void 0!==i||(t.__proto__=r.__proto__),r.__proto__=t,n.length>0?e(r,...n):r},c={},l=[],u={},o=function(t,n){var e;if(-1===(e=u[t]||(u[t]=[])).indexOf(n))return e.push(n)},f=function(t,n){var r;if(n.is||(n.is=function(){return!1}),t in c)return i(t,n);for(r in t in c||l.unshift(t),c[n.name=t]=s!==n?e(s,n):n,c[t][t]=function(t){return t},c[t])o(r,c[t]);return c[t]},i=function(t,n){var e,r;if("string"==typeof t)for(r in c[t]||(c[t]=f(t,{})),c[t]=extend(c[t],n),n)o(r,c[t]);else if("object"==typeof t)for(e in t)i(e,t[e]);return null},a=function(t){var n,e,r;for(n=0,e=l.length;n<e;n++)if(r=l[n],c[r].is.call(t,t))return c[r];return null},f("unknown",s={name:"unknown",is:function(){return!0}}),f("object",{is:function(t){var n,e;return null!=t&&"object"==typeof t&&(void 0===(n=null!=(e=t.constructor)?e.name:void 0)||"Object"===n)}}),f("array",{is:Array.isArray||function(t){return r(Array,t)}}),f("map",{is:function(t){return t&&t instanceof Map}}),f("buffer",{is:$.global.Buffer.isBuffer||function(){return!1}}),f("error",{is:function(t){return r("Error",t)}}),f("regexp",{is:function(t){return r("RegExp",t)}}),f("string",{is:function(t){return"string"==typeof t}}),f("number",{is:function(t){return"number"==typeof t&&!isNaN(t)}}),f("bool",{is:function(t){return"boolean"==typeof t}}),f("function",{is:function(t){return"function"==typeof t}}),f("class",{is:function(t){var n;return"function"==typeof t&&"prototype"in(n=Object.getOwnPropertyDescriptors(t))&&!("arguments"in n)}}),f("global",{is:function(t){return"object"==typeof t&&"setInterval"in t}}),f("arguments",{is:function(t){return"object"==typeof t&&"callee"in t&&"length"in t}}),f("undefined",{is:function(t){return void 0===t}}),f("null",{is:function(t){return null===t}}),(n=extend(function(t){return a(t).name},{register:f,lookup:a,extend:i,get:function(t){return c[t]},is:function(t,n){var e,r;return null!=(e=null!=(r=c[t])?r.is.call(n,n):void 0)&&e},as:function(t,n,...e){var r;return"function"==typeof(r=a(n))[t]?r[t](n,...e):void 0},with:function(t){var n;return null!=(n=u[t])?n:[]}})).extend({unknown:{array:function(t){return[t]}},null:{array:function(){return[]}},undefined:{array:function(){return[]}},array:{array:function(t){return t}},number:{array:function(t){return $.extend(new Array(t),{length:0})}},arguments:{array:function(t){return Array.prototype.slice.apply(t)}}}),4294967295,n.register("bling",{is:function(t){return t&&r($,t)},array:function(t){return t&&t.toArray()||[]},hash:function(t){return t.map($.hash).reduce(function(t,n){return(t*t+n)%4294967295})},string:function(t){return $.symbol+"(["+t.map(function(t){return $.type.lookup(t).string(t)}).join(", ")+"])"},repr:function(t){return $.symbol+"(["+t.map(function(t){return $.type.lookup(t).repr(t)}).join(", ")+"])"}}),n.in=function(...t){var n,e,r,i,u;for(i=t,[...t]=i,[r]=splice.call(t,-1),n=0,e=t.length;n<e;n++)if(u=t[n],$.is(u,r))return!0;return!1},{$:{inherit:e,extend:extend,defineProperty:function(t,n,e){return Object.defineProperty(t,n,extend({configurable:!0,enumerable:!0},e)),t},isType:r,type:n,is:n.is,are:function(t,...n){var e,r,i;for(r=0,i=n.length;r<i;r++)if(e=n[r],!$.is(t,e))return!1;return!0},as:n.as,isDefined:function(t){return null!=t},isSimple:function(t){return n.in("string","number","bool",t)},isEmpty:function(t){return""===t||null===t||void 0===t||0===t.length||"object"==typeof t&&0===Object.keys(t).length}},defineProperty:function(t,n){return this.each(function(){return $.defineProperty(this,t,n)})}}}),$.plugin({depends:"math",provides:"units"},function(){var t,n,e,r,i,u,o,s,c;return c=$(["px","pt","pc","em","%","in","cm","mm","ex","lb","kg","yd","ft","m",""]),t=null,(u=function(){var n;return n=c.filter(/.+/).join("|"),t=new RegExp(`(\\d+\\.*\\d*)((?:${n})/*(?:${n})*)$`)})(),o=function(n){return t.test(n)?t.exec(n)[2]:""},i=function(t){return function(){return t}},r=function(){},{$:{units:{enable:function(){return $.type.register("units",{is:function(n){return"string"==typeof n&&t.test(n)},number:function(t){return parseFloat(t)},string:function(t){return`'${t}'`}}),s("pc","pt",function(){return 12}),s("in","pt",function(){return 72}),s("in","px",function(){return 96}),s("in","cm",function(){return 2.54}),s("m","ft",function(){return 3.281}),s("yd","ft",function(){return 3}),s("cm","mm",function(){return 10}),s("m","cm",function(){return 100}),s("m","meter",function(){return 1}),s("m","meters",function(){return 1}),s("ft","feet",function(){return 1}),s("km","m",function(){return 1e3}),s("em","px",function(){var t,n;t=0;try{t=(n=$("<span style='font-size:1em;visibility:hidden'>x</span>").appendTo("body")).width().first(),n.remove()}catch(t){}return t}),s("ex","px",function(){var t,n;t=0;try{t=(n=$("<span style='font-size:1ex;visibility:hidden'>x</span>").appendTo("body")).width().first(),n.remove()}catch(t){}return t}),s("ex","em",function(){return 2}),s("rad","deg",function(){return 57.3}),s("s","sec",function(){return 1}),s("s","ms",function(){return 1e3}),s("ms","ns",function(){return 1e6}),s("min","sec",function(){return 60}),s("hr","min",function(){return 60}),s("hr","hour",function(){return 1}),s("hr","hours",function(){return 1}),s("day","hr",function(){return 24}),s("day","days",function(){return 1}),s("y","year",function(){return 1}),s("y","years",function(){return 1}),s("y","d",function(){return 365.25}),s("g","gram",function(){return 1}),s("g","grams",function(){return 1}),s("kg","g",function(){return 1e3}),s("lb","g",function(){return 453.6}),s("lb","oz",function(){return 16}),s("f","frame",function(){return 1}),s("f","frames",function(){return 1}),s("sec","f",function(){return 60}),(r=function(){var t,e,r,u,o,s,a,l,f,h,p,d,g;for(n[""]={},g=i(1),u=0,f=c.length;u<f;u++)t=c[u],n[t]||(n[t]={}),n[t][t]=n[t][""]=n[""][t]=g;for(o=1;o>0;)for(o=0,s=0,h=c.length;s<h;s++)if(""!==(t=c[s]))for(n[t]||(n[t]={}),a=0,p=c.length;a<p;a++)if(""!==(e=c[a]))for(!n(t,e)&&n(e,t)&&(n[t][e]=i(1/n(e,t)),o+=1),l=0,d=c.length;l<d;l++)""!==(r=c[l])&&n(t,e)&&n(e,r)&&!n(t,r)&&(n[t][r]=i(n(t,e)*n(e,r)),o+=1);return null})(),$.units.enable=function(){}},set:s=function(t,e,i){return n[t]||(n[t]={}),n[t][e]=i,-1===c.indexOf(t)&&c.push(t),-1===c.indexOf(e)&&c.push(e),u(),r()},get:n=function(t,e){var r,i,u,o;return[u,r]=t.split("/"),[o,i]=e.split("/"),null!=r&&null!=i?n(i,r)*n(u,o):t in n&&e in n[t]?n[t][e]():0},convertTo:e=function(t,e){var r,i,u;return i=parseFloat(e),u=o(e),r=n(u,t),isFinite(r)&&isFinite(i)?`${i*r}${t}`:e}}},convertTo:function(t){return this.map(function(n){return e(t,n)})},unitMap:function(t){return this.map(function(n){var e;return t.call(e=parseFloat(n),e)+o(n)})}}}),$.plugin({depends:"type",provides:"url,URL"},function(){var t,n,e,r,i,u;return r=/\b(?:([a-z+]+):)(?:\/{1,2}([^?\/#]*?))(\/[^?]*)*(?:\?([^#]+))*(?:#([^\s]+))*$/i,i=/^([^:]+):([^@]+)@/,u=/^([^:@]+)@/,n=/^([^:]+):(\d+)/,e=function(t){var r,o;return null!=t&&t.length>0?((o={host:t}).host.indexOf(",")>-1?$.extend(o,{hosts:o.host.split(",").map(e),host:void 0}):((r=o.host.match(i))?$.extend(o,{username:r[1],password:r[2],host:o.host.replace(i,"")}):(r=o.host.match(u))&&$.extend(o,{username:r[1],host:o.host.replace(u,"")}),(r=o.host.match(n))&&$.extend(o,{host:r[1],port:r[2]})),o):{}},t=function(t,n,e="",r=""){var i;return(i=null!=t?t:"")&&!n.test(i)?e+i+r:i},{$:{URL:{parse:function(t,n=!1){var i,u,o,s,c,a,l,f,h,p,d;if(null!=(d=(s=null!=t?t.match(r):void 0)?{protocol:s[1],host:s[2],path:s[3],query:null!=(l=s[4])?l.replace(/^\?/,""):void 0,hash:null!=(f=s[5])?f.replace(/^#/,""):void 0}:null)){if(n){for(a=null!=(h=d.query)?h:"",d.query=Object.create(null),u=0,o=(p=a.split("&")).length;u<o;u++)(i=(c=p[u]).indexOf("="))>-1?d.query[c.substring(0,i)]=unescape(c.substring(i+1)):c.length>0&&(d.query[c]=null);delete d.query[""]}$.extend(d,e(d.host)),$.keysOf(d).each(function(t){switch($.type(d[t])){case"null":case"undefined":delete d[t];break;case"string":0===d[t].length&&delete d[t]}return null})}return d},stringify:function(n){var e,r;return $.is("object",n.query)&&(n.query=function(){var t,i;for(e in i=[],t=n.query)r=t[e],i.push(`${e}=${r}`);return i}().join("&")),[t(n.protocol,/:$/,"",":"),t(n.host,/^\//,"//"),t(n.port,/^:/,":"),t(n.path,/^\//,"/"),t(n.query,/^\?/,"?"),t(n.hash,/^#/,"#")].join("")}}}}}),$.plugin({provides:"watchProperty",depends:"type"},function(){var t,n;return"change","insert","delete",n=function(e,r,i,u=""){var o,s,c,a,l;return"string"==typeof r&&(c=r.indexOf("."))>-1?(o=r.substr(0,c),n(e[o],r.substr(c+1),i,(null!=u?u.length:void 0)&&u+"."+o||o)):($.is("array",e[r])&&t(e[r],i,(null!=u?u.length:void 0)&&u+"."+r||r),a=Object.getOwnPropertyDescriptor(e,r),$.defineProperty(e,r,{get:s=null!=(l=a.get)?l:function(){return a.value},set:$.compose($.partial(i,"change",(null!=u?u.length:void 0)&&u+"."+r||r),a.set||a.writable&&function(t){return a.value=t}||s)}))},t=function(t,e,r=""){var i,u,o;return u=function(t,n,i){return e(t,(null!=r?r.length:void 0)&&r+"."+n||n,i)},i=function(n,e){var r;return r=t[n],t[n]=function(...n){try{return r.apply(t,n)}finally{e.apply(t,n)}}},(o=function(){var e,r,i;for(e=r=0,i=t.length;r<i;e=r+=1)n(t,e,u);return null})(),i("push",function(t){var e;return e=this.length-1,n(this,e,u),u("insert",e,t)}),i("unshift",function(t){return o(),u("insert",0,t)}),i("pop",function(){return u("delete",this.length,1)}),i("shift",function(){return o(),u("delete",this.length,1)}),i("splice",function(t,n,e){if(void 0!==e?(t+=1,n-=1):n>0&&(t=this.length),n>0)return u("delete",t,n)}),t},{$:{watchProperty:n}}})}).call(this);