(function(){var $,Bling,extend,slice=[].slice,hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(n){for(var t=0,e=this.length;t<e;t++)if(t in this&&this[t]===n)return t;return-1},extend1=function(n,t){function e(){this.constructor=n}for(var r in t)hasProp.call(t,r)&&(n[r]=t[r]);return e.prototype=t.prototype,n.prototype=new e,n.__super__=t.prototype,n};Object.keys||(Object.keys=function(n){return function(n){var t,e;e=[];for(t in n)e.push(t);return e}}()),Object.values||(Object.values=function(n){return function(n){var t,e;e=[];for(t in n)e.push(n[t]);return e}}()),extend=function(n){return function(){var n,t,e,r,i,u,o;for(n=arguments[0],e=0,i=(t=2<=arguments.length?slice.call(arguments,1):[]).length;e<i;e++)if(u=t[e])for(r in u)o=u[r],n[r]=o;return n}}(),Bling=function(){var n,t,e;if(1===(n=1<=arguments.length?slice.call(arguments,0):[]).length&&(n=$.type.lookup(n[0]).array(n[0])),t=$.inherit(Bling,n),0===n.length&&void 0!==n[0]){for(e=0;void 0!==n[e];)e++;t.length=e}return"init"in Bling?Bling.init(t):t},$=Bling,$.global=function(){return this}(),$.plugin=function(n,t){var e,r,i,u,o,s,c;if(t||(t=n,n={}),e=this,"depends"in n)return e.depends(n.depends,function(){return e.plugin({provides:n.provides},t)});try{if("object"==typeof(o=null!=t?t.call(e,e):void 0)){extend(this,o.$),delete o.$,extend(e.prototype,o),i=function(n){return e[n]||(e[n]=function(){var t;return t=1<=arguments.length?slice.call(arguments,0):[],e.prototype[n].apply($(t[0]),t.slice(1))})};for(u in o)i(u);null!=n.provides&&e.provide(n.provides)}}catch(n){r=n,console.error("plugin failed '"+e.name+"':",(null!=(s=null!=(c=$.debugStack)?c:$.identity)?s:function(n){return n})(r.stack))}return this},extend($,function(){var n,t,e,r,i;return i=[],t={},n=/, */,r=function(n){return!(n in t)},e=function(t){return("string"==typeof t?t.split(n):t).filter(r)},{depends:function(n,t){return 0===(n=e(n)).length?t():i.push(function(e){var r;return(r=n.indexOf(e))>-1&&n.splice(r,1),0===n.length&&t}),t},provide:function(n,r){var u,o,s,c,a,l,f,h,p,d;for(u=[],a=0,l=(h=e(n)).length;a<l;a++)for(f=h[a],t[f]=c=-1;++c<i.length;)if(s=i[c](f)){i.splice(c,1);try{s(r)}catch(n){o=n,u.push(o)}c=-1}return u.length>0&&(s=null!=(p=null!=(d=$.debugStack)?d:$.identity)?p:function(n){return n.stack},u.map(s).forEach(console.error.bind(console))),r}}}()),$.plugin({depends:"core",provides:"async,series,parallel"},function(){return{series:function(n){var t,e,r,i,u;return null==n&&(n=$.identity),i=$(),u=this.length,u>0?(t=0,e=function(e){return function(){return i[e]=arguments,++t>=u?n.apply(i,i):r(t),null}},(r=function(n){return function(t){return $.immediate(function(){return n[t](e(t))})}}(this))(0)):n.apply(i,i),this},parallel:function(n){var t,e,r,i,u,o,s;if(null==n&&(n=$.identity),o=$(),(s=this.length)>0)for(t=0,e=function(e){return function(){return o[e]=arguments,++t>=s&&n.apply(o,o),null}},r=i=0,u=s;i<u;r=i+=1)this[r](e(r));else n.apply(o,o);return this}}}),$.plugin({provides:"cache, Cache",depends:"core, sortBy, logger"},function(){var n;return n=function(){function n(n,t){var e,r,i,u,o,s,c;this.capacity=null!=n?n:1e3,this.defaultTtl=null!=t?t:Infinity,this.capacity=Math.max(0,this.capacity),this.evictCount=Math.max(3,Math.floor(.1*this.capacity)),i=Object.create(null),o=[],r=function(n){return-n.r/n.w},e=function(n){return function(){if(n.capacity>0){if(o.length>=n.capacity)for(;o.length+n.evictCount-1>=n.capacity;)delete i[o.pop().k];return null}}}(this),s=function(n,t){var e,r,u,s;for(s=e=r=n,u=t;r<=u?e<=u:e>=u;s=r<=u?++e:--e)0<=s&&s<o.length&&(i[o[s].k]=s);return null},c=function(n){var t,e;return e=o[n],(t=$.sortedIndex(o,e,r))!==n&&(o.splice(n,1),o.splice(t,0,e),s(n,t)),null},u={v:void 0},$.extend(this,{has:function(n){return n in i},del:function(n){var t;if(n in i)return t=i[n],o.splice(t,1),delete i[n],s(t,o.length-1)},set:function(n){return function(t,u,a){var l,f,h;return null==a&&(a=n.defaultTtl),n.capacity>0?(t in i?((l=o[f=i[t]]).v=u,l.w+=1,c(f)):(e(),h={k:t,v:u,r:0,w:1},f=$.sortedIndex(o,h,r),o.splice(f,0,h),s(f,o.length-1)),a<Infinity&&$.delay(a,function(){return n.del(t)}),u):u}}(this),get:function(n){var t,e;return e=u,n in i&&(t=i[n],(e=o[t]).r+=1,c(t)),e.v},clear:function(){var n;for(n in i)o[i[n]]=null;return i=Object.create(null),o=[]}})}return $.logger("[LRU]"),n}(),{$:{Cache:$.extend(n,new n(1e4))}}}),$.plugin({provides:"cartesian"},function(){return{$:{cartesian:function(){var n,t,e,r;return r=1<=arguments.length?slice.call(arguments,0):[],t=r.length,e=[],(n=function(i,u){var o,s,c,a;if(++u>=t)return e.push(i);for(o=0,s=(c=r[u]).length;o<s;o++)a=c[o],n(i.concat(a),u);return null})([],-1),$(e)}}}}),$.plugin({provides:"clone",depends:"type"},function(){return $.type.extend({unknown:{clone:function(n){return null}},string:{clone:function(n){return n+""}},number:{clone:function(n){return n+0}},array:{clone:function(n){return n.concat([])}},bling:{clone:function(n){return n.concat([])}},object:{clone:function(n){var t,e,r;e=Object.create(n.__proto__);for(t in n)hasProp.call(n,t)&&(r=n[t],e[t]=$.type.lookup(r).clone(r));return e}}}),{$:{clone:function(n){return $.type.lookup(n).clone(n)}}}}),$.plugin({provides:"compat,trimLeft,split,lastIndexOf,join,preventAll,matchesSelector,isBuffer,Map"},function(){var n,t,e,r,i,u,o;return(n=$.global).Buffer||(n.Buffer={isBuffer:function(){return!1}}),(t=$.global).Map||(t.Map=function(){function n(n){var t,e,r,i,u;t=Object.create(null),$.extend(this,{size:0,keys:function(){return Object.keys(t)},values:function(){var n,e,r;e=[];for(n in t)r=t[n],e.push(r);return e},entries:function(){var n,e,r;e=[];for(n in t)r=t[n],e.push([n,r]);return e},has:function(n){return n in t},get:function(n){return t[n]},set:function(n,e){return n in t||(this.size+=1),t[n]=e,this},delete:function(n){return n in t&&(this.size-=1),delete t[n],this},clear:function(){return t=Object.create(null),this.size=0,this},forEach:function(n,e){var r,i;for(r in t)i=t[r],n.call(e,r,i);return this}});for(e=0,i=(u=null!=n?n:[]).length;e<i;e++)r=u[e],this.set.apply(this,r)}return n}()),o=[-1,1],Math.sign=function(n){return o[0+(n>=0)]},(e=String.prototype).trimLeft||(e.trimLeft=function(){return this.replace(/^\s+/,"")}),(r=String.prototype).split||(r.split=function(n){var t,e,r;for(t=[],e=0;(r=this.indexOf(n,e))>-1;)t.push(this.substring(e,r)),e=r+1;return t}),(i=String.prototype).lastIndexOf||(i.lastIndexOf=function(n,t,e){var r;for(null==e&&(e=-1),r=-1;(e=n.indexOf(t,e+1))>-1;)r=e;return r}),(u=Array.prototype).join||(u.join=function(n){var t,e;if(null==n&&(n=""),0===(t=this.length))return"";for(e=this[t-1];--t>0;)e=this[t-1]+n+e;return e}),"undefined"!=typeof Event&&null!==Event&&(Event.prototype.preventAll=function(){return this.preventDefault(),this.stopPropagation(),this.cancelBubble=!0}),"undefined"!=typeof Element&&null!==Element&&(Element.prototype.matchesSelector=Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.matchesSelector),{}}),$.plugin({provides:"compress, decompress"},function(){var n,t,e,r,i;return r=String.fromCharCode,e=function(n){return r(n+32)},i=Math.pow,n=function(n){var t,r,u,o,s,c,a,l,f,h,p,d,g,v,y,m;if(null===n||void 0===n||""===n)return n;for(s={},a={},t="",m="",y="",h=2,c=3,g=2,r=[],o=0,u=0,f=function(n,t){var i,s;for(null==t&&(t=0),i=0,s=g;i<s;i+=1)o=o<<1|t,14===u?(u=0,r.push(e(o)),o=0):u++,t=0;return t=y.charCodeAt(0),l(n,t)},l=function(n,t){var i,s,c;for(null==t&&(t=0),c=[],i=0,s=n;i<s;i+=1)o=o<<1|1&t,14===u?(u=0,r.push(e(o)),o=0):u++,c.push(t>>=1);return c},p=0,d=n.length;p<d;p++)(t=n[p])in s||(s[t]=c++,a[t]=!0),(m=y+t)in s?y=m:(y in a?(y.charCodeAt(0)<256?f(8):f(16,1),0===--h&&(h=i(2,g),g++),delete a[y]):(v=s[y],l(g,v)),0===--h&&(h=i(2,g),g++),s[m]=c++,y=String(t));""!==y&&(y in a?(y.charCodeAt(0)<256?f(8):f(16,1),0===--h&&(h=i(2,g),g++),delete a[y]):(v=s[y],l(g,v)),0===--h&&(h=i(2,g),g++)),l(g,2);for(;;){if(o<<=1,14===u){r.push(e(o));break}u++}return r.join("")},t=function(n,t,e){var u,o,s,c,a,l,f,h,p,d,g,v;if(0===n)return"";if(c=[],f=4,a=4,p=3,h="",g=[],v=d=o=null,s={val:e(0),position:t,index:1},isNaN(s.val)||!isFinite(s.val)||null==s.val)return"";switch(c[0]=0,c[1]=1,c[2]=2,l=function(n,r,i){for(null==i&&(i=1);i!==r;)d=s.val&s.position,s.position>>=1,0===s.position&&(s.position=t,s.val=e(s.index++)),n|=(d>0?1:0)*i,i<<=1;return n},u=l(0,4,1),u){case 0:case 1:o=r(l(0,i(2,8*(o+1)),1));break;case 2:return""}for(c[3]=o,v=o,g.push(o);;){if(s.index>n)return"";switch(o=l(0,i(2,p),1)){case 0:case 1:c[a++]=r(l(0,i(2,8*(o+1)),1)),o=a-1,f--;break;case 2:return g.join("")}if(0===f&&(f=i(2,p),p++),c[o])h=c[o];else{if(o!==a)return"";h=v+v.charAt(0)}g.push(h),c[a++]=v+h.charAt(0),v=h,0===--f&&(f=i(2,p),p++)}},{$:{compress:function(t){return t?n(t)+" ":""},decompress:function(n){return n?t(n.length,16384,function(t){return n.charCodeAt(t)-32}):""}}}}),$.plugin({provides:"config",depends:"core"},function(){var n,t,e,r,i,u;return t=function(n,t){var e;switch(arguments.length){case 0:return $.extend({},process.env);default:return null!=(e=process.env[n])?e:t}},i=function(n,t){switch(arguments.length){case 1:return $.extend(process.env,n);case 2:return process.env[n]=t}},r=function(n){var t;return t={},$(n.toString("utf8").split("\n")).filter($.isEmpty,!1).filter(/^#/,!1).map(function(){return this.replace(/^\s+/,"").split("=")}).each(function(n){var e;if(null!=(e=n[0])?e.length:void 0)return t[n[0]]=n[1].replace(/^["']/,"").replace(/['"]$/,"")}),t},u=function(n,t){var e;return e=process.env[n],$.interval(1003,function(){var r;if((r=process.env[n])!==e)return t(e,r),e=r})},e=function(n,t){var e;return parseInt(null!=(e=process.env[n])?e:t,10)},n=function(n,t){var e;return parseFloat(null!=(e=process.env[n])?e:t)},{$:{config:$.extend(t,{get:t,set:i,parse:r,watch:u,int:e,float:n})}}}),$.plugin({provides:"core,eq,each,map,filterMap,tap,replaceWith,reduce,union,intersect,distinct,contains,count,coalesce,swap,shuffle,select,or,zap,clean,take,skip,first,last,slice,push,filter,matches,weave,fold,flatten,call,apply,log,toArray,clear,indexWhere",depends:"string,type"},function(){var n;return $.defineProperty($,"now",{get:function(){return+new Date}}),n=function(n,t){for(;n<0;)n+=t.length;return Math.min(n,t.length)},{$:{assert:function(n,t){if(null==t&&(t=""),!n)throw new Error("assertion failed: "+t)},coalesce:function(){var n;return n=1<=arguments.length?slice.call(arguments,0):[],$(n).coalesce()},keysOf:function(n,t){var e;return null==t&&(t=!1),$(t?function(){var t;t=[];for(e in n)hasProp.call(n,e)&&t.push(e);return t}():function(){var t;t=[];for(e in n)t.push(e);return t}())},valuesOf:function(n,t){var e,r;return null==t&&(t=!1),$(t?function(){var t;t=[];for(e in n)hasProp.call(n,e)&&(r=n[e],t.push(r));return t}():function(){var t;t=[];for(e in n)r=n[e],t.push(r);return t}())}},eq:function(t){return $([this[n(t,this)]])},each:function(n){var t,e,r,i;for(t=0,e=(r=this).length;t<e;t++)i=r[t],n.call(i,i);return this},map:function(n){var t,e,r,i,u,o;for(t=$(),e=0,r=0,i=(u=this).length;r<i;r++)o=u[r],t[e++]=n.call(o,o);return t},every:function(n){var t,e,r,i;for(t=0,e=(r=this).length;t<e;t++)if(i=r[t],!n.call(i,i))return!1;return!0},some:function(n){var t,e,r,i;for(t=0,e=(r=this).length;t<e;t++)if(i=r[t],n.call(i,i))return!0;return!1},filterMap:function(n){var t,e,r,i,u,o;for(t=$(),e=0,r=(i=this).length;e<r;e++)u=i[e],null!=(o=n.call(u,u))&&t.push(o);return t},tap:function(n){return n.call(this,this)},replaceWith:function(n){var t,e,r;for(this.clear(),t=0,e=n.length;t<e;t++)r=n[t],this.push(r);return this},reduce:function(n,t){var e,r,i,u,o,s;for("function"==typeof t&&(n=(u=[t,n])[0],t=u[1]),e=0,i=this.length,null==t&&(t=this[e++]),s=r=e,o=i;r<o;s=r+=1)t=n.call(this[s],t,this[s]);return t},union:function(n,t){var e,r,i,u,o,s,c;for(null==t&&(t=!0),s=$(),e=0,i=(o=this).length;e<i;e++)c=o[e],s.contains(c,t)||s.push(c);for(r=0,u=n.length;r<u;r++)c=n[r],s.contains(c,t)||s.push(c);return s},distinct:function(n){return null==n&&(n=!0),this.union(this,n)},intersect:function(n){var t;return $(function(){var e,r,i,u;for(u=[],e=0,r=(i=this).length;e<r;e++)t=i[e],indexOf.call(n,t)>=0&&u.push(t);return u}.call(this))},contains:function(n,t){var e,r,i;if(null==t&&(t=!0),t)return this.indexOf(n)>-1;for(e=0,r=(i=this).length;e<r;e++)if(i[e]==n)return!0;return!1},count:function(n,t){var e,r,i,u,o;for(null==t&&(t=!0),i=0,e=0,r=(u=this).length;e<r;e++)o=u[e],(void 0===n||t&&o===n||!t&&o==n)&&++i;return i},coalesce:function(){var n,t,e,r;for(t=0,e=(r=this).length;t<e;t++)if(n=r[t],$.type.in("array","bling",n)&&(n=$(n).coalesce()),null!=n)return n;return null},swap:function(t,e){var r;return t=n(t,this),e=n(e,this),t!==e&&(r=[this[e],this[t]],this[t]=r[0],this[e]=r[1]),this},shuffle:function(){var n;for(n=this.length-1;n>=0;)this.swap(--n,Math.floor(Math.random()*n));return this},select:function(){var n,t,e;return n=function(n){return function(){var t;return $.is("function",t=this[n])&&"constructor"!==n?$.bound(this,t):t}},e=function(e){var r;switch($.type(e)){case"regexp":return t.call(this,e);case"string":case"number":return e=String(e),"*"===e?this.flatten():(r=e.indexOf("."))>-1?this.select(e.substr(0,r)).select(e.substr(r+1)):this.map(n(e));default:return $()}},t=function(){var n,t,e,r,i,u,o,s,c,a;for(n=1<=arguments.length?slice.call(arguments,0):[],this.length,o=Object.create(null),e=0,i=n.length;e<i;e++)if(c=n[e],$.is("regexp",c))for(r=0,u=(a=$.keysOf(this[0]).filter(c)).length;r<u;r++)s=a[r],o[s]=this.select(s);else o[c]=this.select(c);return t=0,this.map(function(){var n,e,r;e=Object.create(null);for(c in o)n=c.split(".").pop(),void 0!==(r=o[c][t])&&(e[n]=r);return t++,e})},function(){switch(arguments.length){case 0:return this;case 1:return e.apply(this,arguments);default:return t.apply(this,arguments)}}}(),or:function(n){var t,e,r;for(t=e=0,r=this.length;0<=r?e<r:e>r;t=0<=r?++e:--e)this[t]||(this[t]=n);return this},zap:function(n,t){var e,r,i,u;if($.is("object",n)){for(i in n)t=n[i],this.zap(i,t);return this}if((r=n.lastIndexOf("."))>0)return e=n.substr(0,r),u=n.substr(r+1),this.select(e).zap(u,t),this;switch($.type(t)){case"array":case"bling":this.each(function(){return this[n]=t[++r%t.length]});break;case"function":this.zap(n,this.select(n).map(t));break;default:this.each(function(){return this[n]=t})}return this},clean:function(){var n;return n=1<=arguments.length?slice.call(arguments,0):[],this.each(function(){var t,e,r,i,u,o,s;for(t=0,i=n.length;t<i;t++)switch(o=n[t],$.type(o)){case"string":case"number":delete this[o];break;case"regexp":for(e=0,u=(s=Object.keys(this)).length;e<u;e++)r=s[e],o.test(r)&&delete this[r]}return null})},take:function(n){var t,e;return null==n&&(n=1),t=Math.min(n,this.length),$(function(){var n,r,i;for(i=[],e=n=0,r=t;n<r;e=n+=1)i.push(this[e]);return i}.call(this))},skip:function(n){var t,e;return null==n&&(n=0),e=Math.max(0,0|n),$(function(){var n,r,i;for(i=[],t=n=e,r=this.length;n<r;t=n+=1)i.push(this[t]);return i}.call(this))},first:function(n){return null==n&&(n=1),1===n?this[0]:this.take(n)},last:function(n){return null==n&&(n=1),1===n?this[this.length-1]:this.skip(this.length-n)},slice:function(t,e){var r;return null==t&&(t=0),null==e&&(e=this.length),t=n(t,this),e=n(e,this),$(function(){var n,i,u,o;for(o=[],r=n=i=t,u=e;i<=u?n<u:n>u;r=i<=u?++n:--n)o.push(this[r]);return o}.call(this))},extend:function(n){var t,e,r;for(e=0,r=n.length;e<r;e++)t=n[e],this.push(t);return this},push:function(n){return Array.prototype.push.call(this,n),this},unshift:function(n){return Array.prototype.unshift.call(this,n),this},filter:function(n,t,e){var r,i,u,o,s,c,a,l;for($.is("bool",t)&&(e=(c=[t,e])[0],t=c[1]),$.is("number",e)&&(t=(a=[e,t])[0],e=a[1]),null==t&&(t=this.length),null==e&&(e=!0),i=function(){switch(!1){case!$.is("object",n):return function(t){return $.matches(n,t)};case!$.is("string",n):return function(t){var e;return null!=(e=null!=t&&"function"==typeof t.matchesSelector?t.matchesSelector(n):void 0)&&e};case!$.is("regexp",n):return function(t){return n.test(t)};case!$.is("function",n):return n;case!$.type.in("bool","number","null","undefined",n):return function(t){return n===t};default:throw new Error("unsupported argument to filter: "+$.type(n))}}(),r=$(),u=0,s=(l=this).length;u<s;u++)if(o=l[u],!!i.call(o,o)===e){if(--t<0)break;r.push(o)}return r},matches:function(n){switch(!1){case!$.is("string",n):return this.select("matchesSelector").call(n);case!$.is("regexp",n):return this.map(function(t){return n.test(t)});default:throw new Error("unsupported argument to matches: "+$.type(n))}},weave:function(n){var t,e,r,i,u;for(t=$(),e=r=this.length-1;r>=0;e=r+=-1)t[2*e+1]=this[e];for(e=i=0,u=n.length;i<u;e=i+=1)t[2*e]=n[e];return t},fold:function(n){var t,e,r;return r=this.length,t=$(function(){var t,i,u;for(u=[],e=t=0,i=r-1;t<i;e=t+=2)u.push(n.call(this,this[e],this[e+1]));return u}.call(this)),r%2==1&&t.push(n.call(this,this[r-1],void 0)),t},flatten:function(){var n,t,e,r,i,u,o,s,c;for(n=$(),t=e=0,o=(c=this).length;e<o;t=++e)if(r=c[t],$.type.in("array","bling","arguments","nodelist",r))for(u=0,s=r.length;u<s;u++)i=r[u],n.push(i);else n.push(r);return n},call:function(){return this.apply(null,arguments)},apply:function(n,t){return this.filterMap(function(){return $.is("function",this)?this.apply(n,t):null})},log:function(n){return n?$.log(n,this.toString(),this.length+" items"):$.log(this.toString(),this.length+" items"),this},toArray:function(){return this.__proto__=Array.prototype,this},clear:function(){return this.splice(0,this.length)},indexWhere:function(n){var t,e,r,i,u;for(t=e=0,r=(i=this).length;e<r;t=++e)if(u=i[t],n.call(u,u))return t;return-1}}}),$.plugin({provides:"css,CSS",depends:"type"},function(){var n,t,e,r,i;return t=function(n,e,r){var i,u,o;e in r||(r[e]=[]);for(i in n)switch(typeof(o=n[i])){case"string":case"number":u=i.replace(/([a-z]+)([A-Z]+)/g,"$1-$2").toLowerCase(),r[e].push(u+": "+o+";");break;case"object":t(o,u=e?e+i:i,r);break;default:throw new Error("unexpected type in css: "+typeof o)}return r},i=function(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")},r=function(n){for(var t,e;(t=n.indexOf("/*"))>-1&&-1!==(e=n.indexOf("*/",t));)n=n.substring(0,t)+n.substring(e+2);return n},e=function(n,t){var r,u,o,s,c,a,l,f,h,p;if(a=n.match(/([^{]+){/)){if(h=i(a[1]),l=n.substring(a[0].length),t[h]||(t[h]={}),a=l.match(/([^}]+)}/))for(r=a[1].split(";"),l=l.substring(a[0].length),o=0,c=r.length;o<c;o++)u=(f=r[o]).indexOf(":"),(s=f.substring(0,u))&&(s=i(s),p=i(f.substring(u+1)),t[h][s]=p);if(l.length>0)return e(l,t)}return t},">+~",n=function(n){var t,e,r,i,u,o,s,c,a,l,f,h,p;f={};for(p in n){for(h=n[p],r=0,u=">+~".length;r<u;r++)s=">+~"[r],p=p.replace(s," "+s+" ");switch((a=p.split(/\s+/)).length){case 0:continue;case 1:$.extend(f[p]||(f[p]={}),h);break;default:for(t=f,e=!0,i=0,o=a.length;i<o;i++)c=a[i],e||(c=" "+c),t=t[c]||(t[c]={}),e=!1;$.extend(t,h)}}return(l=function(n){var t,e,r;for(t in n)if(r=n[t],$.is("object",r)){switch((e=Object.keys(r)).length){case 0:delete n[t];break;default:1===e.length&&$.is("object",r[e[0]])&&(n[t+e[0]]=r[e[0]],delete n[t],l(n))}l(r)}return n})(f)},{$:{CSS:{parse:function(t,i){var u;return null==i&&(i=!1),u=e(r(t),{}),i?n(u):u},stringify:function(n){var e,r;return function(){var i,u;i=t(n,"",{}),u=[];for(e in i)(r=i[e]).length>0&&u.push(e+" { "+r.join(" ")+" }");return u}().join(" ")}}}}}),$.plugin({provides:"date,midnight,stamp,unstamp,dateFormat,dateParse",depends:"type"},function(){var n,t,e,r,i,u,o,s,c,a,l,f,h,p,d,g,v,y;return d=[1,1e3,6e4,36e5,864e5],a=d[0],g=d[1],c=d[2],o=d[3],t=d[4],y={ms:a,s:g,m:c,h:o,d:t,sec:g,second:g,seconds:g,min:c,minute:c,minutes:c,hr:o,hour:o,hours:o,day:t,days:t},v=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],s=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u={yyyy:Date.prototype.getUTCFullYear,YY:e=function(){return String(this.getUTCFullYear()).substr(2)},yy:e,mm:function(){return this.getUTCMonth()+1},dd:Date.prototype.getUTCDate,dw:Date.prototype.getUTCDay,dW:function(){return v[parseInt(this.getUTCDay(),10)-1]},DW:function(){return s[parseInt(this.getUTCDay(),10)-1]},HH:Date.prototype.getUTCHours,MM:Date.prototype.getUTCMinutes,SS:Date.prototype.getUTCSeconds,MS:Date.prototype.getUTCMilliseconds,_MS:function(){return $.padLeft(Date.prototype.getUTCMilliseconds.apply(this),3,"0")}},i=Object.keys(u).sort().reverse(),p={YYYY:f=Date.prototype.setUTCFullYear,yyyy:f,YY:l=function(n){return this.setUTCFullYear((n>50?1900:2e3)+n)},yy:l,mm:function(n){return this.setUTCMonth(n-1)},dd:Date.prototype.setUTCDate,HH:Date.prototype.setUTCHours,MM:Date.prototype.setUTCMinutes,SS:Date.prototype.setUTCSeconds,_MS:function(n){return this.setUTCMilliseconds(parseInt(n,10))},MS:Date.prototype.setUTCMilliseconds},h=Object.keys(p).sort().reverse(),r=Math.floor,$.type.register("date",{is:function(n){return $.isType(Date,n)},array:function(n){return[n]},string:function(n,t,e){return $.date.format(n,t,e)},number:function(n,t){return $.date.stamp(n,t)}}),$.type.extend("string",{date:function(n,t){return null==t&&(t=$.date.defaultFormat),new Date($.date.parse(n,t,"ms"))}}),$.type.extend("number",{date:function(n,t){return null==t&&(t=$.date.defaultUnit),$.date.unstamp(n,t)}}),n=function(n){return function(t,e,r){var i;return null==r&&(r=$.date.defaultUnit),i=$.date.unstamp(t,r),p[n].call(i,u[n].call(i)+e),$.date.stamp(i,r)}},{$:{date:{defaultUnit:"s",defaultFormat:"yyyy-mm-dd HH:MM:SS",stamp:function(n,t){return null==n&&(n=new Date),null==t&&(t=$.date.defaultUnit),r(n/y[t])},unstamp:function(n,t){return null==t&&(t=$.date.defaultUnit),new Date(r(n*y[t]))},convert:function(n,t,e){return null==t&&(t=$.date.defaultUnit),null==e&&(e=$.date.defaultUnit),$.is("date",n)&&(n=$.date.stamp(n,t)),r(n*y[t]/y[e])},midnight:function(n,t){return null==t&&(t=$.date.defaultUnit),$.date.convert($.date.convert(n,t,"d"),"d",t)},format:function(n,t,e){var r,o,s,c;for(null==t&&(t=$.date.defaultFormat),null==e&&(e=$.date.defaultUnit),$.is("date",n)&&(n=$.date.stamp(n,e)),r=$.date.unstamp(n,e),o=0,c=i.length;o<c;o++)s=i[o],t=t.replace(s,$.padLeft(""+u[s].call(r),s.length,"0"));return t},parse:function(n,t,e){var r,i,u,o,s;for(null==t&&(t=$.date.defaultFormat),null==e&&(e=$.date.defaultUnit),r=new Date(0),i=0;i<t.length;){for(u=0,s=h.length;u<s;u++)if(o=h[u],t.indexOf(o,i)===i){try{p[o].call(r,parseInt(n.slice(i,i+o.length),10))}catch(e){throw e,new Error("Invalid date ('"+n+"') given format mask: "+t+" (failed at position "+i+")")}i+=o.length-1;break}i+=1}return $.date.stamp(r,e)},addMilliseconds:n("MS"),addSeconds:n("SS"),addMinutes:n("MM"),addHours:n("HH"),addDays:n("dd"),addMonths:n("mm"),addYears:n("yyyy"),range:function(t,e,r,i,u){var o,s,c;for(null==r&&(r=1),null==i&&(i="dd"),null==u&&(u=$.date.defaultUnit),o=n(i),c=[t];(s=c[c.length-1])<e;)c.push(o(s,r,u));return c}}},midnight:function(n){return null==n&&(n=$.date.defaultUnit),this.map(function(){return $.date.midnight(this,n)})},unstamp:function(n){return null==n&&(n=$.date.defaultUnit),this.map(function(){return $.date.unstamp(this,n)})},stamp:function(n){return null==n&&(n=$.date.defaultUnit),this.map(function(){return $.date.stamp(this,n)})},dateFormat:function(n,t){return null==n&&(n=$.date.defaultFormat),null==t&&(t=$.date.defaultUnit),this.map(function(){return $.date.format(this,n,t)})},dateParse:function(n,t){return null==n&&(n=$.date.defaultFormat),null==t&&(t=$.date.defaultUnit),this.map(function(){return $.date.parse(this,n,t)})}}}),$.plugin({provides:"debug, debugStack",depends:"core"},function(){var n,t;return n=function(n,t){var e,r,i,u,o,s,c;c=/(?:\r\n|\r|\n)/,i=null;try{i=require("fs")}catch(t){return e=t,n}return u=$(String(n).split(c)).filter(/^$/,!1),t||(u=u.filter(/node_modules/,!1)),s=u.first(),u=u.skip(1),o=Object.create(null),r=u.map(function(n){var t,r,u,s,a,l,f,h,p;if(null==n)return null;u=n.replace(/^\s*at\s+/g,"").replace(/.*\(([^:]+:\d+:\d+)\)$/,"$1");try{return f=u.split(/:/),u=f[0],l=f[1],r=f[2],null==(s=null!=o[u]?o[u]:o[u]=String(i.readFileSync(u)).split(c))?null:(t="",l>1&&(t=s[l-2]).length>80&&(t="..8<.. "+t.substr(r-25,50)+" ..>8.."),l>=s.length?null:null==(a=s[l-1])?null:(a.length>80&&(a="..8<.."+a.substr(r-25,50)+"..>8..",r=31),p=a.replace(/[^\t]/g,"").length,h=$.repeat("\t",p)+$.repeat(" ",r-1-p),"  "+(l-1)+" "+t+"\n  "+l+" "+a+"\n  "+l+" "+h+"^"))}catch(n){return e=n,null}}),s+"\n"+$.weave(r,u).filter(null,!1).join("\n")},t=function(n,e){return n&&n.constructor?t(n.__proto__,e.push(n.constructor)):e},{$:{debugStack:function(t,e){var r;return null==e&&(e=!1),r=function(){switch(!1){case!$.is("error",t):return String(t.stack);case!$.is("string",t):return t;default:return String(t)}}(),n(r,e)},protoChain:function(n){return t(n.__proto__,$())}}}}),$.plugin({provides:"delay,immediate,interval",depends:"is,select,extend,bound,core"},function(){return{$:{delay:function(){var n;return n=$.extend([],function(){var n;return n=function(n){return function(){return n.length&&n.shift()(),null}},{add:function(t,e){var r,i,u;for($.extend(t,{order:e+$.now,timeout:setTimeout(n(this),e)}),r=i=0,u=this.length;i<=u;r=i+=1)if(r===this.length||this[r].order>t.order){this.splice(r,0,t);break}return this},cancel:function(n){var t;return(t=this.indexOf(n))>-1&&(this.splice(t,1),clearTimeout(n.timeout)),this}}}()),function(t,e){var r,i,u;switch(!1){case!$.is("object",t):return r=$(function(){var n;n=[];for(i in t)u=t[i],n.push($.delay(i,u));return n}()),{cancel:function(){return r.select("cancel").call()},unref:function(){return r.select("unref").call()},ref:function(){return r.select("ref").call()}};case!$.is("function",e):return n.add(e,parseInt(t,10)),{cancel:function(){return n.cancel(e)},unref:function(n){var t;return null!=(t=n.timeout)?t.unref():void 0},ref:function(n){var t;return null!=(t=n.timeout)?t.ref():void 0}};default:throw new Error("Bad arguments to $.delay (expected: int,function given: "+$.type(t)+","+$.type(e)+")")}}}(),immediate:function(){switch(!1){case!("setImmediate"in $.global):return $.global.setImmediate;case null==("undefined"!=typeof process&&null!==process?process.nextTick:void 0):return process.nextTick;default:return function(n){return setTimeout(n,0)}}}(),interval:function(n,t){var e,r,i;return r=!1,i=$.delay(n,e=function(){return r||t(),$.delay(n,e)}),$.extend(i,{pause:function(n){return null==n&&(n=!0),r=n},resume:function(n){return null==n&&(n=!0),r=!n}})}},delay:function(n,t){return $.delay(n,$.bound(this,t)),this}}}),$.plugin({depends:"inherit,reduce",provides:"diff,stringDistance,stringDiff"},function(){var n,t,e,r,i,u,o,s,c;return o=Object.create(null),s=Math.min,u=function(n,t,e,r,i,c,a,l,f){var h,p;return null!=o[h=[n,t,e,r,i,c,a,l,f]]?o[h]:o[h]=null!=o[p=[r,i,c,n,t,e,a,l,f]]?o[p]:o[p]=function(){switch(!1){case!(c<=0):return e;case!(e<=0):return c;default:return s(a+u(n,t+1,e-1,r,i,c,a,l,f),l+u(n,t,e,r,i+1,c-1,a,l,f),f*(n[t]!==r[i])+u(n,t+1,e-1,r,i+1,c-1,a,l,f))}}()},n=function(n){return $.inherit({toHTML:function(){return this.reduce(function(n,t){return n+=function(){switch(t.op){case"ins":return"<ins>"+t.v+"</ins>";case"del":return"<del>"+t.v+"</del>";case"sub":return"<del>"+t.v+"</del><ins>"+t.w+"</ins>";case"sav":return t.v}}()},"")}},n.reduce(function(n,t){var e;return"sub"===t.op&&t.v===t.w&&(t.op="sav",delete t.w),n.length&&(e=n.last()).op===t.op?(e.v+=t.v,"sub"===e.op&&(e.w+=t.w)):n.push(t),n},$()))},r=Object.create(null),t=function(n){return{op:"del",v:n}},i=function(n){return{op:"ins",v:n}},c=function(n,t){return{op:"sub",v:n,w:t}},e=function(o,a,l,f,h,p,d,g,v){var y;return null!=r[y=[o,a,l,f,h,p,d,g,v]]?r[y]:r[y]=n(function(){var n,r,y,m,b,k,x,w,S,T,j;switch(!1){case!(p<=0):for(T=[],m=0,k=(w=o.substr(a,l)).length;m<k;m++)r=w[m],T.push(t(r));return T;case!(l<=0):for(j=[],b=0,x=(S=f.substr(h,p)).length;b<x;b++)r=S[b],j.push(i(r));return j;default:switch(v*=o[a]!==f[h],n={del:[o+0,a+1,l-1,f+0,h+0,p+0,1,1.5,1.5],ins:[o+0,a+0,l+0,f+0,h+1,p-1,1.5,1,1.5],sub:[o+0,a+1,l-1,f+0,h+1,p-1,1,1,1]},y={del:d+u.apply(null,n.del),ins:g+u.apply(null,n.ins),sub:v+u.apply(null,n.sub)},s(y.del,y.ins,y.sub)){case y.del:return $(t(o[a])).concat(e.apply(null,n.del));case y.ins:return $(i(f[h])).concat(e.apply(null,n.ins));case y.sub:return $(c(o[a],f[h])).concat(e.apply(null,n.sub))}}}())},{$:{stringDistance:function(n,t){return u(n,0,n.length,t,0,t.length,1,1,1)},stringDiff:function(n,t){return e(n,0,n.length,t,0,t.length,1,1,1.5)}}}}),null!=$.global.document&&$.plugin({provides:"dom,HTML,html,append,appendText,appendTo,prepend,prependTo,before,after,wrap,unwrap,replace,attr,data,addClass,removeClass,toggleClass,hasClass,text,val,css,defaultCss,rect,width,height,top,left,bottom,right,position,scrollToCenter,child,parents,next,prev,remove,find,querySelectorAll,clone,toFragment",depends:"function,type,string"},function(){var n,t,e,r,i,u,o,s;return t=!1,$.type.register("nodelist",{is:function(n){return null!=n&&$.isType("NodeList",n)},hash:function(n){var t;return $(function(){var e,r,i;for(i=[],e=0,r=n.length;e<r;e++)t=n[e],i.push($.hash(t));return i}()).sum()},array:function(){try{return document.querySelectorAll("xxx").__proto__={},$.identity}catch(n){return n,t=!0,function(n){var t,e,r,i;for(i=[],t=0,e=n.length;t<e;t++)r=n[t],i.push(r);return i}}}(),string:function(n){return"{Nodelist:["+$(n).select("nodeName").join(",")+"]}"},node:function(n){return $(n).toFragment()}}),$.type.register("node",{is:function(n){return(null!=n?n.nodeType:void 0)>0},hash:function(n){return $.checksum(n.nodeName)+$.hash(n.attributes)+$.checksum(n.innerHTML)},string:function(n){return n.toString()},node:$.identity}),$.type.register("fragment",{is:function(n){return 11===(null!=n?n.nodeType:void 0)},hash:function(n){var t;return $(function(){var e,r,i,u;for(u=[],e=0,r=(i=n.childNodes).length;e<r;e++)t=i[e],u.push($.hash(t));return u}()).sum()},string:function(n){return n.toString()},node:$.identity}),$.type.register("html",{is:function(n){var t;return"string"==typeof n&&"<"===(t=n.trimLeft())[0]&&">"===t[t.length-1]},node:function(n){var t,e,r,i,u,o;if((u=document.createElement("div")).innerHTML=n,1===(i=(t=u.childNodes).length))return u.removeChild(t[0]);for(e=document.createDocumentFragment(),r=0,o=i;r<o;r+=1)e.appendChild(u.removeChild(t[0]));return e},array:function(n){var t;return $.type.lookup(t=$.HTML.parse(n)).array(t)},string:function(n){return"'"+n+"'"},repr:function(n){return'"'+n+'"'}}),$.type.extend({unknown:{node:function(){return null}},bling:{node:function(n){return n.toFragment()}},node:{html:function(n){var t,e;return(t=document.createElement("div")).appendChild(n=n.cloneNode(!0)),e=t.innerHTML,t.removeChild(n),e}},string:{node:function(n){return $(n).toFragment()},array:function(){return t?function(n){var t;return $.type.lookup(t=document.querySelectorAll(n)).array(t)}:function(n){return document.querySelectorAll(n)}}()},function:{node:function(n){return $(n.toString()).toFragment()}}}),o=function(n){return n.parentNode||document.createDocumentFragment().appendChild(n),n},e=function(n,t){return o(n).parentNode.insertBefore(t,n)},n=function(n,t){return o(n).parentNode.insertBefore(t,n.nextSibling)},s=function(n){return $.type.lookup(n).node(n)},r=!1,!1,$.computeCSSProperty=function(n){return function(){return $.global.getComputedStyle(this,null).getPropertyValue(n)}},i=function(n){return function(t){return null!=t?this.css(n,t):this.rect().select(n)}},u=function(n){return function(){return this.map(function(t){return $(function(){var e;for(e=[];t=t[n];)e.push(t);return e}())})}},{$:{HTML:{parse:function(n){return $.type.lookup(n).node(n)},stringify:function(n){return $.type.lookup(n).html(n)},escape:function(n){var t;return r||(r=$("<div>&nbsp;</div>").child(0)),t=r.zap("data",n).select("parentNode.innerHTML").first(),r.zap("data",""),t}}},html:function(n){switch($.type(n)){case"undefined":case"null":return this.select("innerHTML");case"string":case"html":return this.zap("innerHTML",n);case"bling":return this.html(n.toFragment());case"node":return this.each(function(){var t;for(this.replaceChild(this.childNodes[0],n),t=[];this.childNodes.length>1;)t.push(this.removeChild(this.childNodes[1]));return t})}},append:function(n){if(null!=(n=s(n)))return this.each(function(t){return null!=t&&"function"==typeof t.appendChild?t.appendChild(n.cloneNode(!0)):void 0})},appendText:function(n){var t;if(null!=(t=document.createTextNode(n)))return this.each(function(n){return null!=n&&"function"==typeof n.appendChild?n.appendChild(t.cloneNode(!0)):void 0})},appendTo:function(n){var t,e;return t=this.map(function(){return this.cloneNode(!0)}),e=0,$(n).each(function(){return this.appendChild(t[e++])}),t},prepend:function(n){return null!=n&&(n=s(n),this.take(1).each(function(){switch(!1){case!(this.childNodes.length>0):return e(this.childNodes[0],n);default:return this.appendChild(n)}}),this.skip(1).each(function(){switch(!1){case!this.childNodes.length:return e(this.childNodes[0],n.cloneNode(!0));default:return this.appendChild(n.cloneNode(!0))}})),this},prependTo:function(n){return null!=n&&$(n).prepend(this),this},before:function(n){return null!=n&&(n=s(n),this.take(1).each(function(){return e(this,n)}),this.skip(1).each(function(){return e(this,n.cloneNode(!0))})),this},after:function(t){return null!=t&&(t=s(t),this.take(1).each(function(){return n(this,t)}),this.skip(1).each(function(){return n(this,t.cloneNode(!0))})),this},wrap:function(n){if(n=s(n),$.is("fragment",n))throw new Error("cannot call .wrap() with a fragment as the parent");return this.each(function(t){var e,r;return $.is("fragment",t)||!t.parentNode?n.appendChild(t):(e=t.parentNode,r=document.createElement("dummy"),n.appendChild(e.replaceChild(r,t)),e.replaceChild(n,r))})},unwrap:function(){return this.each(function(){return this.parentNode&&this.parentNode.parentNode?this.parentNode.parentNode.replaceChild(this,this.parentNode):this.parentNode?this.parentNode.removeChild(this):void 0})},replace:function(n){var t,e,r,i,u,o;if($.is("regexp",n))return i=arguments[1],this.map(function(t){return t.replace(n,i)});for(n=s(n),e=r=0,u=(t=this.map(function(){return n.cloneNode(!0)})).length;r<u;e=r+=1)null!=(o=this[e].parentNode)&&o.replaceChild(t[e],this[e]);return t},attr:function(n,t){var e;if($.is("object",n))for(e in n)t=n[e],this.attr(e,t);else switch(t){case void 0:return this.select("getAttribute").call(n,t);case null:this.select("removeAttribute").call(n,t);break;default:this.select("setAttribute").call(n,t)}return this},data:function(n,t){return this.attr("data-"+$.dashize(n),t)},addClass:function(n){var t;return t=function(n){return""!==n},this.removeClass(n).each(function(){var e;return(e=this.className.split(" ").filter(t)).push(n),this.className=e.join(" ")})},removeClass:function(n){var t;return t=function(t){return t!==n},this.each(function(){if(this.className=this.className.split(" ").filter(t).join(" "),0===this.className.length)return this.removeAttribute("class")})},toggleClass:function(n){var t;return t=function(t){return t!==n},this.each(function(){var e,r;if(e=this.className.split(" "),r=$.not($.isEmpty),e.indexOf(n)>-1?r=$.and(t,r):e.push(n),this.className=e.filter(r).join(" "),0===this.className.length)return this.removeAttribute("class")})},hasClass:function(n){return this.select("className.split").call(" ").select("indexOf").call(n).map(function(n){return n>-1})},text:function(n){return null!=n?this.zap("textContent",n):this.select("textContent")},val:function(n){return null!=n?this.zap("value",n):this.select("value")},css:function(n,t){var e,r,i,u,o,s,c;if(null!=t||$.is("object",n)){if(c=this.select("style.setProperty"),$.is("object",n))for(i in n)t=n[i],c.call(i,t,"");else if($.is("array",t))for(e=r=0,s=u=Math.max(t.length,o=c.length);r<s;e=r+=1)c[e%o](n,t[e%u],"");else $.is("function",t)?this.select("style."+n).weave(this.map($.computeCSSProperty(n))).fold($.coalesce).weave(c).fold(function(e,r){return e(n,t.call(r,r))}):c.call(n,t,"");return this}return this.select("style."+n).weave(this.map($.computeCSSProperty(n))).fold($.coalesce)},defaultCss:function(n,t){var e,r,i;if(r=this.selector,i="",$.is("string",n)){if(!$.is("string",t))throw Error("defaultCss requires a value with a string key");i+=r+" { "+n+": "+t+" } "}else if($.is("object",n))for(e in n+"} ")i+=r+" { "+e+": "+n[e]+"; ";return $("<style></style>").text(i).appendTo("head"),this},rect:function(){return this.map(function(n){switch(n){case window:return{width:window.innerWidth,height:window.innerHeight,top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};default:return n.getBoundingClientRect()}})},width:i("width"),height:i("height"),top:i("top"),left:i("left"),bottom:i("bottom"),right:i("right"),position:function(n,t){switch(!1){case!(null==n):return this.rect();case!(null==t):return this.css("left",$.px(n));default:return this.css({top:$.px(t),left:$.px(n)})}},scrollToCenter:function(){return document.body.scrollTop=this[0].offsetTop-$.global.innerHeight/2,this},child:function(n){return this.select("childNodes").map(function(){return this[n<0?n+this.length:n]})},parents:u("parentNode"),prev:u("previousSibling"),next:u("nextSibling"),remove:function(){return this.each(function(){var n;return null!=(n=this.parentNode)?n.removeChild(this):void 0})},find:function(n,t){return null==t&&(t=0),this.filter("*").map(function(){switch(t){case 0:return function(){return this.querySelectorAll(n)};case 1:return function(){return $(this.querySelector(n))};default:return function(){return $(this.querySelectorAll(n)).take(t)}}}()).flatten()},querySelectorAll:function(n){return this.filter("*").reduce(function(t,e){return t.extend(e.querySelectorAll(n))},$())},clone:function(n,t){var e;return null==n&&(n=!0),null==t&&(t=1),e=function(t){if($.is("node",t))return t.cloneNode(n)},this.map(function(){var n,r,i;switch(t){case 1:return e(this);default:for(i=[],n=0,r=t;n<r;n+=1)i.push(e(this));return i}})},toFragment:function(){var n;return this.length>1?(n=document.createDocumentFragment(),this.map(s).map(function(t){return n.appendChild(t)}),n):s(this[0])}}}),$.plugin({provides:"EventEmitter",depends:"type,hook"},function(){return{$:{EventEmitter:$.init.append(function(n){var t,e,r;return n!==$.global&&null!==n&&void 0!==n||(n=this===$.global||this===$?{}:this),r=Object.create(null),e=function(n){return r[n]||(r[n]=[])},$.inherit({emit:function(){var n,t,r,i,u;for(t=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],r=0,i=(u=e(t)).length;r<i;r++)u[r].apply(this,n);return this},on:t=function(n,t){var r,i;"string"==typeof n&&e(n).push(t);for(r in n)i=n[r],"object"==typeof n&&this.addListener(r,i);return this},addListener:t,removeListener:function(n,t){var r,i;if((r=(i=e(n)).indexOf(t))>-1)return i.splice(r,1)},removeAllListeners:function(n){return r[n]=[]},setMaxListeners:function(){},listeners:function(n){return e(n).slice(0)}},n)})}}}),$.plugin({depends:"dom,function,core",provides:"event,bind,unbind,trigger,delegate,undelegate,click,ready"},function(){var n,t,e,r,i,u,o,s;return n=/,* +/,u=["mousemove","mousedown","mouseup","mouseover","mouseout","blur","focus","load","unload","reset","submit","keyup","keydown","keypress","change","abort","cut","copy","paste","selection","drag","drop","orientationchange","touchstart","touchmove","touchend","touchcancel","gesturestart","gestureend","gesturecancel","hashchange"],i=function(n){return function(t){return $.is("function",t)?this.bind(n,t):this.trigger(n,t)}},e=function(){var n,t,r;return r=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],0===n.length?r:e.apply(null,[r[t=n[0]]||(r[t]=Object.create(null))].concat(slice.call(n.slice(1))))},s=$.once(function(){var n;return $(document).trigger("ready").unbind("ready"),"function"==typeof document.removeEventListener&&document.removeEventListener("DOMContentLoaded",s,!1),"function"==typeof(n=$.global).removeEventListener?n.removeEventListener("load",s,!1):void 0}),"function"==typeof document.addEventListener&&document.addEventListener("DOMContentLoaded",s,!1),"function"==typeof(r=$.global).addEventListener&&r.addEventListener("load",s,!1),t=function(t){return function(e,r){var i;return i=(e||"").split(n),this.each(function(){var n,e,u,o;for(o=[],e=0,u=i.length;e<u;e++)n=i[e],o.push(this[t](n,r,!0));return o})}},o={bind:t("addEventListener"),unbind:t("removeEventListener"),trigger:function(t,e){var r,i,u,o,s;for(null==e&&(e={}),e=$.extend({bubbles:!0,cancelable:!0},e),u=0,o=(s=(t||"").split(n)).length;u<o;u++){switch(i=s[u]){case"click":case"mousemove":case"mousedown":case"mouseup":case"mouseover":case"mouseout":r=document.createEvent("MouseEvents"),e=$.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null},e),r.initMouseEvent(i,e.bubbles,e.cancelable,$.global,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);break;case"blur":case"focus":case"reset":case"submit":case"abort":case"change":case"load":case"unload":(r=document.createEvent("UIEvents")).initUIEvent(i,e.bubbles,e.cancelable,$.global,1);break;case"touchstart":case"touchmove":case"touchend":case"touchcancel":r=document.createEvent("TouchEvents"),e=$.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,touches:[],targetTouches:[],changedTouches:[],scale:1,rotation:0},e),r.initTouchEvent(i,e.bubbles,e.cancelable,$.global,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.touches,e.targetTouches,e.changedTouches,e.scale,e.rotation);break;case"gesturestart":case"gestureend":case"gesturecancel":r=document.createEvent("GestureEvents"),e=$.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,target:null,scale:1,rotation:0},e),r.initGestureEvent(i,e.bubbles,e.cancelable,$.global,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.target,e.scale,e.rotation);break;case"keydown":case"keypress":case"keyup":r=document.createEvent("KeyboardEvents"),e=$.extend({view:null,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},e),r.initKeyboardEvent(i,e.bubbles,e.cancelable,$.global,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.keyCode,e.charCode);break;default:(r=document.createEvent("Events")).initEvent(i,e.bubbles,e.cancelable),r=$.extend(r,e)}r&&this.each(function(){var n;try{return this.dispatchEvent(r)}catch(t){return n=t,$.log("dispatchEvent error:",n)}})}return this},delegate:function(n,t,r){var i,u,o,s,c;for(i=function(t){var e,i;if(i=null!=(e=$(t.target).parents()[0])?e.unshift(t.target).filter(n)[0]:void 0)return r.call(t.target=i,t)},u=0,o=(c=this.bind(t,i)).length;u<o;u++)s=c[u],e(s,"__delegates__",n,t)[r]=i;return this},undelegate:function(n,t,r){var i,u,o,s,c,a;for(a=[],u=0,o=(c=this).length;u<o;u++)s=c[u],(i=e(s,"__delegates__",n,t))&&i[r]?(this.unbind(t,i[r]),a.push(delete i[r])):a.push(void 0);return a},click:function(n){var t;return null==n&&(n={}),"auto"!==(t=this.css("cursor"))&&""!==t||this.css("cursor","pointer"),$.is("function",n)?this.bind("click",n):this.trigger("click",n),this},ready:function(n){return s.exhausted?n.call(this):this.bind("ready",n)}},u.forEach(function(n){return o[n]=i(n)}),o}),$.plugin({provides:"function,identity,compose,once,cycle,bound,partial",depends:"extend,is,defineProperty,map"},function(){return{$:{identity:function(n){return n},not:function(n){return function(){return!n.apply(this,arguments)}},compose:function(n,t){return function(e){var r;return n.call(r,r=t.call(e,e))}},and:function(n,t){return function(e){return t.call(this,e)&&n.call(this,e)}},once:function(n,t){return null==t&&(t=1),$.defineProperty(function(){if(t-- >0)return n.apply(this,arguments)},"exhausted",{get:function(){return t<=0}})},cycle:function(){var n,t;return n=1<=arguments.length?slice.call(arguments,0):[],t=-1,function(){return n[t=++t%n.length].apply(this,arguments)}},bound:function(n,t,e){var r;return null==e&&(e=[]),null==t?$.identity:($.is("function",t.bind)?(e.splice(0,0,n),r=t.bind.apply(t,e)):r=function(){var r;return r=1<=arguments.length?slice.call(arguments,0):[],t.apply(n,e.length?e:r)},$.extend(r,{toString:function(){return"bound-method of "+n+"."+t.name}}))},partial:function(){var n,t;return t=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],t.apply(null,slice.call(n).concat(slice.call(e)))}}},partial:function(){var n;return n=1<=arguments.length?slice.call(arguments,0):[],this.map(function(t){return $.partial.apply($,[t].concat(slice.call(n)))})}}}),$.plugin(function(){var n;return Object.assign(function*(){return yield}().constructor.prototype,{toArray:function(){var n,t,e;n=[],t=this;for(e of t)n.push(e);return n},skip:function(n){for(;n-- >0;)this.next();return this},limit:function*(n){for(var t;n-- >0;){if((t=this.next()).done)return;yield t.value}return null},map:function*(n){var t,e;t=this;for(e of t)yield n(e);return null},filter:function*(n,t){var e,r;null==t&&(t=!0),e=this;for(r of e)n(r)===t&&(yield r);return null},select:function*(t){var e,r;t=t.split("."),e=this;for(r of e)yield n(r,t);return null}}),n=function(n,t){var e,r,i;for(e=0,r=t.length;e<r;e++)i=t[e],n=null!=n?n[i]:void 0;return n},{}}),$.plugin({provides:"hash",depends:"type"},function(){var n;return 4294967295,n=function(n){return function(t){var e;return n+$(function(){var n,r,i;for(i=[],n=0,r=t.length;n<r;n++)e=t[n],i.push($.hash(e));return i}()).reduce(function(n,t){return(n*n+(0|t))%4294967295},1)}},$.type.extend({unknown:{hash:function(n){return $.checksum($.toString(n))}},object:{hash:function(n){var t,e;return 1970931729+$(function(){var r;r=[];for(t in n)e=n[t],r.push($.hash(t)+$.hash(e));return r}()).sum()}},array:{hash:n(1816922041)},arguments:{hash:n(298517431)},bling:{hash:n(92078573)},bool:{hash:function(n){return parseInt(n?1:void 0)}},regexp:{hash:function(n){return 148243084+$.checksum($.toString(n))}}}),{$:{hash:function(n){return $.type.lookup(n).hash(n)}},hash:function(){return $.hash(this)}}}),$.plugin(function(){return{$:{histogram:function(n,t,e){var r,i,u,o,s,c,a,l,f,h,p,d,g,v,y,m,b,k;for(null==t&&(t=1),null==e&&(e=60),r=$(),c=0,p=Infinity,h=0,f=0,b=0,o=0,a=n.length;o<a;o++)k=n[o],p=Math.min(k,p),f=Math.max(k,f),b+=k,(u=Math.floor(k/t))in r?r[u]+=1:r[u]=1,c=Math.max(c,u+1);for(r.length=c,h=b/n.length,l=r.max(),m=(r=r.or(0).scale(1/l).scale(e)).sum(),y="",g=0,d=s=0,v=c;s<v;d=s+=1)i=(d+1)*t,(g+=100*r[d]/m)>0&&(y+=$.padLeft(g.toFixed(2)+"%",7)+$.padRight(" < "+i.toFixed(2),10)+": "+$.repeat("#",r[d])+"\n");return y+"N: "+n.length+" Min: "+p.toFixed(2)+" Max: "+f.toFixed(2)+" Mean: "+h.toFixed(2)}},histogram:function(){return $.histogram(this)}}}),$.plugin({provides:"hook",depends:"type"},function(){var n;return n=function(){var n;return n=[],$.extend(function(t){var e,r;for(e=0,r=n.length;e<r;e++)t=n[e].call(this,t);return t},{prepend:function(t){return n.unshift(t),t},append:function(t){return n.push(t),t}})},$.init=n(),{$:{hook:n}}}),$.plugin({depends:"dom",provides:"http"},function(){var n;return n=function(n){var t,e;return $.is("object",n)?(e=JSON.parse(JSON.stringify(n)),function(){var n;n=[];for(t in e)n.push(t+"="+escape(e[t]));return n}().join("&")):n},$.type.register("http",{is:function(n){return $.isType("XMLHttpRequest",n)},array:function(n){return[n]}}),{$:{http:function(t,e){var r,i,u,o,s,c,a;null==e&&(e={}),a=new XMLHttpRequest,s=$.Promise(),$.is("function",e)&&(e={success:$.bound(a,e)}),(e=$.extend({method:"GET",data:null,state:$.identity,success:$.identity,error:$.identity,async:!0,asBlob:!1,timeout:0,followRedirects:!1,withCredentials:!1,headers:{}},e)).state=$.bound(a,e.state),i=$.bound(a,e.success),r=$.bound(a,e.error),e.success=function(n){return s.resolve(n),i(n)},e.error=function(n){return s.reject(n),r(n)},e.data&&"GET"===e.method?t+="?"+n(e.data):e.data&&"POST"===e.method&&(e.data=n(e.data)),a.open(e.method,t,e.async),a=$.extend(a,{asBlob:e.asBlob,timeout:e.timeout,followRedirects:e.followRedirects,withCredentials:e.withCredentials,onreadystatechange:function(){if("function"==typeof e.state&&e.state(),4===a.readyState)return 200===a.status?e.success(a.responseText):e.error(a.status,a.statusText)}}),o=e.headers;for(u in o)c=o[u],a.setRequestHeader(u,c);try{a.addEventListener("progress",function(n){return function(n){return $.log("xhr progress event",n.loaded,n.total),s.emit("progress",n.loaded,n.total)}}())}catch(n){}return a.send(e.data),$.extend(s,{cancel:function(){return a.cancel()}})},post:function(n,t){return null==t&&(t={}),$.is("function",t)&&(t={success:t}),t.method="POST",$.http(n,t)},get:function(n,t){return null==t&&(t={}),$.is("function",t)&&(t={success:t}),t.method="GET",$.http(n,t)}}}}),$.depends("hook",function(){return $.init.append(function(n){var t,e;return e=new Map,t=[],$.inherit({index:function(n){var r,i,u,o,s,c;for(-1===t.indexOf(n)&&(t.push(n),e.set(n,new Map)),i=0,o=(s=this).length;i<o;i++)u=n(c=s[i]),(r=e.get(n)).has(u)||r.set(u,$()),r.get(u).push(c);return this},query:function*(n){var r,i,u,o,s,c,a,l,f;for(i=0,a=t.length;i<a;i++)if(c=t[i],(r=e.get(c)).has(s=c(n)))for(o=0,l=(f=r.get(s)).length;o<l;o++)if(u=f[o],!1===(yield u))return;return null},queryOne:function(n){return this.query(n).next().value}},n)})}),$.plugin({provides:"toHTML",depends:"type,synth,once"},function(){var n,t,e,r;return t=$.once(function(){try{return $("head").append($.synth("style#dump").text("table.dump                { border: 1px solid black; }\ntable.dump tr.h           { background-color: blue; color: white; cursor: pointer; }\ntable.dump tr.h th        { padding: 0px 4px; }\ntable.dump tr.h.array     { background-color: purple; }\ntable.dump tr.h.bling     { background-color: gold; }\ntable.dump td             { padding: 2px; }\ntable.dump td.k           { background-color: lightblue; }\ntable.dump td.v.string    { background-color: #cfc; }\ntable.dump td.v.number    { background-color: #ffc; }\ntable.dump td.v.bool      { background-color: #fcf; }"))}catch(n){}}),n=$.once(function(){try{return $("head").append($.synth("script#dump").text("$(document.body).delegate('table.dump tr.h', 'click', function() {\n\t$(this.parentNode).find(\"tr.kv\").toggle()\n})"))}catch(n){}}),e=function(n,t){var e,r,i,u;for(u=$.synth("table.dump tr.h."+n+" th[colspan=2] '"+n+"'"),"array"!==n&&"bling"!==n&&"nodelist"!==n||u.find("th").appendText(" ["+t.length+"]"),e=0,r=t.length;e<r;e++)i=t[e],u.append(i);return u[0]},r=function(n,t,e){var r,i,u;switch(i=$.synth("tr.kv td.k[align=right][valign=top] '"+n+"' + td.v"),u=i.find("td.v"),r=$.type(t=$.toHTML(t,e))){case"string":case"number":case"bool":case"html":case"null":case"undefined":u.appendText(String(t));break;default:u.append(t)}return u.addClass(r),e||i.toggle(),i},{$:{toHTML:function(i,u){var o,s,c,a;switch(null==u&&(u=!0),t(),n(),c=$.type(i)){case"string":case"number":case"bool":case"null":case"undefined":case"html":return i;case"bling":case"array":case"nodelist":return e(c,function(){var n,t,e;for(e=[],o=n=0,t=i.length;n<t;o=++n)a=i[o],e.push(r(o,a,u));return e}());case"object":case"array":return e(c,function(){var n;n=[];for(o in i)a=i[o],n.push(r(o,a,u));return n}());case"node":return(s=$.HTML.stringify(i)).substr(0,s.indexOf(">")+1)+"...";default:return String(i)}}}}}),$.plugin({provides:"keyName,keyNames",depends:"math"},function(){var n,t,e,r,i,u,o,s,c,a,l;for(i={Backspace:8,BS:8,Tab:9,"\t":9,Enter:13,"\n":12,Shift:16,Ctrl:17,Alt:18,Pause:19,Break:19,Caps:20,"Caps Lock":20,Esc:27,Escape:27,Space:32," ":32,PgUp:33,"Page Up":33,PgDn:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,Delete:46,Times:106,"*":106,Plus:107,"+":107,Minus:109,"-":109,Div:111,Divide:111,"/":111,"Semi-Colon":186,";":187,Equal:187,"=":187,Comma:188,",":188,Dash:189,"-":189,Dot:190,Period:190,".":190,"Forward Slash":191,"/":191,"Back Slash":220,"\\":220,"Single Quote":222,"'":222},e=0,o=(a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ").length;e<o;e++)i[n=a[e]]=i[n.toLowerCase()]=n.charCodeAt(0);for(r=0,s=(l=$.range(1,13)).length;r<s;r++)n=l[r],i["F"+n]=i["f"+n]=111+n;u={};for(c in i)t=i[c],u[t]||(u[t]=c);return{$:{keyCode:function(n){var t;return null!=(t=i[n])?t:n},keyName:function(n){var t;return null!=(t=u[n])?t:n}}}}),$.plugin({depends:"dom,promise",provides:"lazy"},function(){var n;return n=function(n,t){var e,r;return r=$.Promise(),document.head.appendChild(e=$.extend(document.createElement(n),t,{onload:function(){return r.resolve(e)},onerror:function(){return r.reject.apply(r,arguments)}})),r},{$:{script:function(t){return n("script",{src:t})},style:function(t){return n("link",{href:t,rel:"stylesheet"})}}}}),$.plugin({provides:"log, logger",depends:"bound"},function(){var n,t,e;return n={_MS:"",SS:"",MM:"",HH:"",dd:"",mm:"",yyyy:""},t=function(t){return function(){var t,e,r,i,u,o,s;return t=new Date,n._MS!==(o=$.padLeft(t.getUTCMilliseconds(),3,"0"))&&(n._MS=o,n.SS!==(s=$.padLeft(t.getUTCSeconds(),2,"0"))&&(n.SS=s,n.MM!==(i=$.padLeft(t.getUTCMinutes(),2,"0"))&&(n.MM=i,n.HH!==(r=$.padLeft(String(t.getUTCHours()),2,"0"))&&(n.HH=r,n.dd!==(e=$.padLeft(String(t.getUTCDate()),2,"0"))&&(n.dd=e,n.mm!==(u=$.padLeft(String(t.getUTCMonth()+1),2,"0"))&&(n.mm=u,n.yyyy=String(t.getUTCFullYear()))))))),n.yyyy+"-"+n.mm+"-"+n.dd+" "+n.HH+":"+n.MM+":"+n.SS+"."+n._MS}}(),e=function(){var n,t;if((n=1<=arguments.length?slice.call(arguments,0):[]).length)return(t="function"==typeof e.pre?e.pre():void 0)&&n.unshift(t),e.out.apply(e,n),n[n.length-1]},e.out=console.log.bind(console),e.pre=null,e.enableTimestamps=function(n){return null==n&&(n=2),e.pre=[null,function(){return String(+new Date)},t][n]},e.disableTimestamps=function(){return e.enableTimestamps(0)},{$:{log:e,logger:function(n){return function(){var t;return(t=1<=arguments.length?slice.call(arguments,0):[]).unshift(n),e.apply(null,t)}}}}}),$.plugin({provides:"matches",depends:"function,core,string"},function(){var n,t,e,r,i,u,o,s,c,a,l,f,h,p,d;r={function:[["array","bling",n=function(n,t,e){var r,i,u;for(r=0,i=t.length;r<i;r++)if(u=t[r],l(n,u,e))return!0;return!1}],["object",t=function(n,t,e){var r,i;for(r in t)if(i=t[r],l(n,i,e))return!0;return!1}]],regexp:[["string","number",function(n,t,e){return n.test(String(t))}],["array","bling",n],["object",t]],object:[["array","bling",n],["object",function(n,t,e){var r,i;for(r in n)if(i=n[r],!l(i,t[r]))return!1;return!0}]],array:[["array","bling",function(n,t,e){var r,i,u,o;for(r=i=0,u=n.length;i<u;r=++i)if(o=n[r],!l(o,t[r]))return!1;return!0}]],number:[["number",e=function(n,t,e){return t===n}],["array","bling",n]],string:[["string",e],["array","bling",n]]};for(h in r){for(l={},u=0,s=(d=r[h]).length;u<s;u++)for(a=d[u],i=a.pop(),o=0,c=a.length;o<c;o++)f=a[o],l[f]=i;$.type.extend(h,{matches:l})}return p={$any:function(){return!0},$type:function(n,t,e){return $.is(n.$type,t)},$class:function(n,t,e){return $.isType(n.$class,t)},$lt:function(n,t,e){return t<n.$lt},$gt:function(n,t,e){return t>n.$gt},$lte:function(n,t,e){return t<=n.$lte},$gte:function(n,t,e){return t>=n.$gte},$ne:function(n,t,e){return t!==n.$ne}},l=function(n,t,r){var u,o,s,c,a;if(null==r&&(r=$.type.lookup(n)),"object"===r.name)for(u in p)if(i=p[u],u in n)return i(n,t,r);o=r.matches;for(a in o)if(i=o[a],"else"!==a&&$.is(a,t))return i(n,t,r);return null!=(s=null!=(c=r.matches)&&"function"==typeof c.else?c.else(n,t,r):void 0)?s:e(n,t)},l.Any={$any:!0},l.Type=function(n){return{$type:n}},l.Class=function(n){return{$class:n}},{$:{matches:l}}}),$.plugin({provides:"math",depends:"core"},function(){var n,t,e,r;return $.type.extend({bool:{number:function(n){return n?1:0}},number:{bool:function(n){return!!n}}}),n=function(n){return function(t){var e,r;return e=function(){switch(!1){case!$.is("string",t):return function(n){return n[t]};case!$.is("function",t):return t;default:throw new Error(".maxBy first argument should be a string or function")}}(),r=this.first(),this.skip(1).each(function(t){if(n(e(t),e(r)))return r=t}),r}},{$:{range:function(n,t,e){var r;return null==e&&(e=1),null==t&&(t=n,n=0),t<n&&e>0&&(e*=-1),$(function(){var i,u,o;for(o=[],r=i=0,u=Math.ceil((t-n)/e);0<=u?i<u:i>u;r=0<=u?++i:--i)o.push(n+r*e);return o}())},zeros:function(n,t){var e;return null==t&&(t=0),$(function(){var r,i,u;for(u=[],e=r=0,i=n;0<=i?r<i:r>i;e=0<=i?++r:--r)u.push(t);return u}())},ones:function(n){var t;return $(function(){var e,r,i;for(i=[],t=e=0,r=n;0<=r?e<r:e>r;t=0<=r?++e:--e)i.push(1);return i}())},deg2rad:function(n){return n*Math.PI/180},rad2deg:function(n){return 180*n/Math.PI}},floats:function(){return this.map(parseFloat)},ints:function(){return this.map(function(){return parseInt(this,10)})},px:function(n){return this.ints().map(function(){return $.px(this,n)})},min:function(){return this.filter(isFinite).reduce(Math.min)},max:function(){return this.filter(isFinite).reduce(Math.max)},maxBy:n(function(n,t){return n>t}),minBy:n(function(n,t){return n<t}),mean:e=function(){return this.length?this.sum()/this.length:0},avg:e,sum:function(){var n,t,e,r,i;for(e=0,n=0,t=(r=this).length;n<t;n++)null!=(i=r[n])&&isFinite(i)&&(e+=i);return e},product:function(){return this.filter(isFinite).reduce(function(n){return n*this})},squares:function(){return this.pow(2)},pow:function(n){return this.map(function(){return Math.pow(this,n)})},magnitude:function(){return Math.sqrt(this.floats().squares().sum())},scale:function(n){return this.map(function(){return n*this})},add:t=function(n){var t;switch($.type(n)){case"number":return this.map(function(){return n+this});case"bling":case"array":return $(function(){var e,r,i;for(i=[],t=e=0,r=Math.min(this.length,n.length);0<=r?e<r:e>r;t=0<=r?++e:--e)i.push(this[t]+n[t]);return i}.call(this))}},plus:t,sub:r=function(n){var t;switch($.type(n)){case"number":return this.map(function(){return this-n});case"bling":case"array":return $(function(){var e,r,i;for(i=[],t=e=0,r=Math.min(this.length,n.length);0<=r?e<r:e>r;t=0<=r?++e:--e)i.push(this[t]-n[t]);return i}.call(this))}},minus:r,dot:function(n){var t;return $.sum(function(){var e,r,i;for(i=[],t=e=0,r=Math.min(this.length,n.length);0<=r?e<r:e>r;t=0<=r?++e:--e)i.push(this[t]*n[t]);return i}.call(this))},angle:function(n){return Math.acos(this.dot(n)/(this.magnitude()*n.magnitude()))},cross:function(n){return $(this[1]*n[2]-this[2]*n[1],this[2]*n[0]-this[0]*n[2],this[0]*n[1]-this[1]*n[0])},normalize:function(){return this.scale(1/this.magnitude())},deg2rad:function(){return this.filter(isFinite).map(function(){return this*Math.PI/180})},rad2deg:function(){return this.filter(isFinite).map(function(){return 180*this/Math.PI})}}}),$.plugin({depends:"function,hash",provides:"memoize"},function(){var n;return n=function(){var n;return n={},{has:function(t){return t in n},get:function(t){return n[t]},set:function(t,e){return n[t]=e}}},{$:{memoize:function(t){if($.is("function",t)&&(t={f:t}),!$.is("object",t))throw new Error("Argument Error: memoize requires either a function or object as first argument");return t.cache||(t.cache=n()),t.hash||(t.hash=$.hash),function(){var n;return n=t.hash(arguments),t.cache.has(n)?t.cache.get(n):t.cache.set(n,t.f.apply(this,arguments))}}}}}),$.plugin({provides:"middleware",depends:"type"},function(){return{$:{middleware:function(n){var t;return null==n&&(n=[]),t=$(),{catch:function(n){return t.push(n),this},use:function(t){return n.push(t),this},unuse:function(t){for(var e;(e=n.indexOf(t))>-1;)n.splice(e,1);return this},invoke:function(){var e,r,i;return e=1<=arguments.length?slice.call(arguments,0):[],r=-1,(i=function(u){return function(){var u;try{return n[++r].apply(n,slice.call(e).concat([i]))}catch(n){return u=n,t.call(u)}}}())(),this}}}}}}),$.plugin({depends:"core,function",provides:"promise"},function(){var n,t,e;return n=function(){function n(){}return n}(),e=function(t){var e,r,i,u,o,s,c,a,l,f;return t!==$.global&&null!==t&&void 0!==t||(t=this===$?{}:this),f=[],u=a=n,e=function(n,t){for(var e;e=f.shift();)r(e,n,t);return null},r=function(n,t,e){var r,i,u,o,s;null!=(s=n.timeout)&&s.cancel();try{n(t,e)}catch(t){u=t,o=$.debugStack(u),$.log("Promise("+l.promiseId+") first-chance exception:",o);try{n(u,null)}catch(n){r=n,i=$.debugStack(r),$.log("Promise("+l.promiseId+") last-chance exception:",i)}}return null},i=function(t){return function(r,o){if(u===a&&a===n)switch(r!==n?(u=r,(null!=r?r.stack:void 0)||(u=new Error(r))):o!==n&&(a=o),!0){case o===t:return i(new TypeError("cant resolve a promise with itself"));case null!=o&&o.then&&o.catch:o.then(function(n){return i(null,n)}),o.catch(function(n){return i(n,null)});break;case $.is("promise",o):o.wait(i);break;case r!==n:e(u,null);break;case o!==n:e(null,a)}return t}}(this),l=$.inherit({promiseId:$.random.string(6),wait:function(t,e){var i;return $.is("function",t)&&(e=(i=[t,Infinity])[0],t=i[1]),u!==n?r(e,u,null):a!==n?r(e,null,a):(f.push(e),isFinite(parseFloat(t))&&(e.timeout=$.delay(t,function(n){return function(){var n;if((n=f.indexOf(e))>-1)return f.splice(n,1),r(e,u=new Error("timeout"),void 0)}}()))),this},then:function(n,t){return this.wait(function(e,r){return e?"function"==typeof t?t(e):void 0:n(r)})},finish:function(t){return i(n,t),this},resolve:function(t){return i(n,t),this},fail:function(t){return i(t,n),this},reject:function(t){return i(t,n),this},reset:function(){return u=a=n,this},handler:function(n,t){return n?l.reject(n):l.resolve(t)},inspect:function(){return"{Promise["+this.promiseId+"] "+o()+"}"},toString:function(){return"{Promise["+this.promiseId+"] "+o()+"}"}},$.EventEmitter(t)),o=function(){switch(!1){case a===n:return"resolved";case u===n:return"rejected";default:return"pending"}},c=function(){return a!==n},$.defineProperty(l,"finished",{get:c}),$.defineProperty(l,"resolved",{get:c}),s=function(){return u!==n},$.defineProperty(l,"failed",{get:s}),$.defineProperty(l,"rejected",{get:s}),l},e.compose=e.parallel=function(){var n,t;return t=1<=arguments.length?slice.call(arguments,0):[],t=$(t).flatten(),n=$.Progress(1+t.length),$(t).select("wait").call(function(t){return t?n.reject(t):n.resolve(1)}),n.resolve(1)},e.collect=function(n){var t,e,r,i,u,o,s,c;if(c=[],u=$.Promise(),null==n)return u.resolve(c);for(s=$.Progress(1+n.length),t=function(n){return o.wait(function(t,e){return t?s.reject(t):s.resolve(1,c[n]=e)})},e=r=0,i=n.length;r<i;e=++r)o=n[e],t(e);return s.then(function(){return u.resolve(c)},u.reject),s.resolve(1),u},e.wrapCall=function(){var n,t,e;return t=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],e=$.Promise(),t.apply(null,slice.call(n).concat([function(n,t){return n?e.reject(n):e.resolve(t)}])),e},t=function(n){var t,r;return null==n&&(n=1),t=0,r=$.inherit({progress:function(){var e,i,u,o;return(e=1<=arguments.length?slice.call(arguments,0):[]).length?(t=null!=(u=e[0])?u:t,e.length>1&&(n=null!=(o=e[1])?o:n),i=e.length>2?e[2]:t,t>=n&&r.__proto__.__proto__.resolve(i),r.emit("progress",t,n,i),this):t},resolve:function(e,i){return null==i&&(i=e),isFinite(e)||(e=1),r.progress(t+e,n,i)},finish:function(n,t){return r.resolve(n,t)},include:function(e){return $.is("promise",e)&&(r.progress(t,n+1),e.wait(function(n,t){return n?r.reject(n):r.resolve(t)})),this},inspect:function(){return"{Progress["+r.promiseId+"] "+t+"/"+n+"}"}},e())},e.xhr=function(n){var t;return t=$.Promise(),n.onreadystatechange=function(){if(this.readyState===this.DONE)return 200===this.status?t.resolve(n.responseText):t.resolve(this.status+" "+this.statusText)},t},e.series=function(){var n,t,e;return e=1<=arguments.length?slice.call(arguments,0):[],e=$(e).flatten(),t=function(r){return function(){if(!(r>=e.length))return e[r]=e[r]().wait(function(i,u){return n.resolve(e[r]=[i,u]),$.immediate(t(r+1))})}},n=$.Progress(e.length),$.immediate(t(0)),n},$.depends("dom",function(){return e.image=function(n){var t,e;return e=$.Promise(),$.extend(t=new Image,{onerror:function(n){return e.reject(n)},onload:function(){return e.resolve(t)},src:n}),e}}),$.depends("type",function(){return $.type.register("promise",{is:function(n){return null!=n&&"object"==typeof n&&"then"in n&&"function"==typeof n.then&&2===n.then.length}})}),{$:{Promise:e,Progress:t}}}),$.plugin({provides:"prompt,confirm",depends:"synth,keyName"},function(){var n,t,e;return e=function(){if(!$("head .prompt").length)return $("head").append("<style class='prompt'>"+$.CSS.stringify({".prompt":{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:"999999",background:"rgba(0,0,0,.4)",fontSize:"12px"," input":{padding:"2px",margin:"0px 0px 4px -4px",width:"100%"}," button":{fontSize:"13px",".done":{fontSize:"14px"}}," > center":{width:"200px",height:"44px",margin:"20px auto",padding:"16px",background:"#ffc",borderRadius:"5px"}}})+"</style>")},t=function(n,t,r){var i,u,o,s,c;return e(),u=$.synth("div.prompt center\n\tinput[type="+t+"][placeholder="+n+"] + br +\n\tbutton.cancel 'Cancel' +\n\tbutton.done 'Done'").appendTo("body").first(),c=u.querySelector("input"),c.onkeydown=function(n){switch($.keyName(n.keyCode)){case"Enter":return o(c.value);case"Esc":return o(null)}},s=u.querySelector("button.done"),i=u.querySelector("button.cancel"),o=function(n){return delete s.onclick,delete i.onclick,u.parentNode.removeChild(u),r(n)},s.onclick=function(){return o(c.value)},i.onclick=function(){return o(null)},null},n=function(){var n,t,r,i,u,o,s,c,a;switch(n=1<=arguments.length?slice.call(arguments,0):[],r=n.pop(),s=n.shift(),t=n.length>0?n:{Yes:!0,No:!1},e(),u=$.synth("div.prompt center\n\tspan '"+s+"' + br").appendTo("body"),i=u.find("center"),$.type(t)){case"array":case"bling":for(o=0,c=t.length;o<c;o++)s=t[o],$.synth("button[value="+s+"] '"+s+"'").appendTo(i);break;case"object":for(s in t)a=t[s],$.synth("button[value="+a+"] '"+s+"'").appendTo(i)}return u.find("button").bind("click",function(n){return u.remove(),r(n.target.getAttribute("value"))}),null},{$:{prompt:t,confirm:n}}}),$.plugin({depends:"core",provides:"pubsub"},function(){var n,t,e,r,i,u;i={$:{Hub:n=function(){function n(){this.listeners={}}return n.prototype.publish=function(){var n,t,e,r,i,u,o,s,c;for(r=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],e=null,u=0,o=(c=(t=this.listeners)[r]||(t[r]=[])).length;u<o;u++)if(s=c[u],this.filter.apply(this,[s].concat(slice.call(n))))try{s.apply(null,n)}catch(n){i=n,null==e&&(e=i)}if(e)throw e;switch(n.length){case 0:return null;case 1:return n[0];default:return n}},n.prototype.filter=function(n,t){return!("patternObject"in n)||$.matches(n.patternObject,t)},n.prototype.publisher=function(n,t){var e;return e=this,function(){return e.publish(n,t.apply(this,arguments))}},n.prototype.subscribe=function(){var n,t,e,r;return e=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],r=n.pop(),n.length>0&&(r.patternObject=n.pop()),((t=this.listeners)[e]||(t[e]=[])).push(r),r},n.prototype.unsubscribe=function(n,t){var e,r,i;return null==t?this.listeners[n]=[]:(i=(e=(r=this.listeners)[n]||(r[n]=[])).indexOf(t))>-1&&e.splice(i,1),t},n}()}},u=new n,r=Object.getOwnPropertyDescriptors(n.prototype);for(t in r)e=r[t],"constructor"!==t&&"function"==typeof e.value&&(i.$[t]=e.value.bind(u));return i}),$.plugin({provides:"random",depends:"type"},function(){var n,t,e,r,i,u,o,s,c,a,l,f;return r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=Math.floor,n=Math.abs,o=Math.log,4294967295,l=new Uint32Array(2),s=function(){var n,t,e;return t=l[0],e=l[1],n=(t+e)%4294967295,e^=t,l[0]=t<<27|t>>>5^e^e<<7,l[1]=e<<18|e>>>14,n},c=function(){return s()/4294967295},$.defineProperty(c,"seed",{set:function(n){return l[0]=n,l[1]=1,s(),s(),s(),n}}),c.seed=+new Date,{$:{random:$.extend(c,{real:a=function(n,t){var e,r;return null==n&&(n=(e=[0,1])[0],t=e[1]),null==t&&(n=(r=[0,n])[0],t=r[1]),c()*(t-n)+n},integer:u=function(n,t){return i(a(n,t))},string:f=function(n,t,i){for(null==t&&(t=""),null==i&&(i=r);t.length<n;)t+=e(i);return t},coin:function(n){return null==n&&(n=.5),c()<=n},element:e=function(n,t){var e,r,i,o,s,a,l,f;if(null!=t)for(f=$(t),f=f.scale(1/f.sum()),e=0,a=$(n).map(function(n){return{v:n,w:f[e++]}}).sortBy(function(n){return-n.w}),s=c(),l=0,r=0,o=a.length;r<o;r++)if(i=a[r],(l+=i.w)>=s)return i.v;return n[u(0,n.length)]},gaussian:function(t,e){var r,i,u,s,a;for(null==t&&(t=.5),null==e&&(e=.12);;)if(i=c(),u=1.7156*(c()-.5),s=i-.449871,a=n(u)+.386595,!((r=s*s+a*(.196*a-.25472*s))>.27597&&(r>.27846||u*u>-4*o(i)*i*i)))break;return t+e*u/i},die:t=function(n){return u(1,n+1)},dice:function(n,e){return $(function(){var r,i,u;for(u=[],r=0,i=n;r<i;r+=1)u.push(t(e));return u}())},uuid:function(){return $(8,4,4,4,12).map(function(){return f(this,"","ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")}).join("-")}})}}}),$.plugin({provides:"render",depends:"promise, type, logger"},function(){var n,t,e,r,i,u,o,s,c;return $.logger("[render]"),r=function(n,t,e){return null==e&&(e=$.Promise()),$.is("promise",n)?(n.wait(function(n,i){var u;return n?e.reject(n):(u=o(i,t),$.is("promise",u)?r(u,t,e):e.resolve(u))}),e):$.Promise().resolve(o(n,t))},c=function(n,t){return null==t&&(t={}),r(o([n],t),t)},u={text:function(n,t){var e;return o(n[null!=(e=t.lang)?e:"EN"],t)}},c.register=s=function(n,t){return u[n]=t},c.reduce=o=function(n,t){var e;return(e=$.type.lookup(n)).reduce(n,e,t)},$.type.extend({unknown:{reduce:function(n,t,e){return"[ cant reduce type: "+t+" ]"}},string:{reduce:$.identity},html:{reduce:$.identity},null:{reduce:function(n,t,e){return t}},undefined:{reduce:function(n,t,e){return t}},number:{reduce:function(n,t,e){return String(n)}},function:{reduce:function(n,t,e){switch(f.length){case 0:case 1:return o(f(e));default:return $.Promise.wrap(f,e)}}},object:{reduce:function(n,t,e){var r;return(t=null!=(r=n.t)?r:n.type)in u?u[t].call(n,n,e):"[ no handler for object type: '"+t+"' "+JSON.stringify(n).substr(0,20)+"... ]"}},promise:{reduce:function(n,t,e){var r,i;return i=$.Promise(),n.wait(r=function(n,t){var u;return n?i.reject(n):$.is("promise",u=o(t,e))?u.wait(r):i.resolve(u)}),i}},array:{reduce:e=function(n,t,e){var r,u,s,c,a,l,f,h,p;for(h=$.Progress(l=1),p=$.Promise(),f=[],h.wait(function(n){return n?p.reject(n):p.resolve(i(f,e))}),u=!1,r=function(n,t){var r,i;if(f[t]=i=o(n,e),$.is("promise",i))return u=!0,h.progress(null,++l),i.wait(r=function(n,i){var u;return n?h.reject(n):(u=o(i,e),$.is("promise",u)?u.wait(r):h.resolve(f[t]=u))})},s=c=0,a=n.length;c<a;s=++c)r(n[s],s);return h.resolve(1),u?p:i(f)}},bling:{reduce:e}}),i=function(n,t){var e;return(e=$.type.lookup(n)).finalize(n,e,t)},$.type.extend({unknown:{finalize:function(n,t,e){return"[ cant finalize type: "+t+" ]"}},string:{finalize:$.identity},html:{finalize:$.identity},number:{finalize:function(n,t,e){return String(n)}},array:{finalize:t=function(n,t,e){var r;return function(){var t,u,o;for(o=[],t=0,u=n.length;t<u;t++)r=n[t],o.push(i(r,e));return o}().join("")}},bling:{finalize:t},null:{finalize:function(){return"null"}},undefined:{finalize:function(){return"undefined"}}}),n=function(n){return u[n]},s("link",function(n,t){var e;return["<a",function(){var t,r,i,u;for(u=[],t=0,r=(i=["href","name","target"]).length;t<r;t++)(e=i[t])in n&&u.push([" "+e+"='",n[e],"'"]);return u}(),">",o(n.content,t),"</a>"]}),s("a",n("link")),s("let",function(n,t){var e,r;return r=t[n.name],t[n.name]=n.value,e=o(n.content,t),void 0===r?delete t[n.name]:t[n.name]=r,e}),s("set",n("let")),s("get",function(n,t){return o(t[n.name],t)}),{$:{render:c}}}),$.plugin({provides:"sortBy,sortedIndex,sortedInsert,groupBy"},function(){return{$:{sortedIndex:function(n,t,e,r,i){var u,o;for(null==r&&(r=0),null==i&&(i=n.length),u=function(){switch(!0){case $.is("string",e):return function(n,t){return n[e]<t[e]};case $.is("function",e):return function(n,t){return e(n)<e(t)};default:return function(n,t){return n<t}}}();r<i;)u(n[o=i+r>>>1],t)?r=o+1:i=o;return r}},sortBy:function(n){var t,e,r,i,u;for(t=$(),e=0,i=(u=this).length;e<i;e++)r=u[e],t.sortedInsert(r,n);return t},sortedInsert:function(n,t){return 0===this.length?this.push(n):this.splice($.sortedIndex(this,n,t),0,n),this},groupBy:function(n){var t,e,r,i,u,o,s,c,a,l,f,h,p,d,g;switch(e={},$.type(n)){case"array":case"bling":for(r=0,s=(h=this).length;r<s;r++)g=h[r],(e[t=function(){var t,e,r;for(r=[],t=0,e=n.length;t<e;t++)u=n[t],r.push(g[u]);return r}().join(",")]||(e[t]=$())).push(g);break;case"string":for(i=0,c=(p=this).length;i<c;i++)(e[l=(g=p[i])[n]]||(e[l]=$())).push(g);break;case"function":for(o=0,a=(d=this).length;o<a;o++)g=d[o],(e[f=n(g)]||(e[f]=$())).push(g)}return $.valuesOf(e)}}}),$.plugin({provides:"StateMachine",depends:"type, logger"},function(){var n,t;return function(n,t,e){for(;"function"==typeof n;)n=n.call(t,e);return t.state=n},t={"\n":"n","\r":"r","\t":"t","\\":"\\","'":"'",'"':'"'},n=function(n){return n in t&&"\\"+t[n]||n},$.logger("[StateMachine]"),{$:{StateMachine:function(){function t(e,r){var i,u,o,s,c,a,l,f,h;null==r&&(r=!1),l="s=s|0;for(i=i|0;i<=d.length;i++){c=d[i]||'eof';"+(r&&"$.log('state:',s,'i:',i,'c:',c);"||"")+"switch(s){";for(h in e){"enter"in(f=e[h])?(a="p=s;",c="if(s!==p){"+(c=t.extractCode(f.enter,a))+";if(s!==p){i--;break}}"):c="",l+="case "+h+":"+c+((s=Object.keys(f).length>("enter"in f?1:0))&&"switch(c){"||"break;\n");for(i in f)u=f[i],"enter"!==i&&(l+="def"===i&&"default:"||"case '"+n(i)+"':",l+=t.extractCode(u,a)+";break;");l+=s&&"}break;"||""}l+="}}return this;";try{this.run=new Function("d","s","i","p","c",l)}catch(n){throw o=n,$.log("Failed to parse compiled machine: ",l),o}}return t.extractCode=function(n,t){var e,r;return null==t&&(t=""),null==n?"":(r=n.toString().replace(/^\s+/,"").replace(/\r/g,"##R##").replace(/\n/g,"##N##").replace(/\/\*(.*)\*\//g,"").replace(/\/\/(.*)(##N##|##R##)*/g,""),0===r.indexOf("function")?r=r.replace(/function[^{]*{\s*/,t):/\([^{]+ *=>\s*{/.test(r)&&(r=r.replace(/\([^{]+ *{\s*/,t)),null!=(e=r.replace(/return ([^;]+),(\d+)/,"$1;s=$2").replace("return ","s = ").replace(/\s*}$/,"").replace(/;*(##N##|##R##)\s*/g,";").replace(/##R##/g,"\r").replace(/##N##/g,"\n").replace(/^\s+/,"").replace(/\s+$/,"").replace(/\r|\n/g,""))?e:"")},t}()}}}),$.plugin({provides:"string",depends:"type"},function(){var n,t,e,r;return t=function(n){return function(){var t;t=1<=arguments.length?slice.call(arguments,0):[];try{return n.apply(null,t)}catch(n){return"[toString Error: "+n.message+"]"}}},n=function(n){return n.replace(/([^\\]{1})'/g,"$1\\'")},r=function(n){return String(n).replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"")},$.type.extend({unknown:{string:t(function(n){var t;return null!=(t="function"==typeof n.toString?n.toString():void 0)?t:String(n)}),repr:t(function(n){return $.type.lookup(n).string(n)}),number:t(function(n){return parseFloat(String(n))})},null:{string:function(){return"null"}},undefined:{string:function(){return"undefined"}},buffer:{string:t(function(n){return String(n)}),repr:t(function(n){return"Buffer("+JSON.stringify(n.toJSON())+")"})},string:{number:t(parseFloat),repr:function(t){return"'"+n(t)+"'"}},array:{string:t(function(n){return"["+n.map($.toString).join(", ")+"]"}),repr:t(function(n){return"["+n.map($.toRepr).join(", ")+"]"})},arguments:{string:t(function(n){var t;return"["+function(){var e,r,i;for(i=[],e=0,r=n.length;e<r;e++)t=n[e],i.push($.toString(t));return i}().join(", ")+"]"}),repr:t(function(n){var t;return"["+function(){var e,r,i;for(i=[],e=0,r=n.length;e<r;e++)t=n[e],i.push($.toRepr(t));return i}().join(", ")+"]"})},object:{string:t(function(n){var t,e,r;e=[];for(t in n){try{r=n[t]}catch(n){r="[Error: "+n.message+"]"}e.push(t+":"+$.toString(r))}return"{"+e.join(", ")+"}"}),repr:t(function(n){var t,e,r;e=[];for(t in n){try{r=n[t]}catch(n){r="[Error: "+n.message+"]"}e.push('"'+t+'": '+$.toRepr(r))}return"{"+e.join(", ")+"}"})},function:{repr:function(n){return n.toString()},string:function(n){return n.toString().replace(/^([^{]*){(?:.|\n|\r)*}$/,"$1{ ... }")}},number:{repr:function(n){return String(n)},string:t(function(n){switch(!1){case null==n.precision:return n.toPrecision(n.precision);case null==n.fixed:return n.toFixed(n.fixed);default:return String(n)}})}}),{$:{toString:function(n){if(0===arguments.length)return"function Bling() { [ ... ] }";try{return $.type.lookup(n).string(n)}catch(n){return"[$.toString Error: "+n.message+"]"}},toRepr:function(n){return $.type.lookup(n).repr(n)},px:function(n,t){return null==t&&(t=0),null!=n&&parseInt(n,10)+(0|parseInt(t))+"px"},capitalize:function(n){return n.split(" ").map(function(n){return n[0].toUpperCase()+n.substring(1).toLowerCase()}).join(" ")},slugize:e=function(n,t){var e,r;return null==t&&(t="-"),(n=function(){switch($.type(n)){case"null":case"undefined":return"";case"object":return function(){var i;i=[];for(e in n)r=n[e],i.push($.slugize(e,t)+t+$.slugize(r,t));return i}().join(t);case"array":case"bling":return n.map(function(n){return $.slugize(n,t)}).join(t);default:return String(n)}}()).toLowerCase().replace(/^\s+/,"").replace(/\s+$/,"").replace(/\t/g," ").replace(/[^A-Za-z0-9. -]/g,"").replace(/\s+/g,"-")},stubize:e,dashize:function(n){var t,e,r,i,u;for(u="",e=r=0,i=0|(null!=n?n.length:void 0);0<=i?r<i:r>i;e=0<=i?++r:--r)91>(t=n.charCodeAt(e))&&t>64&&(t+=32,u+="-"),u+=String.fromCharCode(t);return u},camelize:function(n){var t;for((n=$.slugize(n)).split("-");(t=null!=n?n.indexOf("-"):void 0)>-1;)n=$.stringSplice(n,t,t+2,n[t+1].toUpperCase());return n},commaize:function(n,t,e,r){var i,u,o,s,c;return null==t&&(t=","),null==e&&(e="."),null==r&&(r=""),$.is("number",n)&&isFinite(n)?(s=String(n),c=n<0?"-":"",o=s.split("."),i=o[0],u=o[1],i.length>3&&(i=$.stringReverse($.stringReverse(i).match(/\d{1,3}/g).join(t))),c+r+i+(null!=u?e+u:"")):"number"==typeof n&&isNaN(n)||Infinity===n||-Infinity===n?String(n):void 0},padLeft:function(n,t,e){var i;return null==e&&(e=" "),i=t-r(n).length,i>0?$.zeros(i,e).join("")+n:n},padRight:function(n,t,e){var i;return null==e&&(e=" "),i=t-r(n).length,i>0?n+$.zeros(i,e).join(""):n},stringTruncate:function(n,t,e,r){var i,u;if(null==e&&(e="..."),null==r&&(r=" "),n.length<=t)return n;if(e.length>=t)return e;for(n=n.split(r),i=[];t>0;)(t-=(u=n.shift()).length)>=0&&i.push(u);return i.join(r)+e},stringCount:function(n,t,e,r){var i;return null==e&&(e=0),null==r&&(r=0),(i=n.indexOf(t,e))>e-1?$.stringCount(n,t,i+1,r+1):r},stringSplice:function(n,t,e,r){var i,u,o;return u=n.length,(i=e)<0&&(i+=u),(o=t)<0&&(o+=u),n.substring(0,o)+r+n.substring(i)},stringReverse:function(n){return n.split("").reverse().join("")},checksum:function(n){var t,e,r,i,u;for(t=1,e=0,r=i=0,u=n.length;0<=u?i<u:i>u;r=0<=u?++i:--i)e=(e+(t=(t+n.charCodeAt(r))%65521))%65521;return e<<16|t},repeat:function(n,t){switch(null==t&&(t=2),!1){case 1!==t:return n;case!(t<1):return"";case!$.is("string",n):return $.zeros(t,n).join("");default:return $.zeros(t,n)}},stringBuilder:function(){var n;return n=function(n){return 0|(null!=n?n.toString().length:void 0)},function(){var t;return $.is("global",this)?new $.stringBuilder:(t=[],$.extend(this,{length:0,append:function(e){return function(r){return t.push(r),e.length+=n(r)}}(this),prepend:function(e){return function(r){return t.splice(0,0,r),e.length+=n(r)}}(this),clear:function(n){return function(){var e;return e=n.toString(),t=[],n.length=0,e}}(this),toString:function(){return t.join("")}}))}}()},toString:function(){return $.toString(this)},toRepr:function(){return $.toRepr(this)},replace:function(n,t){return this.map(function(e){return e.replace(n,t)})},indexOf:function(n,t){var e,r,i;if(null==t&&(t=0),$.is("regexp",n)){for(e=r=t,i=this.length;r<i;e=r+=1)if(n.test(this[e]))return e;return-1}return Array.prototype.indexOf.apply(this,arguments)}}}),$.plugin({provides:"symbol",depends:"type"},function(){var n,t,e;return e=null,n={},t=$.global,t.Bling=$,"undefined"!=typeof module&&null!==module&&(module.exports=$),$.defineProperty($,"symbol",{set:function(r){return t[e]=n[e],n[e=r]=t[r],t[r]=Bling},get:function(){return e}}),{$:{symbol:"$",noConflict:function(){return $.symbol="Bling",Bling}}}}),$.plugin({provides:"synth",depends:"StateMachine, type, dom"},function(){var n,t;return n=function(n){function t(n){null==n&&(n=!1),t.__super__.constructor.call(this,[{enter:function(){return this.tag=this.id=this.cls=this.attr=this.val=this.text="",this.attrs={},1}},u({def:function(n){return this.tag+=n,1}},e),u({def:function(n){return this.id+=n,2}},e),u({def:function(n){return this.cls+=n,3}},e,{enter:function(){return this.cls+=this.cls.length&&" "||"",3},".":function(){return this.cls+=" ",3}}),u({def:function(n){return this.attr+=n,4}},i,{"=":function(){return 5},"]":function(){return this.attrs[this.attr]=this.val,this.attr=this.val="",1}}),u({def:function(n){return this.val+=n,5}},i,{"]":function(){return this.attrs[this.attr]=this.val,this.attr=this.val="",1}}),u({def:function(n){return this.text+=n,6}},i,{"\\":function(){return 8},'"':function(){return this.emitText()}}),u({def:function(n){return this.text+=n,7}},i,{"\\":function(){return 9},"'":function(){return this.emitText()}}),u({def:function(n){return this.text+=n,6}},i),u({def:function(n){return this.text+=n,7}},i)],n),this.reset()}var e,r,i,u;return extend1(t,n),e={"#":function(){return 2},".":function(){return 3},"[":function(){return 4},'"':function(){return 6},"'":function(){return 7}," ":function(){return this.emitText()},"\t":function(){return this.emitText()},"\n":function(){return this.emitText()},"\r":function(){return this.emitText()},",":function(){return this.emitNodeAndReparent(this.fragment)},"+":function(){var n;return this.emitNodeAndReparent(null!=(n=this.cursor.parentNode)?n:this.fragment)},eof:function(){return this.emitText()}},i={eof:function(){return this.emitError("Unexpected end of input")}},u=function(){var n;return n=1<=arguments.length?slice.call(arguments,0):[],$.extend.apply($,n)},t.prototype.reset=function(){return this.fragment=this.cursor=document.createDocumentFragment(),this.tag=this.id=this.cls=this.attr=this.val=this.text="",this.attrs={},this},t.prototype.emitError=function(n){throw new Error(n+": "+this.input)},t.prototype.emitNodeAndReparent=function(n){var t,e,r,i,u,o,s;if((null!=(r=this.tag)?r.length:void 0)>0){e=document.createElement(this.tag),(null!=(i=this.id)?i.length:void 0)>0&&(e.id=this.id),(null!=(u=this.cls)?u.length:void 0)>0&&(e.className=this.cls),this.cursor.appendChild(e),o=this.attrs;for(t in o)s=o[t],e.setAttribute(t,s)}return this.cursor=e&&(n||e)||n||this.cursor,0},r=$.type.lookup("<html>"),t.prototype.emitText=function(){var n;return this.emitNodeAndReparent(),(null!=(n=this.text)?n.length:void 0)&&this.cursor.appendChild(r.node(this.text)||(this.text="")),0},t}($.StateMachine),t=new n,{$:{synth:function(n){var e;return e=t.reset().run(n,0).fragment,$(1===e.childNodes.length?e.childNodes[0]:e)}}}}),$.plugin({depends:"StateMachine, function",provides:"template"},function(){var n,t,e,r;return n=null,t={},(r={register_engine:function(e,r){if(t[e]=r,null==n)return n=e},render:function(e,r){if(n in t)return t[n](e,r)}}).__defineSetter__("engine",function(e){if(!e in t)throw new Error("invalid template engine: "+e+" not one of "+Object.Keys(t));return n=e}),r.__defineGetter__("engine",function(){return n}),r.__defineGetter__("engines",function(){return $.keysOf(t)}),r.register_engine("null",function(){return $.identity}()),e=function(n,t,e,r,i){var u,o,s,c,a;for(null==i&&(i=-1),u=1,i<0&&(i=n.length+1+i),o=s=r,c=i;s<c;o=s+=1)if(a=n[o],a===e?u+=1:a===t&&(u-=1),0===u)return o;return-1},r.register_engine("pythonic",function(){var n,t,r;return r=/([0-9#0+-]*)\.*([0-9#+-]*)([diouxXeEfFgGcrsqm])((?:.|\n)*)/,n=/%[\(\/]/,t=function(t){var i,u,o,s,c,a,l,f,h,p,d;for(f=(i=t.split(n)).length,d=[i[0]],c=1,o=s=1,h=f;s<h;o=s+=1){if(-1===(u=e(i[o],")","(",0,-1)))return"Template syntax error: unmatched '%(' starting at: "+i[o].substring(0,15);if(a=i[o].substring(0,u),p=i[o].substring(u),null===(l=r.exec(p)))return"Template syntax error: invalid type specifier starting at '"+p+"'";p=l[4],d[c++]=a,d[c++]=0|l[1],d[c++]=0|l[2],d[c++]=l[3],d[c++]=p}return d},t.cache={},function(n,e){var r,i,u,o,s,c,a,l,f,h,p,d,g;for(null==(r=t.cache[n])&&(r=t.cache[n]=t(n)),a=[r[0]],s=1,u=o=1,f=r.length-5;o<=f;u=o+=5)c=(h=r.slice(u,+(u+4)+1||9e9))[0],l=h[1],i=h[2],d=h[3],p=h[4],null==(g=e[c])&&(g="missing value: "+c),a[s++]=function(){switch(d){case"d":return""+parseInt(g,10);case"f":return parseFloat(g).toFixed(i);case"s":default:return""+g}}(),l>0&&(a[s]=$.padLeft(a[s],l)),a[s++]=p;return a.join("")}}()),{$:{template:r}}}),$.plugin({provides:"throttle",depends:"core"},function(){var n,t;return n=function(n,t,e,r,i){return clearTimeout(i),i=setTimeout(function(r){return function(){return n.apply(t,e)}}(),r)},t=function(n,t,e,r,i){var u;return(u=$.now-i)>r&&(i+=u,n.apply(t,e)),i},{$:{throttle:function(n,e){var r;return r=0,function(){return r=t(e,this,arguments,n,r),null}},debounce:function(t,e){var r;return r=null,function(){return arguments,r=n(e,this,arguments,t,r),null}},rate_limit:function(e,r){var i,u;return i=0,u=null,function(){return arguments,u=n(r,this,arguments,e,u),i=t(r,this,arguments,e,i),null}}}}}),$.plugin({provides:"TNET",depends:"type, string, function"},function(){var Types,class_index,classes,makeFunction,packOne,packingStack,register,reverseLookup,unpackOne,unpackingStack;return Types={number:{symbol:"#",pack:String,unpack:Number},string:{symbol:"'",pack:$.identity,unpack:$.identity},bool:{symbol:"!",pack:function(n){return String(!!n)},unpack:function(n){return"true"===n}},null:{symbol:"~",pack:function(){return""},unpack:function(){return null}},undefined:{symbol:"_",pack:function(){return""},unpack:function(){}},array:{symbol:"]",pack:function(n){var t;return function(){var e,r,i;for(i=[],e=0,r=n.length;e<r;e++)t=n[e],i.push(packOne(t));return i}().join("")},unpack:function(n){var t,e,r;for(t=[],unpackingStack.push(t);n.length>0;)e=(r=unpackOne(n))[0],n=r[1],t.push(e);return unpackingStack.pop(),t}},map:{symbol:"M",pack:function(n){var t;return t="",n.forEach(function(n,e){return t+=packOne(e)+packOne(n)}),t},unpack:function(n){var t,e,r,i,u;for(e=new Map,unpackingStack.push(e);n.length>0;)t=(r=unpackOne(n))[0],n=r[1],u=(i=unpackOne(n))[0],n=i[1],e.set(t,u);return unpackingStack.pop(),e}},bling:{symbol:"$",pack:function(n){var t;return function(){var e,r,i;for(i=[],e=0,r=n.length;e<r;e++)t=n[e],i.push(packOne(t));return i}().join("")},unpack:function(n){var t,e,r;for(t=$(),unpackingStack.push(t);n.length>0;)e=(r=unpackOne(n))[0],n=r[1],t.push(e);return unpackingStack.pop(),t}},object:{symbol:"}",pack:function(n){var t,e;return function(){var r;r=[];for(t in n)e=n[t],"constructor"!==t&&n.hasOwnProperty(t)&&r.push(packOne(t)+packOne(e));return r}().join("")},unpack:function(n){var t,e,r,i,u;for(t={},unpackingStack.push(t);n.length>0;)e=(r=unpackOne(n))[0],n=r[1],u=(i=unpackOne(n))[0],n=i[1],t[e]=u;return unpackingStack.pop(),t}},function:{symbol:")",pack:function(n){var t,e,r,i,u,o;return o=n.toString().replace(/(?:\n|\r)+\s*/g," "),r="",(i=/function\s*(\w+)\(.*/g).test(o)&&(r=o.replace(i,"$1")),u=o.replace(/function\s*\w*\(/,"").replace(/\/\*.*\*\//g,"").replace(/}$/,"").split(/\) {/),t=u[0].split(/, */),e=u.slice(1).join(") {").replace(/^\s+/,"").replace(/\s*$/,""),$(r,t,e).map(packOne).join("")},unpack:function(n){var t,e,r,i,u,o,s;r=(i=unpackOne(n))[0],s=i[1],t=(u=unpackOne(s))[0],s=u[1],e=(o=unpackOne(s))[0],s=o[1];try{return makeFunction(r,t.join(),e)}catch(n){return n,$.log("Failed to makeFunction."),$.log("Arguments:",t.join()),$.log("Body:",e)}}},regexp:{symbol:"/",pack:function(n){return String(n).slice(1,-1)},unpack:function(n){return RegExp(n)}},class:{symbol:"{",pack:function(n){return[Types.function.pack(n),packOne(n.prototype,"object")].join("")},unpack:function(s){var f,ref,ref1,rest;return ref=unpackOne(s),s=ref[0],rest=ref[1],f=eval(s),ref1=unpackOne(rest),f.prototype=ref1[0],rest=ref1[1],f}},"class instance":{symbol:"C",pack:function(n){var t;if(!("constructor"in n))throw new Error("TNET: cant pack non-class as class");if(!(n.constructor in class_index))throw new Error("TNET: cant pack unregistered class (name: "+n.constructor.name+")");return t=packOne(class_index[n.constructor]),packingStack.pop(),t+packOne(n,"object")},unpack:function(n){var t,e,r,i,u;if(r=unpackOne(n),t=r[0],u=r[1],i=unpackOne(u),e=i[0],u=i[1],!(t<=classes.length))throw unpackingStack.splice(0,unpackingStack.length),new Error("TNET: attempt to unpack unregistered class index: "+t);return e.__proto__=classes[t-1].prototype,e}},"circular reference":{symbol:"@",pack:function(n){return String(n)},unpack:function(n){return unpackingStack[parseInt(n,10)]}}},makeFunction=function(name,args,body){return eval("var f = function "+name+"("+args+"){"+body+"}"),f},classes=[],class_index={},register=function(n){return class_index[n]||(class_index[n]=classes.push(n))},reverseLookup={},function(){var n,t,e;n=[];for(t in Types)e=Types[t],n.push(reverseLookup[e.symbol]=e)}(),unpackingStack=[],unpackOne=function(n){var t,e,r,i,u;return n&&(e=n.indexOf(":"))>0&&(t=parseInt(n.slice(0,e),10),isFinite(t)&&$.is("number",t)&&e<(r=u=e+1+t)&&r<n.length&&(i=reverseLookup[n[u]]))?[i.unpack(n.slice(e+1,u)),n.slice(u+1)]:[void 0,n]},packingStack=[],packOne=function(n,t){var e,r,i,u,o,s,c,a;if("unknown"===(a=null!=t?t:$.type(n))&&void 0!==(u=null!=(o=n.constructor)?o.name:void 0)&&"Object"!==u&&(a="class instance"),null==(c=Types[a]))throw packingStack.splice(0,packingStack.length),new Error("TNET: I don't know how to pack type '"+a+"' ("+(null!=(s=n.constructor)?s.name:void 0)+")");(i=packingStack.indexOf(n))>-1&&(c=Types["circular reference"],n=i),packingStack.push(n);try{e=c.pack(n)}catch(n){throw r=n,packingStack.splice(0,packingStack.length),r}return packingStack.pop(),e.length+":"+e+c.symbol},{$:{TNET:{Types:Types,registerClass:register,stringify:packOne,parse:function(n){var t;return null!=(t=Bling.TNET.parseOne(n))?t[0]:void 0},parseOne:function(n){return Buffer.isBuffer(n)&&(n=n.toString()),unpackOne(n)}}}}}),$.plugin({provides:"trace",depends:"function,type,logger"},function(){var n;return $.type.extend({unknown:{trace:$.identity},object:{trace:function(n,t,e){var r,i,u,o;for(r=0,u=(o=Object.keys(t)).length;r<u;r++)t[i=o[r]]=$.trace(t[i],n+"."+i,e);return t}},array:{trace:function(n,t,e){var r,i,u;for(r=i=0,u=t.length;i<u;r=i+=1)t[r]=$.trace(t[r],n+"["+r+"]",e);return t}},bling:{trace:function(n,t,e){var r,i,u;for(r=i=0,u=t.length;i<u;r=i+=1)t[r]=$.trace(t[r],n+"["+r+"]",e);return t}},function:{trace:function(n,t,e){var r;return n||(n=t.name),r=function(){var r,i,u,o;return r=1<=arguments.length?slice.call(arguments,0):[],o=+new Date,t.apply(this,r),n=(this.name||$.type(this))+"."+n,i=$(r).map($.toRepr).join(","),u=(+new Date-o).toFixed(0),e(n+"("+i+"): "+u+"ms")},r.toString=function(){return"{Trace '"+n+"' of "+t.toString()},r}}}),n=function(n,t,e){var r,i,u;return $.is("string",n)||(t=(r=[n,t,"trace"])[0],e=r[1],n=r[2]),$.is("function",e)||(e=$.log),u=+new Date,i=t(),e("["+n+"] "+(+new Date-u).toFixed(0)+"ms"),i},{$:{time:n,trace:function(n,t,e){var r;return $.is("string",n)||(e=(r=[t,n])[0],t=r[1]),e||(e=$.log),n||(n=""),$.type.lookup(t).trace(n,t,e)}}}}),$.plugin({depends:"dom"},function(){var n,t,e,r,i,u,o;return", ",t={slow:700,medium:500,normal:300,fast:100,instant:0,now:0},n=/(?:scale(?:3d)*|translate(?:[XYZ]|3d)*|rotate(?:[XYZ]|3d)*)/,30,e=document.createElement("div").style,r="transform",u="transition-property",i="transition-duration",o="transition-timing-function","WebkitTransform"in e?(r="-webkit-transform",u="-webkit-transition-property",i="-webkit-transition-duration",o="-webkit-transition-timing-function"):"MozTransform"in e?(r="-moz-transform",u="-moz-transition-property",i="-moz-transition-duration",o="-moz-transition-timing-function"):"OTransform"in e&&(r="-o-transform",u="-o-transition-property",i="-o-transition-duration",o="-o-transition-timing-function"),{$:{duration:function(n){var e;return e=t[n],null!=e?e:parseFloat(n)}},transform:function(t,e,s,c){var a,l,f,h,p,d;$.is("function",e)?(c=e,e=s=null):$.is("function",s)&&(c=s,s=null),null==e&&(e="normal"),s||(s="ease"),l=$.duration(e)+"ms",p=[],d="",a={};for(f in t)n.test(f)?((h=t[f]).join?h=$(h).px().join(", "):h.toString&&(h=h.toString()),d+=" "+f+"("+h+")"):a[f]=t[f];for(f in a)p.push(f);if(d&&p.push(r),a[u]=p.join(", "),a[i]=p.map(function(){return l}).join(", "),a[o]=p.map(function(){return s}).join(", "),d&&(a[r]=d),this.css(a),c)return this.delay(l,$.bound(this,c))},hide:function(n){return this.each(function(){if(this.style)return this._display="",!1===this.style.display&&(this._display=this.syle.display),this.style.display="none"}).trigger("hide"),n&&this.delay(30,$.bound(this,n)),this},show:function(n){return this.each(function(){if(this.style)return this.style.display=this._display,delete this._display}).trigger("show"),n&&this.delay(30,$.bound(this,n)),this},toggle:function(n){return this.weave(this.css("display")).fold(function(n,t){return"none"===n?(t.style.display=t._display||"",delete t._display,$(t).trigger("show")):(t._display=n,t.style.display="none",$(t).trigger("hide")),t}).delay(30,$.bound(this,n))},fadeIn:function(n,t){return this.css("opacity","0.0").show(function(){return this.transform({opacity:"1.0",translate3d:[0,0,0]},n,t)})},fadeOut:function(n,t,e,r){return null==e&&(e=0),null==r&&(r=0),this.transform({opacity:"0.0",translate3d:[e,r,0]},n,function(){return this.hide($.bound(this,t))})},fadeLeft:function(n,t){return this.fadeOut(n,t,"-"+this.width().first(),0)},fadeRight:function(n,t){return this.fadeOut(n,t,this.width().first(),0)},fadeUp:function(n,t){return this.fadeOut(n,t,0,"-"+this.height().first())},fadeDown:function(n,t){return this.fadeOut(n,t,0,this.height().first())}}}),$.plugin({provides:"Trie"},function(){var n;return n=function(){function n(){this.length=0}var t,e;return n.prototype.insert=function(n,t){return null==t&&(t=String(n)),e(this,n,t.toLowerCase(),0)},e=function(t,r,i,u){var o,s;return t.length++,u<i.length?(s=t.children||(t.children={}),e(s[o=i[u]]||(s[o]=new n),r,i,u+1)):(t.values||(t.values=[])).push(r),t},n.prototype.find=function(n){return t(this,n.toLowerCase(),0)},t=function*(n,e,r){var i,u,o,s,c,a,l,f;if((o=r>=e.length)&&n.values)for(s=0,c=(a=n.values).length;s<c&&(f=a[s],!1!==(yield f));s++);else{l=n.children;for(i in l)u=l[i],(o||i===e[r])&&(yield*t(u,e,r+1))}return null},n}(),{$:{Trie:n}}}),$.plugin({provides:"type,is,inherit,extend,defineProperty,isType,are,as,isSimple,isDefined,isEmpty",depends:"compat"},function(){var n,t,e,r;return n=Object.prototype.toString,r=function(t,e){return null==e?t===e||"null"===t||"undefined"===t:null!=e.constructor&&(e.constructor===t||e.constructor.name===t)||n.apply(e)==="[object "+t+"]"||r(t,e.__proto__)},e=function(){var n,t,r,i;if(r=arguments[0],(t=2<=arguments.length?slice.call(arguments,1):[]).length>0)return n=t.shift(),"function"==typeof r&&(r=r.prototype),(i=r.__proto__)!==Object.prototype&&null!==i&&void 0!==i||(r.__proto__=n.__proto__),n.__proto__=r,t.length>0?e.apply(null,[n].concat(slice.call(t))):n},(t=function(){var n,t,i,u,o,s,c,a;return o={},u={name:"unknown",is:function(){return!0}},c=[],t={},i=function(n,e){var r;if(r=t[n]||(t[n]=[]),-1===r.indexOf(e))return r.push(e)},a=function(t,r){var s;if(r.is||(r.is=function(){return!1}),t in o)return n(t,r);t in o||c.unshift(t),o[r.name=t]=u!==r?e(u,r):r,o[t][t]=function(n){return n};for(s in o[t])i(s,o[t]);return o[t]},n=function(t,e){var r,u;if("string"==typeof t){o[t]||(o[t]=a(t,{})),o[t]=extend(o[t],e);for(u in e)i(u,o[t])}else if("object"==typeof t)for(r in t)n(r,t[r]);return null},s=function(n){var t,e,r;for(t=0,e=c.length;t<e;t++)if(r=c[t],o[r].is.call(n,n))return o[r];return null},a("unknown",u),a("object",{is:function(n){var t,e;return null!=n&&"object"==typeof n&&(void 0===(t=null!=(e=n.constructor)?e.name:void 0)||"Object"===t)}}),a("array",{is:Array.isArray||function(n){return r(Array,n)}}),a("map",{is:function(n){return n&&n instanceof Map}}),a("buffer",{is:$.global.Buffer.isBuffer||function(){return!1}}),a("error",{is:function(n){return r("Error",n)}}),a("regexp",{is:function(n){return r("RegExp",n)}}),a("string",{is:function(n){return"string"==typeof n}}),a("number",{is:function(n){return"number"==typeof n&&!isNaN(n)}}),a("bool",{is:function(n){return"boolean"==typeof n}}),a("function",{is:function(n){return"function"==typeof n}}),a("class",{is:function(n){var t;return"function"==typeof n&&"prototype"in(t=Object.getOwnPropertyDescriptors(n))&&!("arguments"in t)}}),a("global",{is:function(n){return"object"==typeof n&&"setInterval"in n}}),a("arguments",{is:function(n){return"object"==typeof n&&"callee"in n&&"length"in n}}),a("undefined",{is:function(n){return void 0===n}}),a("null",{is:function(n){return null===n}}),extend(function(n){return s(n).name},{register:a,lookup:s,extend:n,get:function(n){return o[n]},is:function(n,t){var e,r;return null!=(e=null!=(r=o[n])?r.is.call(t,t):void 0)&&e},as:function(){var n,t,e,r;return r=arguments[0],t=arguments[1],e=3<=arguments.length?slice.call(arguments,2):[],"function"==typeof(n=s(t))[r]?n[r].apply(n,[t].concat(slice.call(e))):void 0},with:function(n){var e;return null!=(e=t[n])?e:[]}})}()).extend({unknown:{array:function(n){return[n]}},null:{array:function(){return[]}},undefined:{array:function(){return[]}},array:{array:function(n){return n}},number:{array:function(n){return $.extend(new Array(n),{length:0})}},arguments:{array:function(n){return Array.prototype.slice.apply(n)}}}),4294967295,t.register("bling",{is:function(n){return n&&r($,n)},array:function(n){return n&&n.toArray()||[]},hash:function(n){return n.map($.hash).reduce(function(n,t){return(n*n+t)%4294967295})},string:function(n){return $.symbol+"(["+n.map(function(n){return $.type.lookup(n).string(n)}).join(", ")+"])"},repr:function(n){return $.symbol+"(["+n.map(function(n){return $.type.lookup(n).repr(n)}).join(", ")+"])"}}),t.in=function(){var n,t,e,r,i,u;for(u=2<=arguments.length?slice.call(arguments,0,n=arguments.length-1):(n=0,[]),r=arguments[n++],t=0,e=u.length;t<e;t++)if(i=u[t],$.is(i,r))return!0;return!1},{$:{inherit:e,extend:extend,defineProperty:function(n,t,e){return Object.defineProperty(n,t,extend({configurable:!0,enumerable:!0},e)),n},isType:r,type:t,is:t.is,are:function(){var n,t,e,r,i;for(i=arguments[0],e=0,r=(t=2<=arguments.length?slice.call(arguments,1):[]).length;e<r;e++)if(n=t[e],!$.is(i,n))return!1;return!0},as:t.as,isDefined:function(n){return null!=n},isSimple:function(n){return t.in("string","number","bool",n)},isEmpty:function(n){return""===n||null===n||void 0===n||0===n.length||"object"==typeof n&&0===Object.keys(n).length}},defineProperty:function(n,t){return this.each(function(){return $.defineProperty(this,n,t)})}}}),$.plugin({depends:"math",provides:"units"},function(){var n,t,e,r,i,u,o,s,c,a;return a=$(["px","pt","pc","em","%","in","cm","mm","ex","lb","kg","yd","ft","m",""]),n=null,(o=function(){var t;return t=a.filter(/.+/).join("|"),n=new RegExp("(\\d+\\.*\\d*)((?:"+t+")/*(?:"+t+")*)$")})(),s=function(t){return n.test(t)?n.exec(t)[2]:""},t=function(n,e){var r,i,u,o,s,c;return s=n.split("/"),u=s[0],r=s[1],c=e.split("/"),o=c[0],i=c[1],null!=r&&null!=i?t(i,r)*t(u,o):n in t&&e in t[n]?t[n][e]():0},u=function(n){return function(){return n}},r=function(){},c=function(n,e,i){return t[n]||(t[n]={}),t[n][e]=i,-1===a.indexOf(n)&&a.push(n),-1===a.indexOf(e)&&a.push(e),o(),r()},i=function(){return $.type.register("units",{is:function(t){return"string"==typeof t&&n.test(t)},number:function(n){return parseFloat(n)},string:function(n){return"'"+n+"'"}}),c("pc","pt",function(){return 12}),c("in","pt",function(){return 72}),c("in","px",function(){return 96}),c("in","cm",function(){return 2.54}),c("m","ft",function(){return 3.281}),c("yd","ft",function(){return 3}),c("cm","mm",function(){return 10}),c("m","cm",function(){return 100}),c("m","meter",function(){return 1}),c("m","meters",function(){return 1}),c("ft","feet",function(){return 1}),c("km","m",function(){return 1e3}),c("em","px",function(){var n,t;n=0;try{n=(t=$("<span style='font-size:1em;visibility:hidden'>x</span>").appendTo("body")).width().first(),t.remove()}catch(n){}return n}),c("ex","px",function(){var n,t;n=0;try{n=(t=$("<span style='font-size:1ex;visibility:hidden'>x</span>").appendTo("body")).width().first(),t.remove()}catch(n){}return n}),c("ex","em",function(){return 2}),c("rad","deg",function(){return 57.3}),c("s","sec",function(){return 1}),c("s","ms",function(){return 1e3}),c("ms","ns",function(){return 1e6}),c("min","sec",function(){return 60}),c("hr","min",function(){return 60}),c("hr","hour",function(){return 1}),c("hr","hours",function(){return 1}),c("day","hr",function(){return 24}),c("day","days",function(){return 1}),c("y","year",function(){return 1}),c("y","years",function(){return 1}),c("y","d",function(){return 365.25}),c("g","gram",function(){return 1}),c("g","grams",function(){return 1}),c("kg","g",function(){return 1e3}),c("lb","g",function(){return 453.6}),c("lb","oz",function(){return 16}),c("f","frame",function(){return 1}),c("f","frames",function(){return 1}),c("sec","f",function(){return 60}),(r=function(){var n,e,r,i,o,s,c,l,f,h,p,d,g;for(t[""]={},g=u(1),i=0,f=a.length;i<f;i++)n=a[i],t[n]||(t[n]={}),t[n][n]=t[n][""]=t[""][n]=g;for(o=1;o>0;)for(o=0,s=0,h=a.length;s<h;s++)if(""!==(n=a[s]))for(t[n]||(t[n]={}),c=0,p=a.length;c<p;c++)if(""!==(e=a[c]))for(!t(n,e)&&t(e,n)&&(t[n][e]=u(1/t(e,n)),o+=1),l=0,d=a.length;l<d;l++)""!==(r=a[l])&&t(n,e)&&t(e,r)&&!t(n,r)&&(t[n][r]=u(t(n,e)*t(e,r)),o+=1);return null})(),$.units.enable=function(){}},e=function(n,e){var r,i,u;return i=parseFloat(e),u=s(e),r=t(u,n),isFinite(r)&&isFinite(i)?""+i*r+n:e},{$:{units:{enable:i,set:c,get:t,convertTo:e}},convertTo:function(n){return this.map(function(t){return e(n,t)})},unitMap:function(n){return this.map(function(t){var e;return n.call(e=parseFloat(t),e)+s(t)})}}}),$.plugin({depends:"type",provides:"url,URL"},function(){var n,t,e,r,i,u,o,s;return u=/\b(?:([a-z+]+):)(?:\/{1,2}([^?\/#]*?))(\/[^?]*)*(?:\?([^#]+))*(?:#([^\s]+))*$/i,o=/^([^:]+):([^@]+)@/,s=/^([^:@]+)@/,t=/^([^:]+):(\d+)/,r=function(n){var e,i;return null!=n&&n.length>0?(i={host:n},i.host.indexOf(",")>-1?$.extend(i,{hosts:i.host.split(",").map(r),host:void 0}):((e=i.host.match(o))?$.extend(i,{username:e[1],password:e[2],host:i.host.replace(o,"")}):(e=i.host.match(s))&&$.extend(i,{username:e[1],host:i.host.replace(s,"")}),(e=i.host.match(t))&&$.extend(i,{host:e[1],port:e[2]})),i):{}},e=function(n,t){var e,i,o,s,c,a,l,f,h,p,d;if(null==t&&(t=!1),null!=(d=(s=null!=n?n.match(u):void 0)?{protocol:s[1],host:s[2],path:s[3],query:null!=(l=s[4])?l.replace(/^\?/,""):void 0,hash:null!=(f=s[5])?f.replace(/^#/,""):void 0}:null)){if(t){for(a=null!=(h=d.query)?h:"",d.query=Object.create(null),i=0,o=(p=a.split("&")).length;i<o;i++)(e=(c=p[i]).indexOf("="))>-1?d.query[c.substring(0,e)]=unescape(c.substring(e+1)):c.length>0&&(d.query[c]=null);delete d.query[""]}$.extend(d,r(d.host)),$.keysOf(d).each(function(n){switch($.type(d[n])){case"null":case"undefined":delete d[n];break;case"string":0===d[n].length&&delete d[n]}return null})}return d},n=function(n,t,e,r){var i;return null==e&&(e=""),null==r&&(r=""),i=null!=n?n:"",i&&!t.test(i)?e+i+r:i},i=function(t){var e,r;return $.is("object",t.query)&&(t.query=function(){var n,i;n=t.query,i=[];for(e in n)r=n[e],i.push(e+"="+r);return i}().join("&")),[n(t.protocol,/:$/,"",":"),n(t.host,/^\//,"//"),n(t.port,/^:/,":"),n(t.path,/^\//,"/"),n(t.query,/^\?/,"?"),n(t.hash,/^#/,"#")].join("")},{$:{URL:{parse:e,stringify:i}}}}),$.plugin({provides:"watchProperty",depends:"type"},function(){var n,t;return"change","insert","delete",t=function(e,r,i,u){var o,s,c,a,l;return null==u&&(u=""),"string"==typeof r&&(c=r.indexOf("."))>-1?(o=r.substr(0,c),t(e[o],r.substr(c+1),i,(null!=u?u.length:void 0)&&u+"."+o||o)):($.is("array",e[r])&&n(e[r],i,(null!=u?u.length:void 0)&&u+"."+r||r),a=Object.getOwnPropertyDescriptor(e,r),$.defineProperty(e,r,{get:s=null!=(l=a.get)?l:function(){return a.value},set:$.compose($.partial(i,"change",(null!=u?u.length:void 0)&&u+"."+r||r),a.set||a.writable&&function(n){return a.value=n}||s)}))},n=function(n,e,r){var i,u,o;return null==r&&(r=""),u=function(n,t,i){return e(n,(null!=r?r.length:void 0)&&r+"."+t||t,i)},i=function(t,e){var r;return r=n[t],n[t]=function(){var t;t=1<=arguments.length?slice.call(arguments,0):[];try{return r.apply(n,t)}finally{e.apply(n,t)}}},(o=function(){var e,r,i;for(e=r=0,i=n.length;r<i;e=r+=1)t(n,e,u);return null})(),i("push",function(n){var e;return e=this.length-1,t(this,e,u),u("insert",e,n)}),i("unshift",function(n){return o(),u("insert",0,n)}),i("pop",function(){return u("delete",this.length,1)}),i("shift",function(){return o(),u("delete",this.length,1)}),i("splice",function(n,t,e){if(void 0!==e?(n+=1,t-=1):t>0&&(n=this.length),t>0)return u("delete",n,t)}),n},{$:{watchProperty:t}}})}).call(this);