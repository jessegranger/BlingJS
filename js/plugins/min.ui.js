(function(e){return e.plugin(function(){var j,o,k,l,m,n;o=function(c,b){var a,b=Object.Extend({autoOpen:!1,draggable:!0},b);a=e(c).addClass("dialog");b.draggable&&a.draggable();b.autoOpen&&a.show().center();a.find("button.close, .close-button").bind("click touchstart",function(){a.hide();return!1});return a};k=function(c,b){var a,d,f,h,g,b=Object.Extend({handleCSS:{}},b);b.handleCSS=Object.Extend({position:"absolute",top:"0px",left:"0px",width:"100%",height:"6px"},b.handleCSS);a=e(c);f=!1;h=g=0;d=
e.synth("div.handle").defaultCss({background:"-webkit-gradient(linear, 50% 0%, 50% 100%, from(#eee), color-stop(0.25, #bbb), color-stop(0.3, #eee), color-stop(0.5, #eee), to(#bbb))",height:"6px","border-radius":"3px",cursor:"move"}.css(b.handleCSS.bind("mousedown, touchstart",function(a){f=!0;h||(h=a.pageX);g||(g=a.pageY);return!1})));e(document.bind("mousemove, touchmove",function(b){var c;if(f)return c=b.pageX-h,b=b.pageY-g,a.transform({translate:[c,b]},0).trigger("drag",{dragObject:a}),!1})).bind("mouseup, touchend",
function(){var b;if(f)return f=!1,b=d.position()[0],e(document.elementFromPoint(b.left,b.top-1).trigger("drop",{dropObject:a}))});return a.addClass("draggable").css({position:"relative","padding-top":a.css("padding-top").map(Number.AtLeast(parseInt(b.handleCSS.height,10))).px().first()}.append(d))};l=function(c,b){var a,d,f,h,b=Object.Extend({change:Function.Empty,backgroundColor:"#fff",barColor:"rgba(0,128,0,0.5)",textColor:"white",reset:!1},b);a=e(c).addClass("progress-bar");h=0;b.reset&&(d=a.css("background").first(),
f=a.css("color").first());return a.zap("updateProgress",function(c){for(;c>1;)c=c/100;h=c;c===1&&b.reset?a.css("background",d).css("color",f):a.css({background:"-webkit-gradient(linear, 0 0, "+parseInt(c*100)+"% 0, color-stop(0, "+b.barColor+"), color-stop(0.98, "+b.barColor+"), color-stop(1.0, "+b.backgroundColor+"))",color:b.textColor});if(Object.IsFunc(b.change))return b.change(h)})};j=function(c,b){var a,d,b=Object.Extend({exclusive:!1,sticky:!1},b);d=e(c).addClass("accordion");a=function(a){var c,
g,i,a=e(a).children().first().filter("*");if(2!==a.len())throw Exception("accordion row requires 2 elements, not "+a.len());i=a.eq(0).addClass("title");c=a.eq(1).addClass("body").hide();g=!1;return i.click(function(){b.exclusive&&d.find(".body").hide();if(g){if(b.sticky)return c.show().addClass("visible"),i.addClass("selected").trigger("select"),g=!0;c.hide().removeClass("visible");i.removeClass("selected").trigger("deselect");return g=!1}c.show().addClass("visible");i.addClass("selected").trigger("select");
return g=!0})};d.bind("DOMNodeInserted",function(b){var c;c=d.children().first().filter("*");b=e(b.target).parents().first();return a(b.intersect(c))});d.children().first().filter("*").map(a);return d};n=function(c){var b,a,d;a=e(c).css({position:"relative",top:"0px",left:"0px"}.hide().map(e));b=0;a[b].show();a.next=function(){a[b].hide();b=++b%nn;return a[b].show()};a.activate=function(c){a[b].hide();b=c;return a[c].show()};c=0;for(d=a.len();0<=d?c<d:c>d;0<=d?c++:c--)a[c].zap("_viewIndex",c.zap("activate",
function(){return a.activate(this._viewIndex)}));return a};m=function(c,b){var a,d,f;f=e(c);b=e(b).viewStack();d=f.len();for(a=0;0<=d?a<=d:a>=d;0<=d?a++:a--)f._tabIndex=a;e(f[0]).addClass("active");return f.click(function(){f.removeClass("active");b.activate(this._tabIndex);return e(this).addClass("active")})};return{name:"UI",$:{UI:{Draggable:k,ProgressBar:l,ViewStack:n,Tabs:m,Accordion:j}},dialog:function(c){return o(this,c)},progressBar:function(c){return l(this,c)},viewStack:function(c){return n(this,
c)},tabs:function(c){return m(this,c)},accordion:function(c){return j(this,c)},draggable:function(c){return k(this,c)}}})})(Bling);
