(function(){var a={}.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e();f.__super__=d.prototype;return f};(function(c){c.plugin({provides:"StateMachine"},function(){var d;return{$:{StateMachine:d=(function(){function e(f){this.reset();this.table=f;Object.defineProperty(this,"modeline",{get:function(){return this.table[this._mode]}});Object.defineProperty(this,"mode",{set:function(g){var h;this._lastMode=this._mode;this._mode=g;if(this._mode!==this._lastMode&&(this.modeline!=null)&&"enter" in this.modeline){h=this.modeline.enter.call(this);while(c.is("function",h)){h=h.call(this)}}return g},get:function(){return this._mode}})}e.prototype.reset=function(){this._mode=null;return this._lastMode=null};e.prototype.GO=function(f){return function(){return this.mode=f}};e.GO=function(f){return function(){return this.mode=f}};e.prototype.tick=function(h){var f,g;g=this.modeline;if(!(g!=null)){f=null}else{if(h in g){f=g[h]}else{if("def" in g){f=g.def}}}while(c.is("function",f)){f=f.call(this,h)}return f};e.prototype.run=function(g){var k,h,j,f,i;this.mode=0;for(j=0,f=g.length;j<f;j++){k=g[j];h=this.tick(k)}if(c.is("function",(i=this.modeline)!=null?i.eof:void 0)){h=this.modeline.eof.call(this)}while(c.is("function",h)){h=h.call(this)}this.reset();return this};return e})()}}});return c.plugin({provides:"synth",depends:"StateMachine"},function(){var d;d=(function(f){b(e,f);e.STATE_TABLE=[{enter:function(){this.tag=this.id=this.cls=this.attr=this.val=this.text="";this.attrs={};return this.GO(1)}},{'"':e.GO(6),"'":e.GO(7),"#":e.GO(2),".":e.GO(3),"[":e.GO(4)," ":e.GO(9),"+":e.GO(11),",":e.GO(10),def:function(g){return this.tag+=g},eof:e.GO(13)},{".":e.GO(3),"[":e.GO(4)," ":e.GO(9),"+":e.GO(11),",":e.GO(10),def:function(g){return this.id+=g},eof:e.GO(13)},{enter:function(){if(this.cls.length>0){return this.cls+=" "}},"#":e.GO(2),".":e.GO(3),"[":e.GO(4)," ":e.GO(9),"+":e.GO(11),",":e.GO(10),def:function(g){return this.cls+=g},eof:e.GO(13)},{"=":e.GO(5),"]":function(){this.attrs[this.attr]=this.val;return this.GO(1)},def:function(g){return this.attr+=g},eof:e.GO(12)},{"]":function(){this.attrs[this.attr]=this.val;return this.GO(1)},def:function(g){return this.val+=g},eof:e.GO(12)},{'"':e.GO(8),def:function(g){return this.text+=g},eof:e.GO(12)},{"'":e.GO(8),def:function(g){return this.text+=g},eof:e.GO(12)},{enter:function(){this.emitText();return this.GO(0)}},{enter:function(){this.emitNode();return this.GO(0)}},{enter:function(){this.emitNode();this.parent=null;return this.GO(0)}},{enter:function(){var g;this.emitNode();this.parent=(g=this.parent)!=null?g.parentNode:void 0;return this.GO(0)}},{enter:function(){return c.log("Error in synth expression: "+this.input)}},{enter:function(){if(this.tag.length){this.emitNode()}if(this.text.length){return this.emitText()}}}];function e(){e.__super__.constructor.call(this,e.STATE_TABLE);this.fragment=this.parent=document.createDocumentFragment()}e.prototype.emitNode=function(){var g,h;h=document.createElement(this.tag);h.id=this.id||null;h.className=this.cls||null;for(g in this.attrs){h.setAttribute(g,this.attrs[g])}this.parent.appendChild(h);return this.parent=h};e.prototype.emitText=function(){this.parent.appendChild(c.HTML.parse(this.text));return this.text=""};return e})(c.StateMachine);return{$:{synth:function(f){var e;e=new d();e.run(f);if(e.fragment.childNodes.length===1){return c(e.fragment.childNodes[0])}else{return c(e.fragment)}}}}})})(Bling)}).call(this);