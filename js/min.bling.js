(function(){var d,g,f,e=[].slice,c=[].indexOf||function(k){for(var j=0,h=this.length;j<h;j++){if(j in this&&this[j]===k){return j}}return -1},a={}.hasOwnProperty,b=function(k,i){for(var h in i){if(a.call(i,h)){k[h]=i[h]}}function j(){this.constructor=k}j.prototype=i.prototype;k.prototype=new j();k.__super__=i.prototype;return k};Object.keys||(Object.keys=function(j){var i,h;h=[];for(i in j){h.push(i)}return h});Object.values||(Object.values=function(j){var i,h;h=[];for(i in j){h.push(j[i])}return h});f=function(){var j,h,m,o,l,n,i;j=arguments[0],h=2<=arguments.length?e.call(arguments,1):[];for(n=0,i=h.length;n<i;n++){o=h[n];if(o){for(m in o){l=o[m];j[m]=l}}}return j};g=(function(){function h(){var i;i=1<=arguments.length?e.call(arguments,0):[];return h.hook("bling-init",i)}return h})();g.prototype=[];g.prototype.constructor=g;g.global=typeof window!=="undefined"&&window!==null?window:global;g.plugin=function(h,i){var q,l,p,j,o,k,m=this;if(!i){i=h;h={}}if("depends" in h){return this.depends(h.depends,function(){return m.plugin({provides:h.provides},i)})}try{if(typeof(l=i!=null?i.call(this,this):void 0)==="object"){((p=g.plugin)[o=(k=h.provides)!=null?k:""]||(p[o]=[])).push(l);f(this,l!=null?l.$:void 0);delete l.$;f(this.prototype,l);j=function(r){return m[r]||(m[r]=function(){var s;s=1<=arguments.length?e.call(arguments,0):[];return m.prototype[r].apply(g(s[0]),s.slice(1))})};for(q in l){j(q)}if(h.provides!=null){this.provide(h.provides)}}}catch(n){console.log("failed to load plugin: "+this.name+" "+n.message+": "+n.stack)}return this};f(g,(function(){var i,h,j;j=[];i={};h=function(k){return((typeof k)==="string"?k.split(/, */):k).filter(function(l){return !(l in i)})};return{depends:function(k,l){if((k=h(k)).length===0){l()}else{j.push(function(n){var m;if((m=k.indexOf(n))>-1){k.splice(m,1)}return k.length===0&&l})}return l},provide:function(m,r){var o,l,n,q,k,p;p=h(m);for(q=0,k=p.length;q<k;q++){n=p[q];i[n]=l=0;while(l<j.length){if((o=j[l](n))){j.splice(l,1);o(r);l=0}else{l++}}}return r}}})());d=g;d.plugin({depends:"core",provides:"async"},function(){return{series:function(n){var i,j,l,k,h,m=this;if(n==null){n=d.identity}k=d();h=this.length;if(!(h>0)){n.apply(k);return this}i=0;j=function(o){return function(){k[o]=arguments;if(++i>=h){return n.apply(k)}else{return l(i)}}};(l=function(o){return d.immediate(function(){return m[o](j(o))})})(0);return this},parallel:function(p){var k,l,n,m,h,o,j;m=d();h=this.length;if(!(h>0)){p.apply(m);return this}k=0;l=function(i){return function(){m[i]=arguments;if(++k>=h){return p.apply(m)}}};j=[];for(n=o=0;o<h;n=o+=1){j.push(this[n](l(n)))}return j}}});d.plugin({provides:"cartesian"},function(){return{$:{cartesian:function(){var j,k,h,i;i=1<=arguments.length?e.call(arguments,0):[];k=i.length;h=[];j=function(q,n){var l,p,m,o;if(++n>=k){return h.push(q)}o=i[n];for(p=0,m=o.length;p<m;p++){l=o[p];j(q.concat(l),n)}return null};j([],-1);return d(h)}}}});d.plugin(function(){var l,j,k,i,h;(j=String.prototype).trimLeft||(j.trimLeft=function(){return this.replace(/^\s+/,"")});(k=String.prototype).split||(k.split=function(o){var m,p,n;m=[];p=0;while((n=this.indexOf(o,p))>-1){m.push(this.substring(p,n));p=n+1}return m});(i=String.prototype).lastIndexOf||(i.lastIndexOf=function(o,p,n){var m;if(n==null){n=-1}m=-1;while((n=o.indexOf(p,n+1))>-1){m=n}return m});(h=Array.prototype).join||(h.join=function(m){var p,o;if(m==null){m=""}p=this.length;if(p===0){return""}o=this[p-1];while(--p>0){o=this[p-1]+m+o}return o});if(typeof Event!=="undefined"&&Event!==null){Event.prototype.preventAll=function(){this.preventDefault();this.stopPropagation();return this.cancelBubble=true}}if(typeof Element!=="undefined"&&Element!==null){Element.prototype.matchesSelector=Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.matchesSelector;if(Element.prototype.cloneNode.length===0){l=Element.prototype.cloneNode;Element.prototype.cloneNode=function(o){var p,s,r,m,q;if(o==null){o=false}s=l.call(this);if(o){q=this.childNodes;for(r=0,m=q.length;r<m;r++){p=q[r];s.appendChild(p.cloneNode(true))}}return s}}}return{}});d.plugin({provides:"config",depends:"type"},function(){var h,i;h=function(j,l){var k;return(k=process.env[j])!=null?k:l};i=function(j,k){return process.env[j]=k};return{$:{config:d.extend(h,{get:h,set:i})}}});d.plugin({provides:"core",depends:"string"},function(){var i,h;d.defineProperty(d,"now",{get:function(){return +(new Date)}});h=function(j,k){while(j<0){j+=k.length}return Math.min(j,k.length)};i=d.now;return{$:{log:d.extend(function(){var j,k;j=1<=arguments.length?e.call(arguments,0):[];k="+"+(d.padLeft(String(d.now-i),d.log.prefixSize,"0"))+":";if(k.length>d.log.prefixSize+2){k=""+(i=d.now)+":"}if(j.length&&d.is("string",j[0])){j[0]=""+k+" "+j[0]}else{j.unshift(k)}console.log.apply(console,j);if(j.length){return j[j.length-1]}},{prefixSize:5}),assert:function(k,j){if(j==null){j=""}if(!k){throw new Error("assertion failed: "+j)}},coalesce:function(){var j;j=1<=arguments.length?e.call(arguments,0):[];return d(j).coalesce()},keysOf:function(l){var j;return d((function(){var k;k=[];for(j in l){k.push(j)}return k})())},valuesOf:function(j){return d.keysOf(j).map(function(l){try{return j[l]}catch(m){return m}})}},eq:function(j){return d([this[h(j,this)]])},each:function(m){var k,l,j;for(l=0,j=this.length;l<j;l++){k=this[l];m.call(k,k)}return this},map:function(k){var j;return d((function(){var n,m,l;l=[];for(n=0,m=this.length;n<m;n++){j=this[n];l.push(k.call(j,j))}return l}).call(this))},filterMap:function(o){var j,m,l,n,k;j=d();for(n=0,k=this.length;n<k;n++){m=this[n];l=o.call(m,m);if(l!=null){j.push(l)}}return j},tap:function(j){return j.call(this,this)},replaceWith:function(n){var k,m,l,j;j=[];for(k=m=0,l=n.length;m<l;k=m+=1){j.push(this[k]=n[k])}return j},reduce:function(o,k){var l,p,j,m;l=0;p=this.length;if(!(k!=null)){k=this[l++]}for(j=m=l;m<p;j=m+=1){k=o.call(this[j],k,this[j])}return k},union:function(k,n){var o,j,q,p,m,l;if(n==null){n=true}o=d();for(q=0,m=this.length;q<m;q++){j=this[q];if(!o.contains(j,n)){o.push(j)}}for(p=0,l=k.length;p<l;p++){j=k[p];if(!o.contains(j,n)){o.push(j)}}return o},distinct:function(j){if(j==null){j=true}return this.union(this,j)},intersect:function(k){var j;return d((function(){var n,m,l;l=[];for(n=0,m=this.length;n<m;n++){j=this[n];if(c.call(k,j)>=0){l.push(j)}}return l}).call(this))},contains:function(l,j){var k;if(j==null){j=true}return((function(){var o,n,m;m=[];for(o=0,n=this.length;o<n;o++){k=this[o];m.push((j&&k===l)||(!j&&k==l))}return m}).call(this)).reduce((function(n,m){return n||m}),false)},count:function(l,j){var k;if(j==null){j=true}return d((function(){var o,n,m;m=[];for(o=0,n=this.length;o<n;o++){k=this[o];if((l===void 0)||(j&&k===l)||(!j&&k==l)){m.push(1)}}return m}).call(this)).sum()},coalesce:function(){var k,l,j;for(l=0,j=this.length;l<j;l++){k=this[l];if(d.is("array",k)||d.is("bling",k)){k=d(k).coalesce()}if(k!=null){return k}}return null},swap:function(l,k){var m;l=h(l,this);k=h(k,this);if(l!==k){m=[this[k],this[l]],this[l]=m[0],this[k]=m[1]}return this},shuffle:function(){var j;j=this.length-1;while(j>=0){this.swap(--j,Math.floor(Math.random()*j))}return this},select:(function(){var j,l,k;j=function(m){return function(){var n;if(d.is("function",n=this[m])){return d.bound(this,n)}else{return n}}};k=function(o){var m,n;switch(n=d.type(o)){case"regexp":return l.call(this,o);case"string":if((m=o.indexOf("."))>-1){return this.select(o.substr(0,m)).select(o.substr(m+1))}else{return this.map(j(o))}break;default:return d()}};l=function(){var y,u,z,v,q,o,s,r,w,m,t;y=1<=arguments.length?e.call(arguments,0):[];q=this.length;z=Object.create(null);for(s=0,w=y.length;s<w;s++){o=y[s];if(d.is("regexp",o)){t=d.keysOf(this.first()).filter(o);for(r=0,m=t.length;r<m;r++){v=t[r];z[v]=this.select(v)}}else{z[o]=this.select(o)}}u=0;return this.map(function(){var n;n=Object.create(null);for(o in z){n[d(o.split(".")).last()]=z[o][u]}u++;return n})};return function(){switch(arguments.length){case 1:return k.apply(this,arguments);case 2:return l.apply(this,arguments)}}})(),or:function(j){var k,m,l;for(k=m=0,l=this.length;0<=l?m<l:m>l;k=0<=l?++m:--m){this[k]||(this[k]=j)}return this},zap:function(q,l){var o,n,j,m;if((d.is("object",q))&&!(l!=null)){for(j in q){l=q[j];this.zap(j,l)}return this}n=q.lastIndexOf(".");if(n>0){o=q.substr(0,n);m=q.substr(n+1);this.select(o).zap(m,l);return this}switch(d.type(l)){case"array":case"bling":this.each(function(){return this[q]=l[++n%l.length]});break;case"function":this.zap(q,this.select(q).map(l));break;default:this.each(function(){return this[q]=l})}return this},clean:function(j){return this.each(function(){return delete this[j]})},take:function(l){var j,k;if(l==null){l=1}j=Math.min(l,this.length);return d((function(){var n,m;m=[];for(k=n=0;n<j;k=n+=1){m.push(this[k])}return m}).call(this))},skip:function(l){var j,k;if(l==null){l=0}k=Math.max(0,l|0);return d((function(){var o,n,m;m=[];for(j=o=k,n=this.length;o<n;j=o+=1){m.push(this[j])}return m}).call(this))},first:function(j){if(j==null){j=1}if(j===1){return this[0]}else{return this.take(j)}},last:function(j){if(j==null){j=1}if(j===1){return this[this.length-1]}else{return this.skip(this.length-j)}},slice:function(l,j){var k;if(l==null){l=0}if(j==null){j=this.length}l=h(l,this);j=h(j,this);return d((function(){var n,m;m=[];for(k=n=l;l<=j?n<j:n>j;k=l<=j?++n:--n){m.push(this[k])}return m}).call(this))},extend:function(j){var l,m,k;for(m=0,k=j.length;m<k;m++){l=j[m];this.push(l)}return this},push:function(j){Array.prototype.push.call(this,j);return this},filter:function(p,l){var k,n,m,o,j;if(l==null){l=this.length}n=(function(){switch(d.type(p)){case"string":return function(q){return q.matchesSelector(p)};case"regexp":return function(q){return p.test(q)};case"function":return p;default:throw new Error("unsupported argument to filter: "+(d.type(p)))}})();k=d();for(o=0,j=this.length;o<j;o++){m=this[o];if(n.call(m,m)){if(--l<0){break}k.push(m)}}return k},matches:function(j){switch(d.type(j)){case"string":return this.select("matchesSelector").call(j);case"regexp":return this.map(function(k){return j.test(k)});default:throw new Error("unsupported argument to matches: "+(d.type(j)))}},querySelectorAll:function(j){return this.filter("*").reduce(function(k,l){return k.extend(l.querySelectorAll(j))},d())},weave:function(k){var p,l,o,m,n,j;p=d();for(l=o=n=this.length-1;o>=0;l=o+=-1){p[(l*2)+1]=this[l]}for(l=m=0,j=k.length;m<j;l=m+=1){p[l*2]=k[l]}return p},fold:function(l){var j,k,m;m=this.length;j=d((function(){var p,o,n;n=[];for(k=p=0,o=m-1;p<o;k=p+=2){n.push(l.call(this,this[k],this[k+1]))}return n}).call(this));if((m%2)===1){j.push(l.call(this,this[m-1],void 0))}return j},flatten:function(){var k,o,n,q,p,m,l;k=d();for(q=0,m=this.length;q<m;q++){o=this[q];for(p=0,l=o.length;p<l;p++){n=o[p];k.push(n)}}return k},call:function(){return this.apply(null,arguments)},apply:function(k,j){return this.filterMap(function(){if(d.is("function",this)){return this.apply(k,j)}else{return null}})},log:function(j){if(j){d.log(j,this.toString(),this.length+" items")}else{d.log(this.toString(),this.length+" items")}return this},toArray:function(){this.__proto__=Array.prototype;return this}}});d.plugin({provides:"date",depends:"type"},function(){var j,r,o,p,t,n,k,i,u,v,w,q,l;l=[1,1000,1000*60,1000*60*60,1000*60*60*24],i=l[0],w=l[1],k=l[2],n=l[3],r=l[4];q={ms:i,s:w,m:k,h:n,d:r,sec:w,second:w,seconds:w,min:k,minute:k,minutes:k,hr:n,hour:n,hours:n,day:r,days:r};t={yyyy:Date.prototype.getUTCFullYear,mm:function(){return this.getUTCMonth()+1},dd:Date.prototype.getUTCDate,HH:Date.prototype.getUTCHours,MM:Date.prototype.getUTCMinutes,SS:Date.prototype.getUTCSeconds,MS:Date.prototype.getUTCMilliseconds};p=Object.keys(t).sort().reverse();v={yyyy:Date.prototype.setUTCFullYear,mm:function(h){return this.setUTCMonth(h-1)},dd:Date.prototype.setUTCDate,HH:Date.prototype.setUTCHours,MM:Date.prototype.setUTCMinutes,SS:Date.prototype.setUTCSeconds,MS:Date.prototype.setUTCMilliseconds};u=Object.keys(v).sort().reverse();o=Math.floor;d.type.register("date",{match:function(h){return d.isType(Date,h)},array:function(h){return[h]},string:function(s,h,m){return d.date.format(s,h,m)},number:function(m,h){return d.date.stamp(m,h)}});d.type.extend("string",{date:function(m,h){if(h==null){h=d.date.defaultFormat}return new Date(d.date.parse(m,h,"ms"))}});d.type.extend("number",{date:function(m,h){return d.date.unstamp(m,h)}});j=function(h){return function(s,z,y){var m;if(y==null){y=d.date.defaultUnit}m=d.date.unstamp(s,y);v[h].call(m,(t[h].call(m))+z);return d.date.stamp(m,y)}};return{$:{date:{defaultUnit:"s",defaultFormat:"yyyy-mm-dd HH:MM:SS",stamp:function(h,m){if(h==null){h=new Date}if(m==null){m=d.date.defaultUnit}return o(h/q[m])},unstamp:function(h,m){if(m==null){m=d.date.defaultUnit}return new Date(o(h*q[m]))},convert:function(h,s,m){if(s==null){s=d.date.defaultUnit}if(m==null){m=d.date.defaultUnit}if(d.is("date",h)){h=d.date.stamp(h,s)}return o(h*q[s]/q[m])},midnight:function(h,m){if(m==null){m=d.date.defaultUnit}return d.date.convert(d.date.convert(h,m,"d"),"d",m)},format:function(z,m,A){var y,s,B,h;if(m==null){m=d.date.defaultFormat}if(A==null){A=d.date.defaultUnit}if(d.is("date",z)){z=d.date.stamp(z,A)}y=d.date.unstamp(z,A);for(B=0,h=p.length;B<h;B++){s=p[B];m=m.replace(s,d.padLeft(""+t[s].call(y),s.length,"0"))}return m},parse:function(E,h,F){var m,C,A,B,z,D,y;if(h==null){h=d.date.defaultFormat}if(F==null){F=d.date.defaultUnit}m=new Date(0);for(C=B=0,y=h.length;B<y;C=B+=1){for(z=0,D=u.length;z<D;z++){A=u[z];if(h.indexOf(A,C)===C){try{v[A].call(m,parseInt(E.slice(C,C+A.length),10))}catch(s){throw new Error("Invalid date ('"+E+"') given format mask: "+h+" (failed at position "+C+")")}}}}return d.date.stamp(m,F)},addMilliseconds:j("MS"),addSeconds:j("SS"),addMinutes:j("MM"),addHours:j("HH"),addDays:j("dd"),addMonths:j("mm"),addYears:j("yyyy"),range:function(C,B,h,y,s){var z,A,m;if(h==null){h=1}if(y==null){y="dd"}if(s==null){s=d.date.defaultUnit}z=j(y);m=[C];while((A=m[m.length-1])<B){m.push(z(A,h,s))}return m}}},midnight:function(h){if(h==null){h=d.date.defaultUnit}return this.map(function(){return d.date.midnight(this,h)})},unstamp:function(h){if(h==null){h=d.date.defaultUnit}return this.map(function(){return d.date.unstamp(this,h)})},stamp:function(h){if(h==null){h=d.date.defaultUnit}return this.map(function(){return d.date.stamp(this,h)})},dateFormat:function(h,m){if(h==null){h=d.date.defaultFormat}if(m==null){m=d.date.defaultUnit}return this.map(function(){return d.date.format(this,h,m)})},dateParse:function(h,m){if(h==null){h=d.date.defaultFormat}if(m==null){m=d.date.defaultUnit}return this.map(function(){return d.date.parse(this,h,m)})}}});d.plugin({provides:"delay",depends:"function"},function(){return{$:{delay:(function(){var h;h=d.extend([],(function(){var i;i=function(j){return function(){if(j.length){return j.shift()()}}};return{add:function(m,o){var j,l,k;m.order=o+d.now;for(j=l=0,k=this.length;l<=k;j=l+=1){if(j===this.length||this[j].order>m.order){this.splice(j,0,m);break}}setTimeout(i(this),o);return this},cancel:function(m){var j,l,k;for(j=l=0,k=this.length;l<k;j=l+=1){if(this[j]===m){this.splice(j,1);break}}return this}}})());return function(j,i){if(d.is("function",i)){h.add(i,parseInt(j))}return{cancel:function(){return h.cancel(i)}}}})(),immediate:(function(){switch(true){case"setImmediate" in d.global:return d.global.setImmediate;case (typeof process!=="undefined"&&process!==null?process.nextTick:void 0)!=null:return process.nextTick;default:return function(h){return setTimeout(h,0)}}})(),interval:function(j,i){var h;return d.delay(j,h=function(){i();return d.delay(j,h)})}},delay:function(i,h){d.delay(i,h);return this}}});d.plugin({depends:"hook,synth,delay",provides:"dialog"},function(){var h,i,j;j=function(k,l){k=k.split(/, */);return["-webkit","-moz"].map(function(m){return""+m+"-transition-property: "+(k.join(", "))+"; "+m+"-transition-duration: "+(k.map(function(){return l}).join(", "))+";"}).join(" ")};i=function(){d("head style.dialog").remove();return d.synth(("style.dialog '			.dialog, .modal { position: absolute; }			.modal {				background: rgba(0,0,0,.3);				opacity: 0;			}			.dialog {				box-shadow: 8px 8px 4px rgba(0,0,0,.4);				border-radius: 8px;				background: white;				padding: 6px; "+(j("left",".15s"))+"			}			.dialog > .title {				text-align: center;				width: 100%;			}			.dialog > .content {				width: 100%;			}		'").replace(/\t+|\n+/g," ")).prependTo("head")};h=function(o){var k,l,n,m,p;o=d.extend(h.getDefaultOptions(),o);i();n="";m=d.synth("div.modal div.dialog#"+o.id+" div.title + div.content").appendTo("body").click(function(q){if(q.target===m[0]){d.log("dialog: Cancelling because the modal was clicked.");return o.cancel(m)}});l=m.find(".dialog",1);m.delegate(".cancel","click",function(q){return o.cancel(m)}).delegate(".ok","click",function(q){return o.ok(m)});k=l.find(".content",1);k.append(h.getContent(o.contentType,o.content));p=l.find(".title",1);p.append(h.getContent(o.titleType,o.title));d(o.target).bind("resize",function(q){m.fitOver(o.target).fadeIn(200);return l.centerOn(m).show()}).trigger("resize");return l};h.getDefaultOptions=function(){return{id:"dialog-"+d.random.string(4),target:"body",title:"Untitled Dialog",titleType:"text",content:"span 'Dialog Content'",contentType:"synth",ok:function(k){d.log("dialog: Closing from default ok");return k.emit("ok").fadeOut(200,function(){return k.remove()})},cancel:function(k){d.log("dialog: Closing from default cancel");return k.emit("cancel").fadeOut(200,function(){return k.remove()}).find(".dialog",1).css({left:0})}}};h.getContent=function(k,l){switch(k){case"synth":return d.synth(l);case"html":return d.HTML.parse(l);case"text":return document.createTextNode(l)}};return{$:{dialog:h},fitOver:function(l){var k;if(l==null){l=window}if(l===window){k={width:window.innerWidth,height:window.innerHeight,top:0,left:0}}else{k=d(l).rect().first()}return this.css({position:"absolute",width:d.px(k.width),height:d.px(k.height),top:d.px(k.top),left:d.px(k.left)})},centerOn:function(k){var n,m,l;if(k==null){k=window}if(k===window){m={width:window.innerWidth,height:window.innerHeight,top:0,left:0}}else{m=d(k).rect().first()}l=m.height/2;n=m.width/2;return this.each(function(){var o,p;o=d(this);p=o.rect().first();return o.css({top:d.px(l-(p.height/2)),left:d.px(n-(p.width/2))})})}}});if(d.global.document!=null){d.plugin({depends:"function,type",provides:"dom"},function(){var j,p,q,l,n,h,i,m,k,o;p=false;d.type.register("nodelist",{match:function(r){return(r!=null)&&d.isType("NodeList",r)},hash:function(s){var r;return d((function(){var v,u,t;t=[];for(v=0,u=x.length;v<u;v++){r=x[v];t.push(d.hash(r))}return t})()).sum()},array:(function(){try{document.querySelectorAll("xxx").__proto__={};return d.identity}catch(r){p=true;return function(w){var u,v,t,s;s=[];for(v=0,t=w.length;v<t;v++){u=w[v];s.push(u)}return s}}})(),string:function(r){return"{Nodelist:["+d(r).select("nodeName").join(",")+"]}"},node:function(r){return d(r).toFragment()}});d.type.register("node",{match:function(r){return(r!=null?r.nodeType:void 0)>0},hash:function(r){return d.checksum(r.nodeName)+d.hash(r.attributes)+d.checksum(r.innerHTML)},string:function(r){return r.toString()},node:d.identity});d.type.register("fragment",{match:function(r){return(r!=null?r.nodeType:void 0)===11},hash:function(s){var r;return d((function(){var w,u,v,t;v=s.childNodes;t=[];for(w=0,u=v.length;w<u;w++){r=v[w];t.push(d.hash(r))}return t})()).sum()},string:function(r){return r.toString()},node:d.identity});d.type.register("html",{match:function(t){var r;return typeof t==="string"&&(r=t.trimLeft())[0]==="<"&&r[r.length-1]===">"},node:function(s){var w,v,r,y,t,u;(t=document.createElement("div")).innerHTML=s;if(y=(w=t.childNodes).length===1){return t.removeChild(w[0])}v=document.createDocumentFragment();for(r=u=0;u<y;r=u+=1){v.appendChild(t.removeChild(w[0]))}return v},array:function(s){var r;return d.type.lookup(r=g.HTML.parse(s)).array(r)},string:function(r){return"'"+r+"'"},repr:function(r){return'"'+r+'"'}});d.type.extend({unknown:{node:function(){return null}},bling:{node:function(r){return r.toFragment()}},node:{html:function(t){var s,r;s=document.createElement("div");s.appendChild((t=t.cloneNode(true)));r=s.innerHTML;s.removeChild(t);return r}},string:{node:function(r){return d(r).toFragment()},array:(function(){if(p){return function(s){var r;return d.type.lookup(r=document.querySelectorAll(s)).array(r)}}else{return function(r){return document.querySelectorAll(r)}}})()},"function":{node:function(r){return d(r.toString()).toFragment()}}});k=function(r){var s;if(!(r.parentNode!=null)){s=document.createDocumentFragment();s.appendChild(r)}return r};q=function(s,r){return k(s).parentNode.insertBefore(r,s)};j=function(s,r){return k(s).parentNode.insertBefore(r,s.nextSibling)};o=function(r){return d.type.lookup(r).node(r)};n=false;i=false;l=function(r){return function(){return d.global.getComputedStyle(this,null).getPropertyValue(r)}};h=function(r){return function(s){if(s!=null){return this.css(r,s)}else{return this.rect().select(r)}}};m=function(r){return function(){return this.map(function(s){return d((function(){var t;t=[];while(s=s[r]){t.push(s)}return t})())})}};return{$:{HTML:{parse:function(r){return d.type.lookup(r).node(r)},stringify:function(r){return d.type.lookup(r).html(r)},escape:function(s){var r;n||(n=d("<div>&nbsp;</div>").child(0));r=n.zap("data",s).select("parentNode.innerHTML").first();n.zap("data","");return r}}},html:function(r){switch(d.type(r)){case"undefined":case"null":return this.select("innerHTML");case"string":case"html":return this.zap("innerHTML",r);case"bling":return this.html(r.toFragment());case"node":return this.each(function(){var s;this.replaceChild(this.childNodes[0],r);s=[];while(this.childNodes.length>1){s.push(this.removeChild(this.childNodes[1]))}return s})}},append:function(r){r=o(r);return this.each(function(){return this.appendChild(r.cloneNode(true))})},appendTo:function(r){var t,s;t=this.map(function(){return this.cloneNode(true)});s=0;d(r).each(function(){return this.appendChild(t[s++])});return t},prepend:function(r){if(r!=null){r=o(r);this.take(1).each(function(){return q(this.childNodes[0],r)});this.skip(1).each(function(){return q(this.childNodes[0],r.cloneNode(true))})}return this},prependTo:function(r){if(r!=null){d(r).prepend(this)}return this},before:function(r){if(r!=null){r=o(r);this.take(1).each(function(){return q(this,r)});this.skip(1).each(function(){return q(this,r.cloneNode(true))})}return this},after:function(r){if(r!=null){r=o(r);this.take(1).each(function(){return j(this,r)});this.skip(1).each(function(){return j(this,r.cloneNode(true))})}return this},wrap:function(r){r=o(r);if(d.is("fragment",r)){throw new Error("cannot call .wrap() with a fragment as the parent")}return this.each(function(u){var t,s;if((d.is("fragment",u))||!u.parentNode){return r.appendChild(u)}t=u.parentNode;s=document.createElement("dummy");r.appendChild(t.replaceChild(s,u));return t.replaceChild(r,s)})},unwrap:function(){return this.each(function(){if(this.parentNode&&this.parentNode.parentNode){return this.parentNode.parentNode.replaceChild(this,this.parentNode)}else{if(this.parentNode){return this.parentNode.removeChild(this)}}})},replace:function(w){var v,s,u,t,r;w=o(w);v=this.map(function(){return w.cloneNode(true)});for(s=u=0,t=v.length;u<t;s=u+=1){if((r=this[s].parentNode)!=null){r.replaceChild(v[s],this[s])}}return v},attr:function(r,s){switch(s){case void 0:return this.select("getAttribute").call(r,s);case null:return this.select("removeAttribute").call(r,s);default:this.select("setAttribute").call(r,s);return this}},data:function(s,r){return this.attr("data-"+(d.dashize(s)),r)},addClass:function(s){var r;r=function(t){return t!==""};return this.removeClass(s).each(function(){var t;t=this.className.split(" ").filter(r);t.push(s);return this.className=t.join(" ")})},removeClass:function(r){var s;s=function(t){return t!==r};return this.each(function(){var t;t=this.className.split(" ").filter(s).join(" ");if(t.length===0){return this.removeAttribute("class")}})},toggleClass:function(r){var s;s=function(t){return t!==r};return this.each(function(){var v,t,u;t=this.className.split(" ");u=d.not(d.isEmpty);if(t.indexOf(r)>-1){u=d.and(s,u)}else{t.push(r)}v=t.filter(u).join(" ");this.className=v;if(v.length===0){return this.removeAttribute("class")}})},hasClass:function(r){return this.select("className.split").call(" ").select("indexOf").call(r).map(function(s){return s>-1})},text:function(r){if(r!=null){return this.zap("textContent",r)}return this.select("textContent")},val:function(r){if(r!=null){return this.zap("value",r)}return this.select("value")},css:function(B,C){var A,z,u,s,D,t,r,w,y;if((C!=null)||d.is("object",B)){r=this.select("style.setProperty");if(d.is("object",B)){for(u in B){C=B[u];r.call(u,C,"")}}else{if(d.is("array",C)){for(z=w=0,y=s=Math.max(C.length,D=r.length);w<y;z=w+=1){r[z%D](B,C[z%s],"")}}else{r.call(B,C,"")}}return this}else{A=this.map(l(B));t=this.select("style").select(B);return t.weave(A).fold(function(v,E){return v||E})}},defaultCss:function(s,r){var t,w,u;w=this.selector;u="";if(d.is("string",s)){if(d.is("string",r)){u+=""+w+" { "+s+": "+r+" } "}else{throw Error("defaultCss requires a value with a string key")}}else{if(d.is("object",s)){for(t in s+"} "){u+=(""+w+" { ")+(""+t+": "+s[t]+"; ")}}}d("<style></style>").text(u).appendTo("head");return this},rect:function(){return this.map(function(r){switch(r){case window:return{width:window.innerWidth,height:window.innerHeight,top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};default:return r.getBoundingClientRect()}})},width:h("width"),height:h("height"),top:h("top"),left:h("left"),bottom:h("bottom"),right:h("right"),position:function(s,r){switch(true){case !(s!=null):return this.rect();case !(r!=null):return this.css("left",d.px(s));default:return this.css({top:d.px(r),left:d.px(s)})}},scrollToCenter:function(){document.body.scrollTop=this[0].offsetTop-(d.global.innerHeight/2);return this},child:function(r){return this.select("childNodes").map(function(){return this[r<0?r+this.length:r]})},parents:m("parentNode"),prev:m("previousSibling"),next:m("nextSibling"),remove:function(){return this.each(function(){var r;return(r=this.parentNode)!=null?r.removeChild(this):void 0})},find:function(s,r){if(r==null){r=0}return this.filter("*").map((function(){switch(r){case 0:return function(){return this.querySelectorAll(s)};case 1:return function(){return d(this.querySelector(s))};default:return function(){return d(this.querySelectorAll(s)).take(r)}}})()).flatten()},clone:function(r){if(r==null){r=true}return this.map(function(){if(d.is("node",this)){return this.cloneNode(r)}})},toFragment:function(){var r;if(this.length>1){r=document.createDocumentFragment();(this.map(o)).map(d.bound(r,r.appendChild));return r}return o(this[0])}}})}d.plugin({provides:"EventEmitter",depends:"type,hook"},function(){return{$:{EventEmitter:d.hook("bling-init").append(function(j){var i,h;if(j==null){j=Object.create(null)}h={};i=function(k){return h[k]||(h[k]=[])};return d.inherit({emit:function(){var l,p,o,n,k,m;p=arguments[0],l=2<=arguments.length?e.call(arguments,1):[];m=i(p);for(n=0,k=m.length;n<k;n++){o=m[n];o.apply(this,l)}return this},addListener:function(l,k){i(l).push(k);return this.emit("newListener",l,k)},on:function(l,k){return this.addListener(l,k)},removeListener:function(m,l){var k;if((k=i(m).indexOf(l))>-1){return i(m).splice(k,1)}},removeAllListeners:function(k){return h[k]=[]},setMaxListeners:function(k){},listeners:function(k){return i(k).slice(0)}},j)})}}});d.plugin({depends:"dom,function,core",provides:"event"},function(){var j,o,h,k,m,i,n,l;j=/,* +/;k=["mousemove","mousedown","mouseup","mouseover","mouseout","blur","focus","load","unload","reset","submit","keyup","keydown","change","abort","cut","copy","paste","selection","drag","drop","orientationchange","touchstart","touchmove","touchend","touchcancel","gesturestart","gestureend","gesturecancel","hashchange"];h=function(p){return function(q){if(d.is("function",q)){return this.bind(p,q)}else{return this.trigger(p,q)}}};m=function(p,r,q,t,s){return d(r).bind(q,s).each(function(){var u,v;return((u=((v=(this.__alive__||(this.__alive__={})))[p]||(v[p]={})))[q]||(u[q]={}))[t]=s})};l=function(p,q,t,s){var r;r=d(q);return r.each(function(){var v,u,w;v=(this.__alive__||(this.__alive__={}));u=(v[p]||(v[p]={}));w=(u[t]||(u[t]={}));r.unbind(t,w[s]);return delete w[s]})};n=d.once(function(){var p;d(document).trigger("ready").unbind("ready");if(typeof document.removeEventListener==="function"){document.removeEventListener("DOMContentLoaded",n,false)}return typeof(p=d.global).removeEventListener==="function"?p.removeEventListener("load",n,false):void 0});o=d.once(function(){var p;if(typeof document.addEventListener==="function"){document.addEventListener("DOMContentLoaded",n,false)}return typeof(p=d.global).addEventListener==="function"?p.addEventListener("load",n,false):void 0});o();i={bind:function(r,q){var s,p;s=(r||"").split(j);p=function(t){i=q.apply(this,arguments);if(i===false){t.preventAll()}return i};return this.each(function(){var v,w,u,t;t=[];for(w=0,u=s.length;w<u;w++){v=s[w];t.push(this.addEventListener(v,p,false))}return t})},unbind:function(q,p){var r;r=(q||"").split(j);return this.each(function(){var u,v,t,s;s=[];for(v=0,t=r.length;v<t;v++){u=r[v];s.push(this.removeEventListener(u,p,null))}return s})},trigger:function(q,r){var w,s,v,p,u;if(r==null){r={}}r=d.extend({bubbles:true,cancelable:true},r);u=(q||"").split(j);for(v=0,p=u.length;v<p;v++){s=u[v];if(s==="click"||s==="mousemove"||s==="mousedown"||s==="mouseup"||s==="mouseover"||s==="mouseout"){w=document.createEvent("MouseEvents");r=d.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:null},r);w.initMouseEvent(s,r.bubbles,r.cancelable,d.global,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget)}else{if(s==="blur"||s==="focus"||s==="reset"||s==="submit"||s==="abort"||s==="change"||s==="load"||s==="unload"){w=document.createEvent("UIEvents");w.initUIEvent(s,r.bubbles,r.cancelable,d.global,1)}else{if(s==="touchstart"||s==="touchmove"||s==="touchend"||s==="touchcancel"){w=document.createEvent("TouchEvents");r=d.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,touches:[],targetTouches:[],changedTouches:[],scale:1,rotation:0},r);w.initTouchEvent(s,r.bubbles,r.cancelable,d.global,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.touches,r.targetTouches,r.changedTouches,r.scale,r.rotation)}else{if(s==="gesturestart"||s==="gestureend"||s==="gesturecancel"){w=document.createEvent("GestureEvents");r=d.extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,target:null,scale:1,rotation:0},r);w.initGestureEvent(s,r.bubbles,r.cancelable,d.global,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.target,r.scale,r.rotation)}else{w=document.createEvent("Events");w.initEvent(s,r.bubbles,r.cancelable);try{w=d.extend(w,r)}catch(t){d.log("Error in dispatch: ",t)}}}}}if(!w){continue}else{try{this.each(function(){return this.dispatchEvent(w)})}catch(t){d.log("dispatchEvent error:",t)}}}return this},delegate:function(p,s,r){var q;q=this;return m(p,q,s,r,function(t){return q.find(p).intersect(d(t.target).parents().first().union(d(t.target))).each(function(){return r.call(t.target=this,t)})})},undelegate:function(p,r,q){return this.unbind(r,l(p,this,r,q))},click:function(q){var p;if(q==null){q={}}if((p=this.css("cursor"))==="auto"||p===""){this.css("cursor","pointer")}if(d.is("function",q)){this.bind("click",q)}else{this.trigger("click",q)}return this},ready:function(p){if(n.exhausted){return p.call(this)}return this.bind("ready",p)}};k.forEach(function(p){return i[p]=h(p)});return i});d.plugin({provides:"function",depends:"hash"},function(){return{$:{identity:function(h){return h},not:function(h){return function(){return !h.apply(this,arguments)}},compose:function(i,h){return function(j){var k;return i.call(k,(k=h.call(j,j)))}},and:function(i,h){return function(j){return h.call(this,j)&&i.call(this,j)}},once:function(h,i){if(i==null){i=1}return d.defineProperty((function(){if(i-->0){return h.apply(this,arguments)}}),"exhausted",{get:function(){return i<=0}})},cycle:function(){var j,h;j=1<=arguments.length?e.call(arguments,0):[];h=-1;return function(){return j[h=++h%j.length].apply(this,arguments)}},bound:function(i,k,h){var j;if(h==null){h=[]}if(d.is("function",k.bind)){h.splice(0,0,i);j=k.bind.apply(k,h)}else{j=function(){var l;l=1<=arguments.length?e.call(arguments,0):[];return k.apply(i,h(h.length?void 0:l))}}return d.extend(j,{toString:function(){return"bound-method of "+i+"."+k.name}})},partial:function(){var h,i;i=arguments[0],h=2<=arguments.length?e.call(arguments,1):[];return function(){var j;j=1<=arguments.length?e.call(arguments,0):[];return i.apply(null,e.call(h).concat(e.call(j)))}}},partial:function(){var h;h=1<=arguments.length?e.call(arguments,0):[];return this.map(function(i){return d.partial.apply(d,[i].concat(e.call(h)))})}}});d.plugin({provides:"groupBy"},function(){return{groupBy:function(i){var h;h={};switch(d.type(i)){case"array":case"bling":this.each(function(){var l,j;l=((function(){var n,m,k;k=[];for(n=0,m=i.length;n<m;n++){j=i[n];k.push(this[j])}return k}).call(this)).join(",");return(h[l]||(h[l]=d())).push(this)});break;default:this.each(function(){var j;return(h[j=this[i]]||(h[j]=d())).push(this)})}return d.valuesOf(h)}}});d.plugin({provides:"hash",depends:"type"},function(){d.type.extend({unknown:{hash:function(h){return d.checksum(d.toString(h))}},object:{hash:function(j){var i,h;return d.hash(Object)+d((function(){var k;k=[];for(i in j){h=j[i];k.push(d.hash(i)+d.hash(h))}return k})()).sum()}},array:{hash:function(h){return d.hash(Array)+d(h.map(d.hash)).reduce(function(j,i){return(j*j)+(i|0)},1)}},bool:{hash:function(h){return parseInt(h?1:void 0)}}});return{$:{hash:function(h){return d.type.lookup(h).hash(h)}},hash:function(){return d.hash(this)}}});d.plugin(function(){return{$:{histogram:function(E,A,B){var q,o,w,z,s,v,y,t,r,l,u,D,k,F,p,j,h,C;if(A==null){A=1}if(B==null){B=60}q=d();z=0;t=Infinity;y=0;v=0;F=0;for(j=0,C=E.length;j<C;j++){p=E[j];t=Math.min(p,t);v=Math.max(p,v);F+=p;w=Math.floor(p/A);if(w in q){q[w]+=1}else{q[w]=1}z=Math.max(z,w+1)}q.length=z;y=F/E.length;s=q.max();q=q.or(0).scale(1/s).scale(B);k=q.sum();D="";u=0;for(r=h=0;h<z;r=h+=1){o=(r+1)*A;l=q[r]*100/k;u+=l;D+=d.padLeft(u.toFixed(2)+"%",7)+d.padRight(" < "+(o.toFixed(2)),10)+": "+d.repeat("#",q[r])+"\n"}return D+("N: "+E.length+" Min: "+(t.toFixed(2))+" Max: "+(v.toFixed(2))+" Mean: "+(y.toFixed(2)))}},histogram:function(){return d.histogram(this)}}});d.plugin({provides:"hook",depends:"type"},function(){var i,h;h={};i=function(l,k){var m,o,n,j;o=(h[l]||(h[l]=[]));if(!k){return{prepend:function(p){o.unshift(p);return p},append:function(p){o.push(p);return p}}}for(n=0,j=o.length;n<j;n++){m=o[n];k=m.call(this,k)}return k};i("bling-init").prepend(function(k){var j,l;if(k.length===1){k=d.type.lookup(k[0]).array(k[0])}j=d.inherit(g,k);if(k.length===0&&k[0]!==void 0){l=0;while(k[l]!==void 0){l++}j.length=l}return j});return{$:{hook:i}}});d.plugin({depends:"dom",provides:"http"},function(){var h;h=function(k){var j,l;l=JSON.parse(JSON.stringify(k));return((function(){var i;i=[];for(j in l){i.push(""+j+"="+(escape(l[j])))}return i})()).join("&")};d.type.register("http",{match:function(i){return d.isType("XMLHttpRequest",i)},array:function(i){return[i]}});return{$:{http:function(i,j){var k;if(j==null){j={}}k=new XMLHttpRequest();if(d.is("function",j)){j={success:d.bound(k,j)}}j=d.extend({method:"GET",data:null,state:d.identity,success:d.identity,error:d.identity,async:true,asBlob:false,timeout:0,followRedirects:false,withCredentials:false},j);j.state=d.bound(k,j.state);j.success=d.bound(k,j.success);j.error=d.bound(k,j.error);if(j.data&&j.method==="GET"){i+="?"+h(j.data)}else{if(j.data&&j.method==="POST"){j.data=h(j.data)}}k.open(j.method,i,j.async);k=d.extend(k,{asBlob:j.asBlob,timeout:j.timeout,followRedirects:j.followRedirects,withCredentials:j.withCredentials,onreadystatechange:function(){if(typeof j.state==="function"){j.state()}if(k.readyState===4){if(k.status===200){return j.success(k.responseText)}else{return j.error(k.status,k.statusText)}}}});k.send(j.data);return d(k)},post:function(i,j){if(j==null){j={}}if(d.is("function",j)){j={success:j}}j.method="POST";return d.http(i,j)},get:function(i,j){if(j==null){j={}}if(d.is("function",j)){j={success:j}}j.method="GET";return d.http(i,j)}}}});d.depends("hook",function(){return d.hook("bling-init").append(function(j){var h,i;i=Object.create(null);h=[];return d.inherit({index:function(k){if(h.indexOf(k)===-1){h.push(k);i[k]=Object.create(null)}return this.each(function(l){return i[k][k(l)]=l})},query:function(o){var m,l,n,k;for(n=0,k=h.length;n<k;n++){l=h[n];m=l(o);if(m in i[l]){return i[l][m]}}return null}},j)})});d.plugin({depends:"dom",provides:"lazy"},function(){var h;h=function(i,j){return d("head").append(d.extend(document.createElement(i),j))};return{$:{script:function(i){return h("script",{src:i})},style:function(i){return h("link",{href:i,rel:"stylesheet"})}}}});d.plugin({provides:"math",depends:"core"},function(){var k,h,j,i;d.type.extend({bool:{number:function(l){if(l){return 1}else{return 0}}},number:{bool:function(l){return !!l}}});i=function(l){return function(o){var n,m;n=(function(){switch(d.type(o)){case"string":return function(p){return p[o]};case"function":return o;default:throw new Error(".maxBy first argument should be a string or function")}})();m=this.first();this.skip(1).each(function(){if(l(n(this),n(m))){return m=this}});return m}};return{$:{range:function(o,l,n){var m;if(n==null){n=1}if(!(l!=null)){l=o;o=0}if(l<o&&n>0){n*=-1}return d((function(){var r,q,p;p=[];for(m=r=0,q=Math.ceil((l-o)/n);0<=q?r<q:r>q;m=0<=q?++r:--r){p.push(o+(m*n))}return p})())},zeros:function(m){var l;return d((function(){var o,n;n=[];for(l=o=0;0<=m?o<m:o>m;l=0<=m?++o:--o){n.push(0)}return n})())},ones:function(m){var l;return d((function(){var o,n;n=[];for(l=o=0;0<=m?o<m:o>m;l=0<=m?++o:--o){n.push(1)}return n})())},deg2rad:function(l){return l*Math.PI/180},rad2deg:function(l){return l*180/Math.PI}},floats:function(){return this.map(parseFloat)},ints:function(){return this.map(function(){return parseInt(this,10)})},px:function(l){return this.ints().map(function(){return d.px(this,l)})},min:function(){return this.filter(isFinite).reduce(Math.min)},max:function(){return this.filter(isFinite).reduce(Math.max)},maxBy:i(function(m,l){return m>l}),minBy:i(function(m,l){return m<l}),mean:h=function(){if(!this.length){return 0}else{return this.sum()/this.length}},avg:h,sum:function(){return this.filter(isFinite).reduce((function(l){return l+this}),0)},product:function(){return this.filter(isFinite).reduce(function(l){return l*this})},squares:function(){return this.pow(2)},pow:function(l){return this.map(function(){return Math.pow(this,l)})},magnitude:function(){return Math.sqrt(this.floats().squares().sum())},scale:function(l){return this.map(function(){return l*this})},add:k=function(m){var l;switch(d.type(m)){case"number":return this.map(function(){return m+this});case"bling":case"array":return d((function(){var p,o,n;n=[];for(l=p=0,o=Math.min(this.length,m.length);0<=o?p<o:p>o;l=0<=o?++p:--p){n.push(this[l]+m[l])}return n}).call(this))}},plus:k,sub:j=function(m){var l;switch(d.type(m)){case"number":return this.map(function(){return this-m});case"bling":case"array":return d((function(){var p,o,n;n=[];for(l=p=0,o=Math.min(this.length,m.length);0<=o?p<o:p>o;l=0<=o?++p:--p){n.push(this[l]-m[l])}return n}).call(this))}},minus:j,dot:function(l){var m;return d.sum((function(){var p,o,n;n=[];for(m=p=0,o=Math.min(this.length,l.length);0<=o?p<o:p>o;m=0<=o?++p:--p){n.push(this[m]*l[m])}return n}).call(this))},angle:function(l){return Math.acos(this.dot(l)/(this.magnitude()*l.magnitude()))},cross:function(l){return d(this[1]*l[2]-this[2]*l[1],this[2]*l[0]-this[0]*l[2],this[0]*l[1]-this[1]*l[0])},normalize:function(){return this.scale(1/this.magnitude())},deg2rad:function(){return this.filter(isFinite).map(function(){return this*Math.PI/180})},rad2deg:function(){return this.filter(isFinite).map(function(){return this*180/Math.PI})}}});d.plugin({depends:"function",provides:"memoize"},function(){return{$:{memoize:function(h){if(d.is("function",h)){h={f:h}}if(!d.is("object",h)){throw new Error("Argument Error: memoize requires either a function or object as first argument")}h.cache||(h.cache=Object.create(null));h.hash||(h.hash=d.identity);return function(){var j,i,k;return(k=(j=h.cache)[i=h.hash(arguments)])!=null?k:j[i]=h.f.apply(this,arguments)}}}}});d.plugin({depends:"core",provides:"pubsub"},function(){var h;h=(function(){function i(){this.listeners={}}i.prototype.publish=function(){var k,m,p,l,o,j,n;m=arguments[0],k=2<=arguments.length?e.call(arguments,1):[];n=((l=this.listeners)[m]||(l[m]=[]));for(o=0,j=n.length;o<j;o++){p=n[o];p.apply(null,k)}return k};i.prototype.publisher=function(l,k){var j;j=this;return function(){return j.publish(l,k.apply(this,arguments))}};i.prototype.subscribe=function(l,k){var j;((j=this.listeners)[l]||(j[l]=[])).push(k);return k};i.prototype.unsubscribe=function(n,m){var j,k,l;if(!(m!=null)){return this.listeners[n]=[]}else{j=((l=this.listeners)[n]||(l[n]=[]));if((k=j.indexOf(m))>-1){return j.splice(k,k)}}};return i})();return{$:d.extend(new h(),{Hub:h})}});d.plugin({provides:"random",depends:"type"},function(){var h;h="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");return{$:{random:(function(){var o,s,q,v,u,t,i,p,n,j,l,k,r,m;o=new Array(624);n=0;j=function(y){var z,A,w;n=0;o[0]=y;w=[];for(z=A=1;A<=623;z=++A){w.push(o[z]=4294967295&(1812433253*(o[z-1]^(o[z-1]>>>30))+z))}return w};p=function(){var z,B,A,w;w=[];for(z=A=0;A<=623;z=++A){B=((o[z]&2147483648)>>>31)+(2147483647&o[(z+1)%624]);o[z]=o[(z+397)%624]^(B>>>1);if((B%2)===1){w.push(o[z]=o[z]^2567483615)}else{w.push(void 0)}}return w};s=Math.pow(2,31);q=s*2;k=function(){var w;if(n===0){p()}w=o[n]^(w>>>11)^((w<<7)&&2636928640)^((w<<15)&&4022730752)^(w>>>18);n=(n+1)%624;return(w+s)/q};d.defineProperty(k,"seed",{set:function(w){return j(w)}});k.seed=+new Date();return d.extend(k,{real:r=function(z,y){var A,w;if(!(z!=null)){A=[0,1],z=A[0],y=A[1]}if(!(y!=null)){w=[0,z],z=w[0],y=w[1]}return(d.random()*(y-z))+z},integer:l=function(y,w){return Math.floor(d.random.real(y,w))},string:m=function(w,y){if(y==null){y=""}while(y.length<w){y+=d.random.element(h)}return y},coin:v=function(w){if(w==null){w=0.5}return d.random()<=w},element:function(B,F){var A,H,y,D,C,G,z,E;if(F!=null){G=d(F);G=G.scale(1/G.sum());A=0;D=d(B).map(function(w){return{v:w,w:G[A++]}}).sortBy(function(w){return -w.w});y=d.random.real(0.00001,0.999999);C=0;for(z=0,E=D.length;z<E;z++){H=D[z];if((C+=H.w)>=y){return H.v}}}return B[d.random.integer(0,B.length)]},gaussian:i=function(z,C){var D,B,A,w,E;if(z==null){z=0.5}if(C==null){C=0.12}while(true){B=d.random();A=1.7156*(d.random()-0.5);w=B-0.449871;E=Math.abs(A)+0.386595;D=(w*w)+E*(0.196*E-0.25472*w);if(!(D>0.27597&&(D>0.27846||(A*A)>(-4*Math.log(B)*B*B)))){break}}return z+C*A/B},dice:u=function(z,w){var y;return d((function(){var B,A;A=[];for(y=B=0;B<z;y=B+=1){A.push(t(w))}return A})())},die:t=function(w){return d.random.integer(1,w+1)}})})()}}});d.plugin({depends:"core",provides:"request-queue"},function(){var h;return{$:{RequestQueue:h=(function(){var i;function j(k){this.requester=(function(){if(k!=null){return k}else{try{return require("request")}catch(l){}}})();this.interval=null;this.queue=[]}j.prototype.tick=function(){var l,p,o,m,k;k=[];for(l=o=0,m=p=Math.min(this.queue.length,this.perTick);o<m;l=o+=1){k.push(this.requester.apply(this,this.queue.shift()))}return k};j.prototype.start=function(k,l){var m=this;this.perTick=k!=null?k:1;if(l==null){l=100}if(this.interval!=null){this.stop()}this.interval=setInterval((function(){return m.tick()}),l);return this};j.prototype.stop=i=function(){clearInterval(this.interval);this.interval=null;return this};j.prototype.close=i;j.prototype.request=function(){var k;k=1<=arguments.length?e.call(arguments,0):[];this.queue.push(k);return this};j.prototype.post=function(k,l){if(l==null){l=d.identity}this.queue.push([d.extend(k,{method:"POST"}),l]);return this};j.prototype.get=function(k,l){if(l==null){l=d.identity}this.queue.push([d.extend(k,{method:"GET"}),l]);return this};return j})()}}});d.plugin({provides:"sendgrid",depends:"config"},function(){var j,l,h,k;try{l=require("nodemailer")}catch(i){return}k=null;h=function(){return k||(k=l.createTransport("SMTP",{service:"SendGrid",auth:{user:d.config.get("SENDGRID_USERNAME"),pass:d.config.get("SENDGRID_PASSWORD")}}))};j=function(){if(k!=null){k.close()}return k=null};return{$:{sendMail:function(n,q){var o,m,p;if((o=n.transport)==null){n.transport=h()}if((m=n.from)==null){n.from=d.config.get("EMAILS_FROM")}if((p=n.bcc)==null){n.bcc=d.config.get("EMAILS_BCC")}if(d.config.get("SENDGRID_ENABLED","true")==="true"){return l.sendMail(n,function(r){if(n.close){j()}return q(r)})}else{if(n.close){j()}return q(false)}}}}});d.plugin({provides:"sortBy,sortedIndex"},function(){return{$:{sortedIndex:function(n,m,k){var l,i,j,h;l=(function(){switch(d.type(k)){case"string":return function(p,o){return p[k]-o[k]};case"function":return function(p,o){return k(p)-k(o)};default:return function(p,o){return p-o}}})();i=n.length;j=0;while(j<i){h=(i+j)>>>1;if(l(n[h],m)<0){j=h+1}else{i=h}}return j}},sortBy:function(j){var i,k,m,l,h;i=d();for(l=0,h=this.length;l<h;l++){k=this[l];m=d.sortedIndex(i,k,j);i.splice(m,0,k)}return i},sortedInsert:function(i,h){this.splice(d.sortedIndex(this,i,h),0,i);return this}}});d.plugin({provides:"string",depends:"function"},function(){var h;h=function(i){return function(){var j;j=1<=arguments.length?e.call(arguments,0):[];try{return i.apply(null,j)}catch(k){return"[Error: "+k.message+"]"}}};d.type.extend({unknown:{string:h(function(j){var i;return(i=typeof j.toString==="function"?j.toString():void 0)!=null?i:String(j)}),repr:h(function(i){return d.type.lookup(i).string(i)}),number:h(function(i){return parseFloat(String(i))})},"null":{string:function(){return"null"}},undefined:{string:function(){return"undefined"}},string:{number:h(parseFloat),repr:function(i){return"'"+i+"'"}},array:{string:h(function(j){var i;return"["+((function(){var m,l,k;k=[];for(m=0,l=j.length;m<l;m++){i=j[m];k.push(d.toString(i))}return k})()).join(",")+"]"})},object:{string:h(function(n){var j,l,i;l=[];for(j in n){try{i=n[j]}catch(m){i="[Error: "+m.message+"]"}l.push(""+j+":"+(d.toString(i)))}return"{"+l.join(", ")+"}"})},"function":{string:function(i){return i.toString().replace(/^([^{]*){(?:.|\n|\r)*}$/,"$1{ ... }")}},number:{repr:function(i){return String(i)},string:h(function(i){switch(true){case i.precision!=null:return i.toPrecision(i.precision);case i.fixed!=null:return i.toFixed(i.fixed);default:return String(i)}})}});return{$:{toString:function(i){if(!(i!=null)){return"function Bling(selector, context) { [ ... ] }"}else{try{return d.type.lookup(i).string(i)}catch(j){return"[Error: "+j.message+"]"}}},toRepr:function(i){return d.type.lookup(i).repr(i)},px:function(i,j){if(j==null){j=0}return(i!=null)&&(parseInt(i,10)+(j|0))+"px"},capitalize:function(i){return(i.split(" ").map(function(j){return j[0].toUpperCase()+j.substring(1).toLowerCase()})).join(" ")},dashize:function(k){var o,l,j,n,m;j="";for(l=n=0,m=(k!=null?k.length:void 0)|0;0<=m?n<m:n>m;l=0<=m?++n:--n){o=k.charCodeAt(l);if((91>o&&o>64)){o+=32;j+="-"}j+=String.fromCharCode(o)}return j},camelize:function(j){var k;j.split("-");while((k=j!=null?j.indexOf("-"):void 0)>-1){j=d.stringSplice(j,k,k+2,j[k+1].toUpperCase())}return j},padLeft:function(i,k,j){if(j==null){j=" "}while(i.length<k){i=j+i}return i},padRight:function(i,k,j){if(j==null){j=" "}while(i.length<k){i=i+j}return i},stringTruncate:function(j,m,l){var k,i;if(l==null){l="..."}j=j.split(" ");k=[];while(m>0){i=j.shift();m-=i.length;if(m>=0){k.push(i)}}return k.join("")+l},stringCount:function(o,k,m,p){var l;if(m==null){m=0}if(p==null){p=0}if((l=o.indexOf(k,m))>m-1){return d.stringCount(o,k,l+1,p+1)}else{return p}},stringSplice:function(o,m,l,r){var k,q,p;q=o.length;k=l;if(k<0){k+=q}p=m;if(p<0){p+=q}return o.substring(0,p)+r+o.substring(k)},checksum:function(m){var k,j,l,o,n;k=1;j=0;for(l=o=0,n=m.length;0<=n?o<n:o>n;l=0<=n?++o:--o){k=(k+m.charCodeAt(l))%65521;j=(j+k)%65521}return(j<<16)|k},repeat:function(i,j){if(j==null){j=2}switch(true){case j===1:return i;case j<1:return"";case d.is("string",i):return d.zeros(j).map(function(){return i}).join("");default:return d.zeros(j).map(function(){return i})}},stringBuilder:function(){var i,j=this;if(d.is("global",this)){return new d.stringBuilder()}i=[];this.length=0;this.append=function(k){i.push(k);return j.length+=(k!=null?k.toString().length:void 0)|0};this.prepend=function(k){i.splice(0,0,k);return j.length+=(k!=null?k.toString().length:void 0)|0};this.clear=function(){var k;k=j.toString();i=[];j.length=0;return k};this.toString=function(){return i.join("")};return this}},toString:function(){return d.toString(this)},toRepr:function(){return d.toRepr(this)}}});d.plugin({provides:"symbol",depends:"type"},function(){var h,i,j;j=null;h={};i=d.global;i.Bling=g;if(typeof module!=="undefined"&&module!==null){module.exports=g}d.defineProperty(d,"symbol",{set:function(k){i[j]=h[j];h[j=k]=i[k];return i[k]=g},get:function(){return j}});return{$:{symbol:"$",noConflict:function(){g.symbol="Bling";return g}}}});d.plugin({provides:"StateMachine"},function(){var h;return{$:{StateMachine:h=(function(){function i(j){this.debug=false;this.reset();this.table=j;Object.defineProperty(this,"modeline",{get:function(){return this.table[this._mode]}});Object.defineProperty(this,"mode",{set:function(k){var l;this._lastMode=this._mode;this._mode=k;if(this._mode!==this._lastMode&&(this.modeline!=null)&&"enter" in this.modeline){l=this.modeline.enter.call(this);while(d.is("function",l)){l=l.call(this)}}return k},get:function(){return this._mode}})}i.prototype.reset=function(){this._mode=null;return this._lastMode=null};i.prototype.GO=function(j){return function(){return this.mode=j}};i.GO=function(j){return function(){return this.mode=j}};i.prototype.tick=function(l){var j,k;k=this.modeline;if(!(k!=null)){j=null}else{if(l in k){j=k[l]}else{if("def" in k){j=k.def}}}while(d.is("function",j)){j=j.call(this,l)}return j};i.prototype.run=function(k){var o,l,n,j,m;this.mode=0;for(n=0,j=k.length;n<j;n++){o=k[n];l=this.tick(o)}if(d.is("function",(m=this.modeline)!=null?m.eof:void 0)){l=this.modeline.eof.call(this)}while(d.is("function",l)){l=l.call(this)}this.reset();return this};return i})()}}});d.plugin({provides:"synth",depends:"StateMachine, type"},function(){var h;h=(function(k){var i;b(j,k);i={"#":j.GO(2),".":j.GO(3),"[":j.GO(4),'"':j.GO(6),"'":j.GO(7)," ":j.GO(8),",":j.GO(10),"+":j.GO(11),eof:j.GO(13)};j.STATE_TABLE=[{enter:function(){this.tag=this.id=this.cls=this.attr=this.val=this.text="";this.attrs={};return this.GO(1)}},d.extend({def:function(l){return this.tag+=l}},i),d.extend({def:function(l){return this.id+=l}},i),d.extend({enter:function(){if(this.cls.length>0){return this.cls+=" "}},def:function(l){return this.cls+=l}},i),{"=":j.GO(5),"]":function(){this.attrs[this.attr]=this.val;this.attr=this.val="";return this.GO(1)},def:function(l){return this.attr+=l},eof:j.GO(12)},{"]":function(){this.attrs[this.attr]=this.val;this.attr=this.val="";return this.GO(1)},def:function(l){return this.val+=l},eof:j.GO(12)},{'"':j.GO(8),def:function(l){return this.text+=l},eof:j.GO(12)},{"'":j.GO(8),def:function(l){return this.text+=l},eof:j.GO(12)},{enter:function(){if(this.tag){this.emitNode()}if(this.text){this.emitText()}return this.GO(0)}},{},{enter:function(){this.emitNode();this.cursor=null;return this.GO(0)}},{enter:function(){var l;this.emitNode();this.cursor=(l=this.cursor)!=null?l.parentNode:void 0;return this.GO(0)}},{enter:function(){throw new Error("Error in synth expression: "+this.input)}},{enter:function(){if(this.tag){this.emitNode()}if(this.text){return this.emitText()}}}];function j(){j.__super__.constructor.call(this,j.STATE_TABLE);this.fragment=this.cursor=document.createDocumentFragment()}j.prototype.emitNode=function(){var l,m;if(this.tag){m=document.createElement(this.tag);m.id=this.id||null;m.className=this.cls||null;for(l in this.attrs){m.setAttribute(l,this.attrs[l])}this.cursor.appendChild(m);return this.cursor=m}};j.prototype.emitText=function(){this.cursor.appendChild(d.type.lookup("<html>").node(this.text));return this.text=""};return j})(d.StateMachine);return{$:{synth:function(j){var i;i=new h();i.run(j);if(i.fragment.childNodes.length===1){return d(i.fragment.childNodes[0])}else{return d(i.fragment)}}}}});(function(i){var h;i.plugin(function(){var j,l,k;j=null;l={};k={register_engine:function(m,n){l[m]=n;if(!(j!=null)){return j=m}},render:function(n,m){if(j in l){return l[j](n,m)}}};k.__defineSetter__("engine",function(m){if(!m in l){throw new Error("invalid template engine: "+m+" not one of "+(Object.Keys(l)))}else{return j=m}});k.__defineGetter__("engine",function(){return j});return{name:"Template",$:{template:k}}});i.template.register_engine("null",(function(){return function(k,j){return k}})());h=function(q,o,k,j,p){var n,m,r,l;if(p==null){p=-1}n=1;if(p<0){p=q.length+1+p}for(m=l=j;l<p;m=l+=1){r=q[m];if(r===k){n+=1}else{if(r===o){n-=1}}if(n===0){return m}}return -1};i.template.register_engine("pythonic",(function(){var l,m,k,j;j=/([0-9#0+-]*)\.*([0-9#+-]*)([diouxXeEfFgGcrsqm])((?:.|\n)*)/;l=/%[\(\/]/;m=function(z){var v,q,t,s,y,u,p,o,w,r;v=z.split(l);p=v.length;w=[v[0]];s=1;for(t=r=1;r<p;t=r+=1){q=h(v[t],")","(",0,-1);if(q===-1){return"Template syntax error: unmatched '%(' starting at: "+(v[t].substring(0,15))}y=v[t].substring(0,q);o=v[t].substring(q);u=j.exec(o);if(u===null){return"Template syntax error: invalid type specifier starting at '"+o+"'"}o=u[4];w[s++]=y;w[s++]=u[1]|0;w[s++]=u[2]|0;w[s++]=u[3];w[s++]=o}return w};m.cache={};k=function(E,D){var o,u,z,w,C,r,q,s,p,A,B,v,y,t;o=m.cache[E];if(!(o!=null)){o=m.cache[E]=m(E)}q=[o[0]];w=1;r=o.length;for(z=v=1,y=r-5;v<=y;z=v+=5){t=o.slice(z,+(z+4)+1||9000000000),C=t[0],s=t[1],u=t[2],A=t[3],p=t[4];B=D[C];if(!(B!=null)){B="missing value: "+C}switch(A){case"d":q[w++]=""+parseInt(B,10);break;case"f":q[w++]=parseFloat(B).toFixed(u);break;case"s":q[w++]=""+B;break;default:q[w++]=""+B}if(s>0){q[w]=String.PadLeft(q[w],s)}q[w++]=p}return q.join("")};return k})());return i.template.register_engine("js-eval",(function(){var j;j=(function(l){b(k,l);function k(){return k.__super__.constructor.apply(this,arguments)}k.STATE_TABLE=[{enter:function(){this.data=[];return this.GO(1)}},{}];return k})(i.StateMachine);return function(l,k){return l}})())})(g);d.plugin({provides:"throttle",depends:"core"},function(){return{$:{throttle:function(h,j){var i;i=0;return function(){var k,l;k=1<=arguments.length?e.call(arguments,0):[];l=d.now-i;if(l>h){i+=l;return j.apply(this,k)}return null}},debounce:function(h,j){var i;i=0;return function(){var k,l;k=1<=arguments.length?e.call(arguments,0):[];i+=(l=d.now-i);return j.apply(this,k(l>h?void 0:null))}}}}});d.plugin({depends:"type",provides:"TNET"},function(){var j,i,h;h=function(p){var l,m,o,k,n;m=p.indexOf(":");if(m>0){k=parseInt(p.slice(0,m),10);o=p.slice(m+1,m+1+k);n=p[m+1+k];l=p.slice(m+k+2);o=(function(){switch(n){case"#":return Number(o);case"'":return String(o);case"!":return o==="true";case"~":return null;case"]":return j(o);case"}":return i(o)}})();return[o,l]}return void 0};j=function(k){var n,l,m;n=[];while(k.length>0){m=h(k),l=m[0],k=m[1];n.push(l)}return n};i=function(l){var p,m,o,n,k;p={};while(l.length>0){n=h(l),m=n[0],l=n[1];k=h(l),o=k[0],l=k[1];p[m]=o}return p};return{$:{TNET:{stringify:function(k){var n,l,o,m;m=(function(){switch(d.type(k)){case"number":return[String(k),"#"];case"string":return[k,"'"];case"function":return[String(k),"'"];case"boolean":return[String(!!k),"!"];case"null":return["","~"];case"undefined":return["","~"];case"array":return[((function(){var r,q,p;p=[];for(r=0,q=k.length;r<q;r++){o=k[r];p.push(d.TNET.stringify(o))}return p})()).join(""),"]"];case"object":return[((function(){var p;p=[];for(o in k){p.push(d.TNET.stringify(o)+d.TNET.stringify(k[o]))}return p})()).join(""),"}"]}})(),n=m[0],l=m[1];return(n.length|0)+":"+n+l},parse:function(k){var l;return(l=h(k))!=null?l[0]:void 0}}}}});d.plugin({provides:"trace",depends:"function,type"},function(){d.type.extend({unknown:{trace:d.identity},object:{trace:function(l,p,j){var i,n,h,m;m=Object.keys(p);for(n=0,h=m.length;n<h;n++){i=m[n];p[i]=d.trace(p[i],""+l+"."+i,j)}return p}},array:{trace:function(j,n,h){var k,m,l;for(k=m=0,l=n.length;m<l;k=m+=1){n[k]=d.trace(n[k],""+j+"["+k+"]",h)}return n}},"function":{trace:function(i,k,h){var j;i||(i=k.name);j=function(){var l;l=1<=arguments.length?e.call(arguments,0):[];h(""+(this.name||d.type(this))+"."+i+"("+(d(l).map(d.toRepr).join(","))+")");return k.apply(this,l)};j.toString=function(){return"{Trace '"+i+"' of "+(k.toString())};return j}}});return{$:{trace:function(i,k,h){var j;if(!d.is("string",i)){j=[k,i],h=j[0],k=j[1]}h||(h=d.log);i||(i="");return d.type.lookup(k).trace(i,k,h)}}}});d.plugin({depends:"dom"},function(){var l,h,j,p,m,k,o,n,i;l=", ";j={slow:700,medium:500,normal:300,fast:100,instant:0,now:0};h=/(?:scale(?:3d)*|translate(?:[XYZ]|3d)*|rotate(?:[XYZ]|3d)*)/;i=30;p=document.createElement("div").style;m="transform";o="transition-property";k="transition-duration";n="transition-timing-function";if("WebkitTransform" in p){m="-webkit-transform";o="-webkit-transition-property";k="-webkit-transition-duration";n="-webkit-transition-timing-function"}else{if("MozTransform" in p){m="-moz-transform";o="-moz-transition-property";k="-moz-transition-duration";n="-moz-transition-timing-function"}else{if("OTransform" in p){m="-o-transform";o="-o-transition-property";k="-o-transition-duration";n="-o-transition-timing-function"}}}return{$:{duration:function(q){var r;r=j[q];if(r!=null){return r}return parseFloat(q)}},transform:function(v,q,u,y){var t,r,s,z,w,A;if(d.is("function",q)){y=q;q=u=null}else{if(d.is("function",u)){y=u;u=null}}if(q==null){q="normal"}u||(u="ease");r=d.duration(q)+"ms";w=[];A="";t={};for(s in v){if(h.test(s)){z=v[s];if(z.join){z=d(z).px().join(l)}else{if(z.toString){z=z.toString()}}A+=" "+s+"("+z+")"}else{t[s]=v[s]}}for(s in t){w.push(s)}if(A){w.push(m)}t[o]=w.join(l);t[k]=w.map(function(){return r}).join(l);t[n]=w.map(function(){return u}).join(l);if(A){t[m]=A}this.css(t);if(y){return this.delay(r,y)}},hide:function(q){this.each(function(){if(this.style){this._display="";if(this.style.display===!"none"){this._display=this.syle.display}return this.style.display="none"}}).trigger("hide");if(q){this.delay(i,q)}return this},show:function(q){this.each(function(){if(this.style){this.style.display=this._display;return delete this._display}}).trigger("show");if(q){this.delay(i,q)}return this},toggle:function(q){return this.weave(this.css("display")).fold(function(s,r){if(s==="none"){r.style.display=r._display||"";delete r._display;d(r).trigger("show")}else{r._display=s;r.style.display="none";d(r).trigger("hide")}return r}).delay(i,q)},fadeIn:function(q,r){return this.css("opacity","0.0").show(function(){return this.transform({opacity:"1.0",translate3d:[0,0,0]},q,r)})},fadeOut:function(r,t,q,s){if(q==null){q=0}if(s==null){s=0}return this.transform({opacity:"0.0",translate3d:[q,s,0]},r,function(){return this.hide(t)})},fadeLeft:function(q,r){return this.fadeOut(q,r,"-"+this.width().first(),0)},fadeRight:function(q,r){return this.fadeOut(q,r,this.width().first(),0)},fadeUp:function(q,r){return this.fadeOut(q,r,0,"-"+this.height().first())},fadeDown:function(q,r){return this.fadeOut(q,r,0,this.height().first())}}});d.plugin({provides:"type"},function(){var i,j,h;j=function(k,l){if(!(l!=null)){return k===l||k==="null"||k==="undefined"}else{return((l.constructor!=null)&&(l.constructor===k||l.constructor.name===k))||Object.prototype.toString.apply(l)===("[object "+k+"]")||j(k,l.__proto__)}};i=function(k,l){if(typeof k==="function"){k=k.prototype}if(k.__proto__===Object.prototype){k.__proto__=l.__proto__}l.__proto__=k;return l};h=(function(){var o,l,p,k,n,m;l={};o={name:"unknown",match:function(q){return true}};k=[];n=function(q,r){if(!(q in l)){k.unshift(q)}l[r.name=q]=o!==r?i(o,r):r;return l[q][q]=function(s){return s}};m=function(s,u){var r,t,q;if(typeof s==="string"){if((t=l[s])==null){l[s]=n(s,{})}return l[s]=f(l[s],u)}else{if(typeof s==="object"){q=[];for(r in s){q.push(m(r,s[r]))}return q}}};p=function(u){var r,t,q,s;for(t=0,q=k.length;t<q;t++){r=k[t];if((s=l[r])!=null?s.match.call(u,u):void 0){return l[r]}}};n("unknown",o);n("object",{match:function(){return typeof this==="object"}});n("error",{match:function(){return j("Error",this)}});n("regexp",{match:function(){return j("RegExp",this)}});n("string",{match:function(){return typeof this==="string"||j(String,this)}});n("number",{match:function(){return(j(Number,this))&&this!==NaN}});n("bool",{match:function(){return typeof this==="boolean"||(function(){var q;try{return(q=String(this))==="true"||q==="false"}catch(r){}}).call(this)}});n("array",{match:Array.isArray||function(){return j(Array,this)}});n("function",{match:function(){return typeof this==="function"}});n("global",{match:function(){return typeof this==="object"&&"setInterval" in this}});n("undefined",{match:function(q){return q===void 0}});n("null",{match:function(q){return q===null}});return f((function(q){return p(q).name}),{register:n,lookup:p,extend:m,is:function(q,s){var r;return(r=l[q])!=null?r.match.call(s,s):void 0},as:function(){var u,s,q,r;q=arguments[0],u=arguments[1],s=3<=arguments.length?e.call(arguments,2):[];return typeof(r=p(u))[q]==="function"?r[q].apply(r,[u].concat(e.call(s))):void 0}})})();h.extend({unknown:{array:function(k){return[k]}},"null":{array:function(k){return[]}},undefined:{array:function(k){return[]}},array:{array:function(k){return k}},number:{array:function(k){return g.extend(new Array(k),{length:0})}}});h.register("bling",{match:function(k){return k&&j(g,k)},array:function(k){return k.toArray()},hash:function(k){return k.map(g.hash).reduce(function(m,l){return(m*m)+l})},string:function(k){return g.symbol+"(["+k.map(function(l){return d.type.lookup(l).string(l)}).join(", ")+"])"},repr:function(k){return g.symbol+"(["+k.map(function(l){return d.type.lookup(l).repr(l)}).join(", ")+"])"}});return{$:{inherit:i,extend:f,defineProperty:function(m,k,l){Object.defineProperty(m,k,f({configurable:true,enumerable:true},l));return m},isType:j,type:h,is:h.is,as:h.as,isSimple:function(l){var k;return(k=h(l))==="string"||k==="number"||k==="bool"},isEmpty:function(k){return(k===""||k===null||k===(void 0))||k.length===0||(typeof k==="object"&&Object.keys(k).length===0)}},defineProperty:function(k,l){return this.each(function(){return d.defineProperty(this,k,l)})}}});d.plugin({depends:"math",provides:"units"},function(){var q,p,k,h,l,o,n,i,j,m;m=d(["px","pt","pc","em","%","in","cm","mm","ex","lb","kg","yd","ft","m",""]);q=null;(n=function(){var r;r=m.filter(/.+/).join("|");return q=new RegExp("(\\d+\\.*\\d*)((?:"+r+")/*(?:"+r+")*)")})();i=function(r){if(q.test(r)){return q.exec(r)[2]}return""};p=function(v,t){var u,s,z,y,w,r;w=v.split("/"),z=w[0],u=w[1];r=t.split("/"),y=r[0],s=r[1];if((u!=null)&&(s!=null)){return p(s,u)*p(z,y)}if(v in p){if(t in p[v]){return p[v][t]()}}return 0};o=function(r){return function(){return r}};h=function(){};j=function(t,s,r){p[t]||(p[t]={});p[t][s]=r;if(m.indexOf(t)===-1){m.push(t)}if(m.indexOf(s)===-1){m.push(s)}n();return h()};l=function(){j("pc","pt",function(){return 12});j("in","pt",function(){return 72});j("in","px",function(){return 96});j("in","cm",function(){return 2.54});j("m","ft",function(){return 3.281});j("yd","ft",function(){return 3});j("cm","mm",function(){return 10});j("m","cm",function(){return 100});j("m","meter",function(){return 1});j("m","meters",function(){return 1});j("ft","feet",function(){return 1});j("km","m",function(){return 1000});j("em","px",function(){var s,r;s=0;try{r=d("<span style='font-size:1em;visibility:hidden'>x</span>").appendTo("body");s=r.width().first();r.remove()}catch(t){}return s});j("ex","px",function(){var s,r;s=0;try{r=d("<span style='font-size:1ex;visibility:hidden'>x</span>").appendTo("body");s=r.width().first();r.remove()}catch(t){}return s});j("ex","em",function(){return 2});j("rad","deg",function(){return 57.3});j("s","sec",function(){return 1});j("s","ms",function(){return 1000});j("ms","ns",function(){return 1000000});j("min","sec",function(){return 60});j("hr","min",function(){return 60});j("hr","hour",function(){return 1});j("hr","hours",function(){return 1});j("day","hr",function(){return 24});j("day","days",function(){return 1});j("y","year",function(){return 1});j("y","years",function(){return 1});j("y","d",function(){return 365.25});j("g","gram",function(){return 1});j("g","grams",function(){return 1});j("kg","g",function(){return 1000});j("lb","g",function(){return 453.6});j("lb","oz",function(){return 16});j("f","frame",function(){return 1});j("f","frames",function(){return 1});j("sec","f",function(){return 60});(h=function(){var E,C,A,B,z,y,w,v,u,D,t,s,r;p[""]={};z=o(1);for(y=0,D=m.length;y<D;y++){E=m[y];p[E]||(p[E]={});p[E][E]=p[E][""]=p[""][E]=z}B=1;while(B>0){B=0;for(w=0,t=m.length;w<t;w++){E=m[w];if(!(E!=="")){continue}p[E]||(p[E]={});for(v=0,s=m.length;v<s;v++){C=m[v];if(!(C!=="")){continue}if((!p(E,C))&&(p(C,E))){p[E][C]=o(1/p(C,E));B+=1}for(u=0,r=m.length;u<r;u++){A=m[u];if(A!==""){if((p(E,C))&&(p(C,A))&&(!p(E,A))){p[E][A]=o(p(E,C)*p(C,A));B+=1}}}}}}return null})();return d.units.enable=function(){}};k=function(t,s){var w,v,r;v=parseFloat(t);r=i(t);w=p(r,s);if(!(isFinite(w)&&isFinite(v))){return t}return""+(v*w)+s};d.type.register("units",{match:function(r){return typeof r==="string"&&q.test(r)},number:function(r){return parseFloat(r)},string:function(r){return"'"+r+"'"}});return{$:{units:{enable:l,set:j,get:p,convertTo:function(r,s){return k(s,r)}}},convertTo:function(r){return this.map(function(s){return k(s,r)})},unitMap:function(r){return this.map(function(s){var t;return r.call((t=parseFloat(s)),t)+i(s)})}}});d.plugin({provides:"unittest",depends:"core,function"},function(){var m,j,k,i,l,h;l=i=m=0;j=[];k=function(u,p,s){var o,t,n,r;if(!d.is("function",s)){return}r=function(v){return d.log(""+u+": "+p+"... "+v)};n=p.toLowerCase().indexOf("fail")!==-1;o=d.once(function(v){l--;if(!!v!==n){r("fail: "+v);m++;return j.push(p)}else{r("pass");i++;return d.provide(p)}});t=function(v){try{return s(v)}catch(w){return v(w)}finally{if(p.toLowerCase().indexOf("async")===-1){v()}}};l++;try{return t(o)}catch(q){return o(q)}};h=d.once(function(){d.log("Passed: "+i+" Failed: "+m+" ["+j+"]");if(m>0){try{return process.exit(m)}catch(n){}}});return{$:{approx:function(o,n,p){if(p==null){p=0.1}return Math.abs(o-n)<p},assert:function(o,n){if(n==null){n="no message"}if(!o){throw new Error("Assertion failed: "+n)}},assertEqual:function(o,n,p){if(o!==n){throw Error(""+(p||"")+" ("+(o!=null?o.toString():void 0)+") should equal ("+(n!=null?n.toString():void 0)+")")}},assertArrayEqual:function(p,n,q){var r,u,t,o;o=[];for(r=u=0,t=p.length;u<t;r=u+=1){try{o.push(d.assertEqual(p[r],n[r],q))}catch(s){throw Error(""+(q||"")+" "+(p!=null?p.toString():void 0)+" should equal "+(n!=null?n.toString():void 0))}}return o},testGroup:function(r,q){var s,p,o,n;p=setInterval((function(){if(l===0){clearInterval(p);return h()}}),50);n=[];for(o in q){s=q[o];n.push(k(r,o,s))}return n}},assertEqual:function(){var n,o,p,r,q,s=this;o=1<=arguments.length?e.call(arguments,0):[];if(o.length>1){o=o.map(function(t){if(d.is("function",t)){return t.call(s,s)}else{return t}});n=o[0];for(p=r=1,q=o.length;1<=q?r<q:r>q;p=1<=q?++r:--r){d.assertEqual(n,o[p])}}return this}}});d.plugin({depends:"dialog",provides:"wizard"},function(){return{$:{wizard:function(){var o,p,h,r,n,j,i,l,q,m,k;i=1<=arguments.length?e.call(arguments,0):[];if(i.length===1&&((m=d.type(i[0]))==="array"||m==="bling")){i=i[0]}o=0;r=d.dialog(i[0]).select("parentNode");h=[];j=function(s){if(!i.length){return d.identity}return function(){var u,w,y,t,v;t=(o+s)%i.length;while(t<0){t+=i.length}if(t===o){return}u=d(h[o]);w=d(h[t]);v=u.width()[0];y=s<0?window.innerWidth-v:0;u.removeClass("wiz-active").css({left:d.px(y)}).fadeOut();w.addClass("wiz-active").centerOn(r).fadeIn();return o=t}};r.delegate(".wiz-next","click",j(+1));r.delegate(".wiz-back","click",j(-1));k=i.slice(1);for(l=0,q=k.length;l<q;l++){n=k[l];p=d.synth("div.dialog div.title + div.content").css({left:d.px(window.innerWidth+100)}).hide().appendTo(r);n=d.extend(d.dialog.getDefaultOptions(),n);p.find(".title").append(d.dialog.getContent(n.titleType,n.title));p.find(".content").append(d.dialog.getContent(n.contentType,n.content))}h=r.find(".dialog");h.take(1).show();return r}}}})}).call(this);