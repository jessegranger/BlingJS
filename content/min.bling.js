Object.Extend=function(e,h,c){for(var f in h)if(c&&e[f]!=undefined)for(var a in c)e[f][a]=h[f][a];else e[f]=h[f];return e};Object.Keys=function(e){var h=[],c=0,f;for(f in e)h[c++]=f;return h};Object.Extend(Function.prototype,{inherit:function(e){this.prototype=new e;return this.prototype.constructor=this},bound:function(e,h){function c(){return f.apply(e,h?h:arguments)}var f=this;c.toString=function(){return"bound-method of "+e+"."+f.name+"(...) { [code] }"};return c}});
function Bling(e,h){if(isBling(e))return e;h=h||document;var c=null;if(e==null)c=[];else if(typeof e==="number")c=Array(e);else if(e===window||isNode(e))c=[e];else if(typeof e==="string"){e=e.trimLeft();if(e[0]=="<")c=[Bling.HTML.parse(e)];else if(isBling(h))c=h.reduce(function(a,b){for(var d=b.querySelectorAll(e),g=0,j=d.length;g<j;g++)a.push(d[g]);return a},[]);else if(h.querySelectorAll!=undefined)try{c=h.querySelectorAll(e)}catch(f){throw Error("invalid selector: "+e,f);}else throw Error("invalid context: "+
h);}else c=e;c.__proto__=Bling.prototype;c.selector=e;c.context=h;return c}Bling.inherit(Array);function isBling(e){return isType(e,Bling)}$=Bling;Bling.symbol="$";
Object.Extend(window,{isType:function(e,h){return!e?h===e:typeof h==="string"?e.__proto__.constructor.name==h:e.__proto__.constructor===h},isSubtype:function(e,h){return e==null?e==h:e.__proto__==null?false:typeof h==="string"?e.__proto__.constructor.name==h:e.__proto__.constructor==h?true:isSubtype(e.__proto__,h)},isString:function(e){return typeof e=="string"||isSubtype(e,String)},isNumber:isFinite,isFunc:function(e){return typeof e=="function"||isType(e,Function)},isNode:function(e){return e?e.nodeType>
0:false},isFragment:function(e){return e?e.nodeType==11:false},isArray:function(e){return e?Function.ToString(e)=="[object Array]"||isSubtype(e,Array):false},isObject:function(e){return typeof e=="object"},hasValue:function(e){return e!=null}});var OtoS=Object.prototype.toString;Array.Slice=function(e,h,c){var f=[],a=0,b=e.length;c=c==undefined?b:c<0?b+c:c;for(h=h==undefined?0:h<0?b+h:h;h<c;)f[a++]=e[h++];return f};Number.Px=function(e,h){return parseInt(e)+(h|0)+"px"};
Object.Extend(String,{HtmlEscape:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\t/g,"&nbsp;&nbsp;")},PadLeft:function(e,h,c){for(c=c||" ";e.length<h;)e=c+e;return e},Splice:function(){var e=arguments[0],h=arguments[1],c=arguments[2],f=Array.Slice(arguments,3).join("");return e.substring(0,h)+f+e.substring(c)}});
Object.Extend(Function,{Empty:function(){},NotNull:function(e){return e!=null},NotUndefined:function(e){return e!=undefined},IndexFound:function(e){return e>-1},ReduceAnd:function(e){return e&&this},UpperLimit:function(e){return function(h){return Math.min(e,h)}},LowerLimit:function(e){return function(h){return Math.max(e,h)}},ToString:function(e){return OtoS.apply(e)},Px:function(e){return function(){return Number.Px(this,e)}},PrettyPrint:function(){function e(j){var k=0,o=j.length,m=[],q=-1,n=-1,
p=null;if(!isString(j))if(isFunc(j.toString)){j=j.toString();o=j.length}else throw TypeError("invalid string argument to extract_quoted");for(;k<o;){q=j;n=k;p=q.indexOf('"',n);n=q.indexOf("'",n);if(p==-1)p=q.length;if(n==-1)n=q.length;p=p==n?[null,-1]:p<n?['"',p]:["'",n];q=p[1];if(q==-1){m.push(j.substring(k));break}m.push(j.substring(k,q));k=j;n=p[0];for(var l=k.indexOf(n,q+1);k.charAt(l-1)=="\\"&&l<k.length&&l>0;)l=k.indexOf(n,l+1);n=l;if(n==-1)throw Error("unmatched "+p[0]+" at "+q);m.push(j.substring(q,
n+1));k=n+1}return m}function h(j){for(var k=[],o=0,m=0,q=j.length,n=null,p=null;o<q;){n=p=j.substring(o);m=n.match(a);n=n.match(b);n=m==n?[-1,null]:m==null&&n!=null?[n.index,n[0]]:m!=null&&n==null?[m.index,m[0]]:n.index<m.index?[n.index,n[0]]:[m.index,m[0]];m=n[0];if(m>-1){k.push(p.substring(0,m));k.push(n[1]);o+=m+n[1].length}else{k.push(p);break}}return k}var c=/!==|!=|!|\#|\%|\%=|\&|\&\&|\&\&=|&=|\*|\*=|\+|\+=|-|-=|->|\.{1,3}|\/|\/=|:|::|;|<<=|<<|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\?|@|\[|\]|}|{|\^|\^=|\^\^|\^\^=|\|=|\|\|=|\|\||\||~/g,
f=/\b[Ff]unction\b|\bvar\b|\.prototype\b|\.__proto__\b|\bString\b|\bArray\b|\bNumber\b|\bObject\b|\bbreak\b|\bcase\b|\bcontinue\b|\bdelete\b|\bdo\b|\bif\b|\belse\b|\bfinally\b|\binstanceof\b|\breturn\b|\bthrow\b|\btry\b|\btypeof\b|\btrue\b|\bfalse\b/g,a=/\/\/.*?(?:\n|$)/,b=/\/\*(?:.|\n)*?\*\//,d=/\d+\.*\d*/g,g=/\$(?:\(|\.)/g;return function(j,k){if(isFunc(j))j=j.toString();if(!isString(j))throw TypeError("prettyPrint requires a function or string to format");if($("style#pp-injected").length==0){k=
Object.Extend({opr:"#880",str:"#008",com:"#080",kwd:"#088",num:"#808",bln:"#800"},k);var o="code.pp .bln { font-size: 17px; } ",m;for(m in k)o+="code.pp ."+m+" { color: "+k[m]+"; }";$("head").append($.synth("style#pp-injected").text(o))}return"<code class='pp'>"+$(h(j)).fold(function(q,n){return $(e(q)).fold(function(p,l){return p.replace(c,"<span class='opr'>$&</span>").replace(d,"<span class='num'>$&</span>").replace(f,"<span class='kwd'>$&</span>").replace(g,"<span class='bln'>$$</span>(").replace(/\t/g,
"&nbsp;&nbsp;")+(l?"<span class='str'>"+l+"</span>":"")}).join("")+(n?"<span class='com'>"+n+"</span>":"")}).join("")+"</code>"}}()});Bling.addOps=function(){for(var e=0,h=arguments.length;e<h;e++){var c=arguments[e];if(isFunc(c))if(c.name==null)throw Error("cannot add an anonymous method (must have a name)");else Bling.prototype[c.name]=c;else if(isObject(c))Object.Extend(Bling.prototype,c);else throw Error("can only add an object or function, not:"+typeof c);}};
Bling.module=function(e,h){var c=h(),f=arguments.callee;f.order.push(e);f[e]=c;Bling.addOps(c)};Bling.module.order=[];
Bling.module("Core",function(){function e(a){if(isObject(a)&&isNumber(a))return Number(a);return a}function h(a){var b;return function(){b=this[a];return isFunc(b)?b.bound(this):b}}function c(a){var b=a.indexOf(".");return b>-1?this.zip(a.substr(0,b)).zip(a.substr(b+1)):this.map(h(a))}var f=new function(){this.queue=[];this.next=function(){this.queue.length>0&&this.queue.shift()()}.bound(this);this.schedule=function(a,b){if(isFunc(a)){var d=this.queue.length;a.order=b+(new Date).getTime();if(d==0||
a.order>this.queue[d-1].order)this.queue[d]=a;else for(var g=0;g<d;g++)this.queue[g].order>a.order&&this.queue.splice(g,0,a);setTimeout(this.next,b)}}};return{each:function(a){for(var b=-1,d=this.len(),g=null;++b<d;){g=this[b];a.call(g,g)}return this},map:function(a){var b=this.len(),d=Bling(b),g=0,j=null,k=true;d.context=this;for(d.selector=a;g<b;g++){j=this[g];if(k)try{d[g]=a.call(j,j)}catch(o){if(isType(o,TypeError)){k=false;g--}else d[g]=o}else try{d[g]=a(j)}catch(m){d[g]=m}}return d},reduce:function(a,
b){if(!a)return this;var d=b,g=this;if(b==null){d=this[0];g=this.skip(1)}g.each(function(){d=a.call(this,d,this)});return d},union:function(a){var b=Bling(),d=0,g=0,j=null;b.context=this.context;b.selector=this.selector;for(this.each(function(){b[d++]=this});j=a[g++];)b.contains(j)||(b[d++]=j);return b},intersect:function(a){var b=Bling(),d=0,g=0,j=this.length,k=a.length;b.context=this.context;b.selector=this.selector;if(isBling(a))for(;d<j;d++){if(a.contains(this[d]))b[b.length]=this[d]}else for(d=
0;d<j;d++)for(;g<k;g++)if(this[d]==a[g])b[b.length]=this[d];return b},distinct:function(){return this.union(this)},contains:function(a){return this.count(a)>0},count:function(a){if(a==undefined)return this.len();a=e(a);if(isObject(a)&&isNumber(a))a=Number(a);var b=0;this.each(function(){var d=this;if(isObject(d)&&isNumber(d))d=Number(d);d==a&&b++});return b},zip:function(){switch(arguments.length){case 0:return this;case 1:return c.call(this,arguments[0]);default:var a={},b=Bling(),d=arguments.length,
g=this.length,j=0,k=0,o=null;for(j=0;j<d;j++)a[j]=c.call(this,arguments[j]);for(j=0;j<g;j++){d={};for(o in a)d[o]=a[o].shift();b[k++]=d}return b}},zap:function(a,b){if(!a)return this;var d=a.indexOf(".");return d>-1?this.zip(a.substr(0,d)).zap(a.substr(d+1),b):isArray(b)?this.each(function(g){g[a]=b[++d]}):this.each(function(){this[a]=b})},take:function(a){a=Math.min(a|0,this.len());var b=Bling(a),d=-1;b.context=this.context;for(b.selector=this.selector;++d<a;)b[d]=this[d];return b},skip:function(a){a=
Math.min(this.len(),Math.max(0,a|0));var b=Bling(a);i=0;nn=this.len()-a;b.context=this.context;for(b.selector=this.selector;i<nn;i++)b[i]=this[i+a];return b},first:function(a){return a?this.take(a):this[0]},last:function(a){return a?this.skip(this.len()-a):this[this.length-1]},join:function(a){if(this.length==0)return"";return this.reduce(function(b){return b+a+this})},slice:function(a,b){var d=Bling(Array.Slice(this,a,b));d.context=this.context;d.selector=this.selector;return d},concat:function(a){for(var b=
this.len()-1,d=-1,g=a.length;d<g;)this[++b]=a[++d];return this},push:function(a){Array.prototype.push.call(this,a);return this},filter:function(a){var b=0,d=-1,g=this.length,j=Bling(g),k=null;j.context=this;for(j.selector=a;b<g;b++)if(k=this[b])if(isFunc(a)&&a.call(k,k)||isString(a)&&k.webkitMatchesSelector&&k.webkitMatchesSelector(a)||isType(a,"RegExp")&&a.test(k))j[++d]=k;return j},matches:function(a){if(isType(a,"RegExp"))return this.map(function(){return a.test(this)});return isString(a)&&this.webkitMatchesSelector?
this.map(function(){return this.webkitMatchesSelector(a)}):this.map(function(){return false})},weave:function(a){var b=a.length,d=this.length,g=Bling(2*Math.max(d,b));i=d-1;g.context=this.context;for(g.selector=this.selector;i>=0;i--)g[i*2+1]=this[i];for(;++i<b;)g[i*2]=a[i];return g},fold:function(a){var b=this.len(),d=0,g=Bling(Math.ceil(b/2)),j=0;g.context=this.context;g.selector=this.selector;for(j=0;j<b-1;j+=2)g[d++]=a.call(this,this[j],this[j+1]);if(b%2==1)g[d++]=a.call(this,this[b-1],undefined);
return g},flatten:function(){var a=Bling(),b=this.len(),d=null,g=0,j=0,k=0,o=0;a.context=this.context;for(a.selector=this.selector;j<b;j++){d=this[j];k=0;for(g=d.length;k<g;)a[o++]=d[k++]}return a},call:function(){return this.apply(null,arguments)},apply:function(a,b){return this.map(function(){if(isFunc(this))return this.apply(a,b);return this})},toString:function(){return Bling.symbol+"(["+this.map(function(){return this==undefined||this==window?"undefined":this==null?"null":this.toString().replace(/\[object (\w+)\]/,
"$1")}).join(", ")+"])"},future:function(a,b){b&&f.schedule(b.bound(this),a);return this},log:function(a){a?console.log(a,this,this.length+" items"):console.log(this,this.length+" items");return this},len:function(){for(var a=this.length;a>-1&&this[--a]==undefined;);return a+1}}});
Bling.module("Html",function(){function e(a,b){a&&b&&a.parentNode.insertBefore(b,a)}function h(a){a=isNode(a)?a:isBling(a)?a.toFragment():isString(a)?Bling(a).toFragment():isFunc(a.toString)?Bling(a.toString()).toFragment():undefined;Bling.nextguid=Bling.nextguid||1;if(a.guid==null)a.guid=Bling.nextguid++;return a}function c(a){for(var b=a.cloneNode(),d=0;d<a.childNodes.length;d++)b.appendChild(c(a.childNodes[d])).parentNode=b;return b}var f=null;Bling.HTML={parse:function(a){var b=document.createElement("body");
b.innerHTML=a;a=document.createDocumentFragment();for(var d=0,g=b.childNodes.length;d<g;d++)a.appendChild(b.removeChild(b.childNodes[0]));return g==1?a.removeChild(a.childNodes[0]):a},stringify:function(a){a=c(a);var b=document.createElement("div");b.appendChild(a);var d=b.innerHTML;b.removeChild(a);a.parentNode=null;return d},escape:function(a){f=f||Bling("<div>&nbsp;</div>").child(0);a=f.zap("data",a).zip("parentNode.innerHTML").first();f.zap("data","");return a}};Bling.Color={fromCss:function(a){a=
a||this;if(isString(a)){var b=document.createElement("div");b.style.display="none";b.style.color=a;$(document.body).append(b);a=window.getComputedStyle(b).getPropertyValue("color");$(b).remove();if(a){a=a.slice(a.indexOf("(")+1,a.indexOf(")")).split(", ");if(a.length==3)a[3]=1;return Bling(a).floats()}}},toCss:function(a){function b(d){d=d.map(Function.UpperLimit(255)).map(Function.LowerLimit(0));d[3]=Math.min(1,d[3]);return"rgba("+d.join(", ")+")"}a=a||this;return isBling(a[0])?a.map(b):b(a)},invert:function(a){var b=
Bling(4);b[0]=255-a[0];b[1]=255-a[1];b[2]=255-a[2];b[3]=a[3];return b}};return{html:function(a){return a==undefined?this.zip("innerHTML"):isString(a)?this.zap("innerHTML",a):isBling(a)?this.html(a.toFragment()):isNode(a)?this.each(function(){for(this.replaceChild(this.childNodes[0],a);this.childNodes.length>1;)this.removeChild(this.childNodes[1])}):undefined},append:function(a){if(a==null)return this;a=h(a);var b=this.zip("appendChild");b.take(1).call(a);b.skip(1).each(function(){this(c(a))});return this},
appendTo:function(a){if(a==null)return this;Bling(a).append(this);return this},prepend:function(a){if(a==null)return this;a=h(a);this.take(1).each(function(){e(this.childNodes[0],a)});this.skip(1).each(function(){e(this.childNodes[0],c(a))});return this},prependTo:function(a){if(a==null)return this;Bling(a).prepend(this);return this},before:function(a){if(a==null)return this;a=h(a);this.take(1).each(function(){e(this,a)});this.skip(1).each(function(){e(this,c(a))});return this},after:function(a){if(a==
null)return this;a=h(a);this.take(1).each(function(){this.parentNode.insertBefore(a,this.nextSibling)});this.skip(1).each(function(){this.parentNode.insertBefore(c(a),this.nextSibling)});return this},wrap:function(a){a=h(a);if(isFragment(a))throw Error("cannot wrap something with a fragment");return this.map(function(b){if(isFragment(b))a.appendChild(b);else if(isNode(b)){var d=b.parentNode;if(d){var g=document.createElement("dummy");a.appendChild(d.replaceChild(g,b));d.replaceChild(a,g)}else a.appendChild(b)}return b})},
unwrap:function(){return this.each(function(){this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.replaceChild(this,this.parentNode)})},replace:function(a){a=h(a);var b=Bling(),d=-1;this.take(1).each(function(){if(this.parentNode){this.parentNode.replaceChild(a,this);b[++d]=a}});this.skip(1).each(function(){if(this.parentNode){var g=c(a);this.parentNode.replaceChild(g,this);b[++d]=g}});return b},attr:function(a,b){var d=this.zip(b===undefined?"getAttribute":b===null?"removeAttribute":
"setAttribute").call(a,b);return b?this:d},addClass:function(a){return this.removeClass(a).each(function(){var b=this.className.split(" ").filter(function(d){return d&&d!=""});b.push(a);this.className=b.join(" ")})},removeClass:function(a){var b=function(d){return d!=a};return this.each(function(){this.className=this.className.split(" ").filter(b).join(" ")})},toggleClass:function(a){function b(d){return d!=a}return this.each(function(d){var g=d.className.split(" ");d.className=g.indexOf(a)>-1?g.filter(b).join(" "):
g.push(a).join(" ")})},hasClass:function(a){return this.zip("className.split").call(" ").zip("indexOf").call(a).map(Function.IndexFound)},text:function(a){return a?this.zap("innerText",a):this.zip("innerText")},val:function(a){return a?this.zap("value",a):this.zip("value")},css:function(a,b){if(hasValue(b)||isObject(a)){var d=/^-webkit-/,g=this.zip("style.setProperty").map(function(){var k=this;return function(o,m){if(d.test(o)){k(o.replace(d,"-moz-"),m);k(o.replace(d,"-o-"),m);k(o.replace(d,""),
m)}k(o,m)}});if(isString(a))g.call(a,b);else for(var j in a)g.call(j,a[j]);return this}g=this.map(window.getComputedStyle).zip("getPropertyValue").call(a);return this.zip("style").zip(a).weave(g).fold(function(k,o){return k?k:o})},defaultCss:function(a,b){var d=this.selector,g="<style> ",j=$("head");if(isString(a))if(isString(b))g+=d+" { "+a+": "+b+" } ";else throw Error("defaultCss requires a value with a string key");else if(isObject(a)){g+=d+" { ";for(var k in a)g+=k+": "+a[k];g+=" } "}g+="</style>";
j.append(g)},rect:function(){return this.zip("getBoundingClientRect").call()},width:function(){return this.rect().zip("width")},height:function(a){return a==null?this.rect().zip("height"):this.css("height",a)},top:function(a){return a==null?this.rect().zip("top"):this.css("top",a)},left:function(a){return a==null?this.rect().zip("left"):this.css("left",a)},position:function(a,b){return a==null?this.rect():b==null?this.css("left",Number.Px(a)):this.css({top:Number.Px(b),left:Number.Px(a)})},center:function(a){a=
a||"viewport";var b=document.body.clientHeight/2,d=document.body.clientWidth/2;return this.each(function(){var g=Bling(this),j=g.height().floats().first(),k=g.width().floats().first();k=a=="viewport"||a=="horizontal"?document.body.scrollLeft+d-k/2:NaN;y=a=="viewport"||a=="vertical"?document.body.scrollTop+b-j/2:NaN;g.css({position:"absolute",left:isNumber(k)?k+"px":undefined,top:isNumber(y)?y+"px":undefined})})},trueColor:function(a,b){function b(d){d[0]+=(this[0]-d[0])*this[3];d[1]+=(this[1]-d[1])*
this[3];d[2]+=(this[2]-d[2])*this[3];d[3]=Math.min(1,d[3]+this[3]);return d}a=a||"background-color";return this.parents().map(function(){return this.map(window.getComputedStyle).filter(hasValue).zip("getPropertyValue").call(a).filter(isString).map(Bling.Color.fromCss).reverse().reduce(b,Bling([0,0,0,0])).map(Bling.Color.toCss)})},child:function(a){return this.map(function(){return this.childNodes[a]})},children:function(){return this.map(function(){return Bling(this.childNodes,this)})},parent:function(){return this.zip("parentNode")},
parents:function(){return this.map(function(){for(var a=Bling(),b=-1,d=this;d=d.parentNode;)a[++b]=d;return a})},prev:function(){return this.map(function(){for(var a=Bling(),b=-1,d=this;d=d.previousSibling;)a[++b]=d;return a})},next:function(){return this.map(function(){for(var a=Bling(),b=-1,d=this;d=d.previousSibling;)a[++b]=d;return a})},remove:function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})},find:function(a){return this.filter("*").map(function(){return Bling(a,
this)}).flatten()},clone:function(){return this.map(c)},toFragment:function(){if(this.length==1)return h(this[0]);var a=document.createDocumentFragment();this.map(h).map(a.appendChild.bound(a));return a}}});
Bling.module("Math",function(){return{floats:function(){return this.map(function(){if(isBling(this))return this.floats();return parseFloat(this)})},ints:function(){return this.map(function(){if(isBling(this))return this.ints();return parseInt(this)})},px:function(e){e=e||0;return this.ints().map(Function.Px(e))},min:function(){return this.reduce(function(e){if(isBling(this))return this.min();return Math.min(this,e)})},max:function(){return this.reduce(function(e){if(isBling(this))return this.max();
return Math.max(this,e)})},average:function(){return this.sum()/this.length},sum:function(){return this.reduce(function(e){if(isBling(this))return e+this.sum();return e+this})},squares:function(){return this.map(function(){if(isBling(this))return this.squares();return this*this})},magnitude:function(){var e=this.map(function(){if(isBling(this))return this.magnitude();return parseFloat(this)});return Math.sqrt(e.squares().sum())},scale:function(e){return this.map(function(){if(isBling(this))return this.scale(e);
return e*this})},normalize:function(){return this.scale(1/this.magnitude())}}});
Bling.module("Event",function(){function e(c){eval("f = function "+c+"(f) { // ."+c+"([f]) - trigger [or bind] the '"+c+"' event \nreturn isFunc(f) ? this.bind('"+c+"',f) : this.trigger(e, f ? f : {}) }");return null}setTimeout(function(){Bling.prototype.trigger!=null&&document.readyState=="complete"?Bling(document).trigger("ready"):setTimeout(arguments.callee,20)},0);var h=/, */;return{bind:function(c,f){var a=0;c=(c||"").split(h);var b=c.length;return this.each(function(){for(;a<b;a++)this.addEventListener(c[a],
f)})},unbind:function(c,f){var a=0;c=(c||"").split(h);var b=c.length;return this.each(function(){for(;a<b;a++)this.removeEventListener(c[a],f)})},once:function(c,f){var a=0;c=(c||"").split(h);for(var b=c.length;a<b;a++)this.bind(c[a],function(d){f.call(this,d);this.unbind(d.type,arguments.callee)})},cycle:function(c){function f(){var j=0;return function(k){b[j].call(this,k);j=++j%g}}var a=0,b=Array.Slice(arguments,1,arguments.length);c=(c||"").split(h);for(var d=c.length,g=b.length;a<d;)this.bind(c[a++],
f());return this},trigger:function(c,f){var a=undefined,b=0;c=(c||"").split(h);var d=c.length,g=null;for(f=Object.Extend({bubbles:true,cancelable:true},f);b<d;b++){g=c[b];switch(g){case "click":case "mousemove":case "mousedown":case "mouseup":case "mouseover":case "mouseout":a=document.createEvent("MouseEvents");f=Object.Extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:null},f);a.initMouseEvent(g,f.bubbles,f.cancelable,
window,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,f.relatedTarget);break;case "blur":case "focus":case "reset":case "submit":case "abort":case "change":case "load":case "unload":a=document.createEvent("UIEvents");a.initUIEvent(g,f.bubbles,f.cancelable,window,1);break;case "touchstart":case "touchmove":case "touchend":case "touchcancel":a=document.createEvent("TouchEvents");f=Object.Extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,
altKey:false,shiftKey:false,metaKey:false,touches:[],targetTouches:[],changedTouches:[],scale:1,rotation:0},f);a.initTouchEvent(g,f.bubbles,f.cancelable,window,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.touches,f.targetTouches,f.changedTouches,f.scale,f.rotation);break;case "gesturestart":case "gestureend":case "gesturecancel":a=document.createEvent("GestureEvents");f=Object.Extend({detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,
shiftKey:false,metaKey:false,target:null,scale:1,rotation:0},f);a.initGestureEvent(g,f.bubbles,f.cancelable,window,f.detail,f.screenX,f.screenY,f.clientX,f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.target,f.scale,f.rotation);break;default:a=document.createEvent("Events");a.initEvent(g,f.bubbles,f.cancelable)}a&&this.each(function(){this.dispatchEvent(a);a.result=a.returnValue=undefined})}return this},live:function(c,f){var a=this.selector,b=this.context;Bling(b).bind(c,function(g){Bling(a,
b).intersect(Bling(g.target).parents().first()).each(function(){g.target=this;f.call(this,g)})});var d=b.__livers__=b.__livers__||{};d[a]=d[a]||{};d[a][c]=d[a][c]||[];d[a][c].push(f)},die:function(c,f){var a=this.selector,b=this.context,d=Bling(b);g=b.__livers__;if(g==null)return this;var g=b.__livers__[a][c];a=0;for(b=g.length;a<b;a++)if(f==undefined||f==g[a]){d.unbind(c,f);g.splice(a,1);b--;a--}},liveCycle:function(c){var f=0,a=Array.Slice(arguments,1,arguments.length);return this.live(c,function(b){a[f].call(this,
b);f=++f%a.length})},click:function(c){this.css("cursor").intersect(["auto",""]).len()>0&&this.css("cursor","pointer");return isFunc(c)?this.bind("click",c):this.trigger("click",c?c:{})},mousemove:e("mousemove"),mousedown:e("mousedown"),mouseup:e("mouseup"),mouseover:e("mouseover"),mouseout:e("mouseout"),blur:e("blur"),focus:e("focus"),load:e("load"),ready:e("ready"),unload:e("unload"),reset:e("reset"),submit:e("submit"),keyup:e("keyup"),keydwon:e("keydown"),change:e("change"),abort:e("abort"),cut:e("cut"),
copy:e("copy"),paste:e("paste"),selection:e("selection"),drag:e("drag"),drop:e("drop"),orientationchange:e("orientationchange"),touchstart:e("touchstart"),touchmove:e("touchmove"),touchend:e("touchend"),touchcancel:e("touchcancel"),gesturestart:e("gesturestart"),gestureend:e("gestureend"),gesturecancel:e("gesturecancel")}});
Bling.module("Transform",function(){Bling.duration=function(h){var c={slow:700,medium:500,normal:300,fast:100,instant:0,now:0}[h];return c?c:parseFloat(h)};var e=/(?:scale|translate|rotate|scale3d|translateX|translateY|translateZ|translate3d|rotateX|rotateY|rotateZ|rotate3d)/;return{transform:function(h,c,f){if(typeof c=="function"){f=c;c=undefined}c=c||"normal";var a=Bling.duration(c);c=[];var b=0,d=0,g=null,j="",k={};for(d in h)if(e.test(d)){g=h[d];if(g.join)g=g.join(", ");else if(g.toString)g=
g.toString();j+=" "+d+"("+g+")"}else k[d]=h[d];for(d in k)c[b++]=d;if(j)c[b++]="-webkit-transfrom";k["-webkit-transition-property"]=c.join(", ");k["-webkit-transition-duration"]=c.map(function(){return a+"ms"}).join(", ");if(j)k["-webkit-transform"]=j;this.css(k);return this.future(a,f)},hide:function(h){return this.each(function(){if(this.style){this._display=this.style.display=="none"?undefined:this.style.display;this.style.display="none"}}).future(50,h)},show:function(h){return this.each(function(){if(this.style){this.style.display=
this._display?this._display:"block";this._display=undefined}}).future(50,h)},toggle:function(h){this.weave(this.css("display")).fold(function(c,f){if(c=="none"){f.style.display=f._old_display?f._old_display:"block";f._old_display=undefined}else{f._old_display=c;f.style.display="none"}return f}).future(50,h)},fadeIn:function(h,c){return this.css("opacity","0.0").show(function(){this.transform({opacity:"1.0",translate3d:[0,0,0]},h,c)})},fadeOut:function(h,c,f,a){f=f||0;a=a||0;return this.each(function(b){Bling(b).transform({opacity:"0.0",
translate3d:[f,a,0]},h,function(){this.hide()})}).future(Bling.duration(h),c)},fadeLeft:function(h,c){return this.fadeOut(h,c,"-"+this.width().first(),0)},fadeRight:function(h,c){return this.fadeOut(h,c,this.width().first(),0)},fadeUp:function(h,c){return this.fadeOut(h,c,0,"-"+this.height().first())},fadeDown:function(h,c){return this.fadeOut(h,c,0,this.height().first())}}});
Bling.module("Http",function(){function e(h){var c=[],f=0;h=JSON.parse(JSON.stringify(h));for(var a in h)c[f++]=a+"="+escape(h[a]);return c.join("&")}Object.Extend(Bling,{http:function(h,c){var f=new XMLHttpRequest;if(isFunc(c))c={success:c.bound(f)};c=Object.Extend({method:"GET",data:null,state:Function.Empty,success:Function.Empty,error:Function.Empty,async:true,withCredentials:false},c);c.state=c.state.bound(f);c.success=c.success.bound(f);c.error=c.error.bound(f);if(c.data&&c.method=="GET")h+=
"?"+e(c.data);else if(c.data&&c.method=="POST")c.data=e(c.data);f.open(c.method,h,c.async);f.withCredentials=c.withCredentials;f.onreadystatechange=function(){c.state&&c.state();if(f.readyState==4)f.status==200?c.success(f.responseText):c.error(f.status,f.statusText)};f.send(c.data);return Bling([f])},post:function(h,c){if(isFunc(c))c={success:c};c=c||{};c.method="POST";return Bling.http(h,c)},get:function(h,c){if(isFunc(c))c={success:c};c=c||{};c.method="GET";return Bling.http(h,c)}});return{}});
Bling.module("Database",function(){function e(h,c){throw Error("sql error ["+c.code+"] "+c.message);}Bling.db=function(h,c,f,a){return Bling([window.openDatabase(h||"bling.db",c||"1.0",f||"bling database",a||1024)])};return{transaction:function(h){this.zip("transaction").call(h);return this},sql:function h(h,c,f,a){if(h!=undefined){if(typeof c=="function"){a=f;f=c;c=undefined}c=c||[];f=f||Function.Empty;a=a||e;assert(isType(this[0],"Database"),"can only call .sql() on a bling of Database");return this.transaction(function(b){b.executeSql(h,
c,f,a)})}}}});
Bling.module("Template",function(){function e(a){var b=[];a=a.split(/%[\(\/]/);var d=-1,g=1,j=a.length;for(b.push(a[0]);g<j;g++){a:{d=a[g];var k=-1,o=1;if(k==null||k==-1)k=d.length;for(var m=0;m<k;m++){if(d.charAt(m)=="(")o+=1;else if(d.charAt(m)==")")o-=1;if(o==0){d=m;break a}}d=-1}if(d==-1)return"Template syntax error: unmatched '%(' in chunk starting at: "+a[g].substring(0,15);key=a[g].substring(0,d);rest=a[g].substring(d);match=c.exec(rest);if(match==null)return"Template syntax error: invalid type specifier starting at '"+rest+
"'";rest=match[4];b.push(key);b.push(match[1]|0);b.push(match[2]|0);b.push(match[3]);b.push(rest)}return b}function h(a,b){for(var d=e.cache[a]||(e.cache[a]=e(a)),g=[d[0]],j=1,k=1,o=d.length;k<o-4;k+=5){var m=d[k],q=d[k+1],n=d[k+2],p=d[k+3],l=d[k+4],s=b[m];if(s==null)s="missing required value: "+m;switch(p){case "d":g[j++]=""+parseInt(s);break;case "f":g[j++]=parseFloat(s).toFixed(n);break;default:g[j++]=""+s}if(q>0)g[j]=String.PadLeft(g[j],q);g[j++]=l}return g.join("")}var c=/([0-9#0+-]*)\.*([0-9#+-]*)([diouxXeEfFgGcrsqm])((?:.|\n)*)/;
e.cache={};Bling.render=h;var f=1;Bling.synth=function(a){function b(){node=document.createTextNode(q);p?p.appendChild(node):s.push(node);q="";l=f}function d(){node=document.createElement(g);node.id=j?j:null;node.className=k?k:null;for(var t in n)node.setAttribute(t,n[t]);p?p.appendChild(node):s.push(node);p=node;q=m=o=k=j=g="";n={};l=f}var g="",j="",k="",o="",m="",q="",n={},p=null,l=f,s=$([]),u=0,r=null;for(p=null;r=a.charAt(u++);)if(r=="+"&&l==f)p=p?p.parentNode:p;else if(r=="#"&&(l==f||l==3||l==
4))l=2;else if(r=="."&&(l==f||l==2||l==4))l=3;else if(r=="["&&(l==f||l==2||l==3||l==4))l=4;else if(r=="="&&l==4)l=5;else if(r=='"'&&l==f)l=6;else if(r=="'"&&l==f)l=7;else if(r=="]"&&(l==4||l==5)){n[o]=m;m=o="";l=f}else if(r=='"'&&l==6)b();else if(r=="'"&&l==7)b();else if((r==" "||r==",")&&l!=5&&l!=4&&g.length>0)d();else if(l==f)g+=r!=" "?r:"";else if(l==2)j+=r;else if(l==3)k+=r;else if(l==4)o+=r;else if(l==5)m+=r;else if(l==6||l==7)q+=r;else throw Error("Unknown input/state: '"+r+"'/"+l);g.length>
0&&d();q.length>0&&b();return s};return{template:function(a){a=Object.Extend({},a);this.render=function(b){return h(this.map(Bling.HTML.stringify).join(""),Object.Extend(a,b))};return this.remove()},render:function(a){return h(this.map(Bling.HTML.stringify).join(""),a)},synth:function a(b){return a(b).appendTo(this)}}});
